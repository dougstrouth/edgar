2025-04-19 14:21:13,420 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline ---
2025-04-19 14:21:13,420 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 14:21:13,420 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 14:21:13,420 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG']
2025-04-19 14:21:13,420 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): 30
2025-04-19 14:21:13,454 - INFO - [connect_db] Successfully connected to database: :memory: (Read-Only: False)
2025-04-19 14:21:13,455 - INFO - [setup_info_tables] Setting up database tables for supplementary stock info...
2025-04-19 14:21:13,456 - INFO - [setup_info_tables] Table 'company_profile' setup complete.
2025-04-19 14:21:13,456 - INFO - [setup_info_tables] Table 'company_key_metrics' setup complete.
2025-04-19 14:21:13,456 - INFO - [setup_info_tables] Table 'financials_income_annual' setup complete.
2025-04-19 14:21:13,456 - INFO - [setup_info_tables] Table 'financials_income_quarterly' setup complete.
2025-04-19 14:21:13,457 - INFO - [setup_info_tables] Table 'financials_balance_annual' setup complete.
2025-04-19 14:21:13,457 - INFO - [setup_info_tables] Table 'financials_balance_quarterly' setup complete.
2025-04-19 14:21:13,457 - INFO - [setup_info_tables] Table 'financials_cashflow_annual' setup complete.
2025-04-19 14:21:13,457 - INFO - [setup_info_tables] Table 'financials_cashflow_quarterly' setup complete.
2025-04-19 14:21:13,457 - INFO - [setup_info_tables] Table 'stock_actions' setup complete.
2025-04-19 14:21:13,458 - INFO - [setup_info_tables] Table 'stock_fetch_errors' setup complete.
2025-04-19 14:21:13,458 - INFO - [run_stock_info_pipeline] Processing 3 specified target tickers.
2025-04-19 14:21:13,459 - INFO - [run_stock_info_pipeline] Found existing profile timestamps for 0 tickers.
2025-04-19 14:21:13,459 - INFO - [run_stock_info_pipeline] Starting fetch and load loop for 3 tickers...
2025-04-19 14:21:14,089 - ERROR - [fetch_company_info] Failed to fetch .info for AAPL: ValueError - The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
2025-04-19 14:21:14,089 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=AAPL, Type=Info Fetch Error, Msg=ticker.info fetch failed
2025-04-19 14:21:16,218 - INFO - [load_data_to_table] Loading 5 rows into financials_income_annual for ticker AAPL (Mode: initial_load)
2025-04-19 14:21:16,220 - WARNING - [load_data_to_table] Columns missing from DataFrame for table financials_income_annual: ['report_date', 'NetIncomeFromContinuingOperations', 'NetIncomeApplicableToCommonShares', 'IncomeBeforeTax', 'IncomeTaxExpense', 'ResearchDevelopment', 'SellingGeneralAdministrative']. They will be NULL.
2025-04-19 14:21:16,233 - ERROR - [load_data_to_table] DB error loading data into financials_income_annual for AAPL: Constraint Error: NOT NULL constraint failed: financials_income_annual.report_date
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 486, in load_data_to_table
    con.execute(sql)
duckdb.duckdb.ConstraintException: Constraint Error: NOT NULL constraint failed: financials_income_annual.report_date
2025-04-19 14:21:16,234 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=AAPL, Type=financials_income_annual Load Error, Msg=DB insert/replace failed: Constraint Error: NOT NULL constraint failed: financials_income_annual.report_date
2025-04-19 14:21:16,235 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker AAPL: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 486, in load_data_to_table
    con.execute(sql)
duckdb.duckdb.ConstraintException: Constraint Error: NOT NULL constraint failed: financials_income_annual.report_date

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:16,235 - INFO - [load_data_to_table] Loading 6 rows into financials_income_quarterly for ticker AAPL (Mode: initial_load)
2025-04-19 14:21:16,236 - ERROR - [get_db_columns] Failed to get columns for table financials_income_quarterly: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:16,236 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=AAPL, Type=financials_income_quarterly Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:16,237 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker AAPL: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:16,239 - INFO - [load_data_to_table] Loading 5 rows into financials_balance_annual for ticker AAPL (Mode: initial_load)
2025-04-19 14:21:16,239 - ERROR - [get_db_columns] Failed to get columns for table financials_balance_annual: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:16,239 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=AAPL, Type=financials_balance_annual Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:16,240 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker AAPL: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:16,240 - INFO - [load_data_to_table] Loading 6 rows into financials_balance_quarterly for ticker AAPL (Mode: initial_load)
2025-04-19 14:21:16,240 - ERROR - [get_db_columns] Failed to get columns for table financials_balance_quarterly: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:16,240 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=AAPL, Type=financials_balance_quarterly Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:16,241 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker AAPL: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:16,241 - INFO - [load_data_to_table] Loading 5 rows into financials_cashflow_annual for ticker AAPL (Mode: initial_load)
2025-04-19 14:21:16,241 - ERROR - [get_db_columns] Failed to get columns for table financials_cashflow_annual: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:16,241 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=AAPL, Type=financials_cashflow_annual Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:16,242 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker AAPL: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:16,242 - INFO - [load_data_to_table] Loading 6 rows into financials_cashflow_quarterly for ticker AAPL (Mode: initial_load)
2025-04-19 14:21:16,242 - ERROR - [get_db_columns] Failed to get columns for table financials_cashflow_quarterly: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:16,242 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=AAPL, Type=financials_cashflow_quarterly Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:16,243 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker AAPL: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:16,243 - INFO - [load_data_to_table] Loading 91 rows into stock_actions for ticker AAPL (Mode: initial_load)
2025-04-19 14:21:16,243 - ERROR - [get_db_columns] Failed to get columns for table stock_actions: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:16,243 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=AAPL, Type=stock_actions Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:16,244 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker AAPL: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:17,171 - ERROR - [fetch_company_info] Failed to fetch .info for MSFT: ValueError - The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
2025-04-19 14:21:17,172 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=MSFT, Type=Info Fetch Error, Msg=ticker.info fetch failed
2025-04-19 14:21:19,405 - INFO - [load_data_to_table] Loading 4 rows into financials_income_annual for ticker MSFT (Mode: initial_load)
2025-04-19 14:21:19,406 - WARNING - [load_data_to_table] Columns missing from DataFrame for table financials_income_annual: ['report_date', 'NetIncomeFromContinuingOperations', 'NetIncomeApplicableToCommonShares', 'IncomeBeforeTax', 'IncomeTaxExpense', 'ResearchDevelopment', 'SellingGeneralAdministrative']. They will be NULL.
2025-04-19 14:21:19,415 - ERROR - [load_data_to_table] DB error loading data into financials_income_annual for MSFT: Constraint Error: NOT NULL constraint failed: financials_income_annual.report_date
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 486, in load_data_to_table
    con.execute(sql)
duckdb.duckdb.ConstraintException: Constraint Error: NOT NULL constraint failed: financials_income_annual.report_date
2025-04-19 14:21:19,416 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=MSFT, Type=financials_income_annual Load Error, Msg=DB insert/replace failed: Constraint Error: NOT NULL constraint failed: financials_income_annual.report_date
2025-04-19 14:21:19,416 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker MSFT: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 486, in load_data_to_table
    con.execute(sql)
duckdb.duckdb.ConstraintException: Constraint Error: NOT NULL constraint failed: financials_income_annual.report_date

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:19,417 - INFO - [load_data_to_table] Loading 5 rows into financials_income_quarterly for ticker MSFT (Mode: initial_load)
2025-04-19 14:21:19,417 - ERROR - [get_db_columns] Failed to get columns for table financials_income_quarterly: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:19,417 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=MSFT, Type=financials_income_quarterly Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:19,418 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker MSFT: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:19,418 - INFO - [load_data_to_table] Loading 4 rows into financials_balance_annual for ticker MSFT (Mode: initial_load)
2025-04-19 14:21:19,418 - ERROR - [get_db_columns] Failed to get columns for table financials_balance_annual: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:19,418 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=MSFT, Type=financials_balance_annual Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:19,419 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker MSFT: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:19,419 - INFO - [load_data_to_table] Loading 6 rows into financials_balance_quarterly for ticker MSFT (Mode: initial_load)
2025-04-19 14:21:19,419 - ERROR - [get_db_columns] Failed to get columns for table financials_balance_quarterly: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:19,419 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=MSFT, Type=financials_balance_quarterly Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:19,420 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker MSFT: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:19,420 - INFO - [load_data_to_table] Loading 5 rows into financials_cashflow_annual for ticker MSFT (Mode: initial_load)
2025-04-19 14:21:19,420 - ERROR - [get_db_columns] Failed to get columns for table financials_cashflow_annual: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:19,420 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=MSFT, Type=financials_cashflow_annual Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:19,421 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker MSFT: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:19,421 - INFO - [load_data_to_table] Loading 6 rows into financials_cashflow_quarterly for ticker MSFT (Mode: initial_load)
2025-04-19 14:21:19,422 - ERROR - [get_db_columns] Failed to get columns for table financials_cashflow_quarterly: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:19,422 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=MSFT, Type=financials_cashflow_quarterly Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:19,423 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker MSFT: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:19,423 - INFO - [load_data_to_table] Loading 94 rows into stock_actions for ticker MSFT (Mode: initial_load)
2025-04-19 14:21:19,423 - ERROR - [get_db_columns] Failed to get columns for table stock_actions: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:19,423 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=MSFT, Type=stock_actions Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:19,424 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker MSFT: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:20,313 - ERROR - [fetch_company_info] Failed to fetch .info for GOOG: ValueError - The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
2025-04-19 14:21:20,313 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=GOOG, Type=Info Fetch Error, Msg=ticker.info fetch failed
2025-04-19 14:21:22,610 - INFO - [load_data_to_table] Loading 5 rows into financials_income_annual for ticker GOOG (Mode: initial_load)
2025-04-19 14:21:22,612 - WARNING - [load_data_to_table] Columns missing from DataFrame for table financials_income_annual: ['report_date', 'NetIncomeFromContinuingOperations', 'NetIncomeApplicableToCommonShares', 'IncomeBeforeTax', 'IncomeTaxExpense', 'ResearchDevelopment', 'SellingGeneralAdministrative']. They will be NULL.
2025-04-19 14:21:22,622 - ERROR - [load_data_to_table] DB error loading data into financials_income_annual for GOOG: Constraint Error: NOT NULL constraint failed: financials_income_annual.report_date
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 486, in load_data_to_table
    con.execute(sql)
duckdb.duckdb.ConstraintException: Constraint Error: NOT NULL constraint failed: financials_income_annual.report_date
2025-04-19 14:21:22,624 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=GOOG, Type=financials_income_annual Load Error, Msg=DB insert/replace failed: Constraint Error: NOT NULL constraint failed: financials_income_annual.report_date
2025-04-19 14:21:22,625 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker GOOG: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 486, in load_data_to_table
    con.execute(sql)
duckdb.duckdb.ConstraintException: Constraint Error: NOT NULL constraint failed: financials_income_annual.report_date

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:22,626 - INFO - [load_data_to_table] Loading 6 rows into financials_income_quarterly for ticker GOOG (Mode: initial_load)
2025-04-19 14:21:22,626 - ERROR - [get_db_columns] Failed to get columns for table financials_income_quarterly: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:22,626 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=GOOG, Type=financials_income_quarterly Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:22,626 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker GOOG: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:22,627 - INFO - [load_data_to_table] Loading 5 rows into financials_balance_annual for ticker GOOG (Mode: initial_load)
2025-04-19 14:21:22,627 - ERROR - [get_db_columns] Failed to get columns for table financials_balance_annual: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:22,627 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=GOOG, Type=financials_balance_annual Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:22,627 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker GOOG: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:22,628 - INFO - [load_data_to_table] Loading 6 rows into financials_balance_quarterly for ticker GOOG (Mode: initial_load)
2025-04-19 14:21:22,628 - ERROR - [get_db_columns] Failed to get columns for table financials_balance_quarterly: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:22,628 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=GOOG, Type=financials_balance_quarterly Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:22,629 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker GOOG: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:22,629 - INFO - [load_data_to_table] Loading 5 rows into financials_cashflow_annual for ticker GOOG (Mode: initial_load)
2025-04-19 14:21:22,630 - ERROR - [get_db_columns] Failed to get columns for table financials_cashflow_annual: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:22,630 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=GOOG, Type=financials_cashflow_annual Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:22,630 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker GOOG: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:22,631 - INFO - [load_data_to_table] Loading 6 rows into financials_cashflow_quarterly for ticker GOOG (Mode: initial_load)
2025-04-19 14:21:22,631 - ERROR - [get_db_columns] Failed to get columns for table financials_cashflow_quarterly: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:22,632 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=GOOG, Type=financials_cashflow_quarterly Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:22,632 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker GOOG: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:22,633 - INFO - [load_data_to_table] Loading 7 rows into stock_actions for ticker GOOG (Mode: initial_load)
2025-04-19 14:21:22,633 - ERROR - [get_db_columns] Failed to get columns for table stock_actions: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 438, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:22,633 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=GOOG, Type=stock_actions Load Error, Msg=Could not get target table columns.
2025-04-19 14:21:22,633 - ERROR - [log_info_fetch_error] CRITICAL: Failed to insert info error record into stock_fetch_errors for CIK None/Ticker GOOG: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 309, in log_info_fetch_error
    con.execute(
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:21:23,243 - INFO - [run_stock_info_pipeline] Write database connection closed.
2025-04-19 14:21:23,243 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 14:21:23,243 - INFO - [run_stock_info_pipeline] Total Time: 9.82 seconds
2025-04-19 14:21:23,243 - INFO - [run_stock_info_pipeline] Total Tickers Attempted: 3
2025-04-19 14:21:23,243 - INFO - [run_stock_info_pipeline] Tickers Successfully Processed (Data Loaded/Checked): 0
2025-04-19 14:21:23,243 - INFO - [run_stock_info_pipeline] Tickers Skipped or Errored: 6
2025-04-19 14:21:23,243 - INFO - [run_stock_info_pipeline] Fetch Errors (logged): 3
2025-04-19 14:21:23,244 - INFO - [run_stock_info_pipeline] Load Errors (logged): 21
2025-04-19 14:21:23,244 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors' table for details on errors.
2025-04-19 14:21:23,244 - INFO - [<module>] Script execution finished.
2025-04-19 14:24:34,277 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v2) ---
2025-04-19 14:24:34,277 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 14:24:34,277 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 14:24:34,277 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): 30
2025-04-19 14:24:34,277 - ERROR - [run_stock_info_pipeline] Must provide --tickers when using ':memory:' database.
2025-04-19 14:24:34,277 - INFO - [<module>] Script execution finished.
2025-04-19 14:26:31,507 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v2) ---
2025-04-19 14:26:31,508 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 14:26:31,508 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 14:26:31,508 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 14:26:31,508 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): 30
2025-04-19 14:26:31,541 - INFO - [connect_db] Successfully connected to database: :memory: (Read-Only: False)
2025-04-19 14:26:31,542 - INFO - [setup_info_tables] Setting up database tables for supplementary stock info...
2025-04-19 14:26:31,543 - INFO - [setup_info_tables] Table 'company_profile' setup complete.
2025-04-19 14:26:31,543 - INFO - [setup_info_tables] Table 'company_key_metrics' setup complete.
2025-04-19 14:26:31,543 - INFO - [setup_info_tables] Table 'financials_income_annual' setup complete.
2025-04-19 14:26:31,543 - INFO - [setup_info_tables] Table 'financials_income_quarterly' setup complete.
2025-04-19 14:26:31,544 - INFO - [setup_info_tables] Table 'financials_balance_annual' setup complete.
2025-04-19 14:26:31,544 - INFO - [setup_info_tables] Table 'financials_balance_quarterly' setup complete.
2025-04-19 14:26:31,544 - INFO - [setup_info_tables] Table 'financials_cashflow_annual' setup complete.
2025-04-19 14:26:31,544 - INFO - [setup_info_tables] Table 'financials_cashflow_quarterly' setup complete.
2025-04-19 14:26:31,544 - INFO - [setup_info_tables] Table 'stock_actions' setup complete.
2025-04-19 14:26:31,545 - INFO - [setup_info_tables] Table 'stock_fetch_errors' setup complete.
2025-04-19 14:26:31,545 - INFO - [run_stock_info_pipeline] Processing 4 specified target tickers.
2025-04-19 14:26:31,546 - INFO - [run_stock_info_pipeline] Found existing profile timestamps for 0 tickers.
2025-04-19 14:26:31,546 - INFO - [run_stock_info_pipeline] Starting fetch and load loop for 4 tickers...
2025-04-19 14:26:34,134 - ERROR - [fetch_financial_statement] Failed fetching/processing annual financials for AAPL: KeyError - [None]
2025-04-19 14:26:34,139 - ERROR - [fetch_financial_statement] Failed fetching/processing quarterly financials for AAPL: KeyError - [None]
2025-04-19 14:26:34,144 - ERROR - [fetch_financial_statement] Failed fetching/processing annual balance_sheet for AAPL: KeyError - [None]
2025-04-19 14:26:34,149 - ERROR - [fetch_financial_statement] Failed fetching/processing quarterly balance_sheet for AAPL: KeyError - [None]
2025-04-19 14:26:34,154 - ERROR - [fetch_financial_statement] Failed fetching/processing annual cashflow for AAPL: KeyError - [None]
2025-04-19 14:26:34,159 - ERROR - [fetch_financial_statement] Failed fetching/processing quarterly cashflow for AAPL: KeyError - [None]
2025-04-19 14:26:34,679 - INFO - [load_data_to_table] Loading 1 rows into company_profile for ticker AAPL (Mode: initial_load)
2025-04-19 14:26:34,687 - INFO - [load_data_to_table] Loading 1 rows into company_key_metrics for ticker AAPL (Mode: initial_load)
2025-04-19 14:26:34,697 - ERROR - [load_data_to_table] DB error loading data into company_key_metrics for AAPL: Conversion Error: Unimplemented type for cast (INTEGER -> DATE)

LINE 1: ...sClose", "volume", "averageVolume", "averageVolume10days", "exDividendDate" FROM company_key_metrics_reg_1745090794689
                                                                      ^
2025-04-19 14:26:34,697 - INFO - [load_data_to_table] Loading 91 rows into stock_actions for ticker AAPL (Mode: initial_load)
2025-04-19 14:26:34,697 - ERROR - [get_db_columns] Cannot get columns for stock_actions, transaction aborted: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:26:34,697 - ERROR - [run_stock_info_pipeline] Error during load transaction for AAPL: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 613, in run_stock_info_pipeline
    if not load_data_to_table(write_conn, actions_df, ACTIONS_TABLE_NAME, ['ticker', 'action_date', 'action_type'], mode):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 395, in load_data_to_table
    db_cols = get_db_columns(con, table_name)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 374, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:26:34,699 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=AAPL, Type=Load Transaction Error, Msg=TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:26:37,251 - ERROR - [fetch_financial_statement] Failed fetching/processing annual financials for MSFT: KeyError - [None]
2025-04-19 14:26:37,257 - ERROR - [fetch_financial_statement] Failed fetching/processing quarterly financials for MSFT: KeyError - [None]
2025-04-19 14:26:37,264 - ERROR - [fetch_financial_statement] Failed fetching/processing annual balance_sheet for MSFT: KeyError - [None]
2025-04-19 14:26:37,269 - ERROR - [fetch_financial_statement] Failed fetching/processing quarterly balance_sheet for MSFT: KeyError - [None]
2025-04-19 14:26:37,275 - ERROR - [fetch_financial_statement] Failed fetching/processing annual cashflow for MSFT: KeyError - [None]
2025-04-19 14:26:37,280 - ERROR - [fetch_financial_statement] Failed fetching/processing quarterly cashflow for MSFT: KeyError - [None]
2025-04-19 14:26:37,701 - INFO - [load_data_to_table] Loading 1 rows into company_profile for ticker MSFT (Mode: initial_load)
2025-04-19 14:26:37,707 - INFO - [load_data_to_table] Loading 1 rows into company_key_metrics for ticker MSFT (Mode: initial_load)
2025-04-19 14:26:37,713 - ERROR - [load_data_to_table] DB error loading data into company_key_metrics for MSFT: Conversion Error: Unimplemented type for cast (INTEGER -> DATE)

LINE 1: ...sClose", "volume", "averageVolume", "averageVolume10days", "exDividendDate" FROM company_key_metrics_reg_1745090797709
                                                                      ^
2025-04-19 14:26:37,714 - INFO - [load_data_to_table] Loading 94 rows into stock_actions for ticker MSFT (Mode: initial_load)
2025-04-19 14:26:37,714 - ERROR - [get_db_columns] Cannot get columns for stock_actions, transaction aborted: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:26:37,714 - ERROR - [run_stock_info_pipeline] Error during load transaction for MSFT: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 613, in run_stock_info_pipeline
    if not load_data_to_table(write_conn, actions_df, ACTIONS_TABLE_NAME, ['ticker', 'action_date', 'action_type'], mode):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 395, in load_data_to_table
    db_cols = get_db_columns(con, table_name)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 374, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:26:37,716 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=MSFT, Type=Load Transaction Error, Msg=TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:26:41,943 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v2) ---
2025-04-19 14:26:41,943 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 14:26:41,944 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 14:26:41,944 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 14:26:41,944 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): 30
2025-04-19 14:26:41,951 - INFO - [connect_db] Successfully connected to database: :memory: (Read-Only: False)
2025-04-19 14:26:41,953 - INFO - [setup_info_tables] Setting up database tables for supplementary stock info...
2025-04-19 14:26:41,954 - INFO - [setup_info_tables] Table 'company_profile' setup complete.
2025-04-19 14:26:41,954 - INFO - [setup_info_tables] Table 'company_key_metrics' setup complete.
2025-04-19 14:26:41,954 - INFO - [setup_info_tables] Table 'financials_income_annual' setup complete.
2025-04-19 14:26:41,955 - INFO - [setup_info_tables] Table 'financials_income_quarterly' setup complete.
2025-04-19 14:26:41,955 - INFO - [setup_info_tables] Table 'financials_balance_annual' setup complete.
2025-04-19 14:26:41,955 - INFO - [setup_info_tables] Table 'financials_balance_quarterly' setup complete.
2025-04-19 14:26:41,955 - INFO - [setup_info_tables] Table 'financials_cashflow_annual' setup complete.
2025-04-19 14:26:41,956 - INFO - [setup_info_tables] Table 'financials_cashflow_quarterly' setup complete.
2025-04-19 14:26:41,956 - INFO - [setup_info_tables] Table 'stock_actions' setup complete.
2025-04-19 14:26:41,956 - INFO - [setup_info_tables] Table 'stock_fetch_errors' setup complete.
2025-04-19 14:26:41,956 - INFO - [run_stock_info_pipeline] Processing 4 specified target tickers.
2025-04-19 14:26:41,957 - INFO - [run_stock_info_pipeline] Found existing profile timestamps for 0 tickers.
2025-04-19 14:26:41,957 - INFO - [run_stock_info_pipeline] Starting fetch and load loop for 4 tickers...
2025-04-19 14:26:44,163 - ERROR - [fetch_financial_statement] Failed fetching/processing annual financials for AAPL: KeyError - [None]
2025-04-19 14:26:44,168 - ERROR - [fetch_financial_statement] Failed fetching/processing quarterly financials for AAPL: KeyError - [None]
2025-04-19 14:26:44,173 - ERROR - [fetch_financial_statement] Failed fetching/processing annual balance_sheet for AAPL: KeyError - [None]
2025-04-19 14:26:44,179 - ERROR - [fetch_financial_statement] Failed fetching/processing quarterly balance_sheet for AAPL: KeyError - [None]
2025-04-19 14:26:44,186 - ERROR - [fetch_financial_statement] Failed fetching/processing annual cashflow for AAPL: KeyError - [None]
2025-04-19 14:26:44,191 - ERROR - [fetch_financial_statement] Failed fetching/processing quarterly cashflow for AAPL: KeyError - [None]
2025-04-19 14:26:44,701 - INFO - [load_data_to_table] Loading 1 rows into company_profile for ticker AAPL (Mode: initial_load)
2025-04-19 14:26:44,709 - INFO - [load_data_to_table] Loading 1 rows into company_key_metrics for ticker AAPL (Mode: initial_load)
2025-04-19 14:26:44,716 - ERROR - [load_data_to_table] DB error loading data into company_key_metrics for AAPL: Conversion Error: Unimplemented type for cast (INTEGER -> DATE)

LINE 1: ...sClose", "volume", "averageVolume", "averageVolume10days", "exDividendDate" FROM company_key_metrics_reg_1745090804712
                                                                      ^
2025-04-19 14:26:44,717 - INFO - [load_data_to_table] Loading 91 rows into stock_actions for ticker AAPL (Mode: initial_load)
2025-04-19 14:26:44,717 - ERROR - [get_db_columns] Cannot get columns for stock_actions, transaction aborted: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:26:44,717 - ERROR - [run_stock_info_pipeline] Error during load transaction for AAPL: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 613, in run_stock_info_pipeline
    if not load_data_to_table(write_conn, actions_df, ACTIONS_TABLE_NAME, ['ticker', 'action_date', 'action_type'], mode):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 395, in load_data_to_table
    db_cols = get_db_columns(con, table_name)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 374, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:26:44,719 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=AAPL, Type=Load Transaction Error, Msg=TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:26:47,070 - ERROR - [fetch_financial_statement] Failed fetching/processing annual financials for MSFT: KeyError - [None]
2025-04-19 14:26:47,074 - ERROR - [fetch_financial_statement] Failed fetching/processing quarterly financials for MSFT: KeyError - [None]
2025-04-19 14:26:47,080 - ERROR - [fetch_financial_statement] Failed fetching/processing annual balance_sheet for MSFT: KeyError - [None]
2025-04-19 14:26:47,084 - ERROR - [fetch_financial_statement] Failed fetching/processing quarterly balance_sheet for MSFT: KeyError - [None]
2025-04-19 14:26:47,089 - ERROR - [fetch_financial_statement] Failed fetching/processing annual cashflow for MSFT: KeyError - [None]
2025-04-19 14:26:47,094 - ERROR - [fetch_financial_statement] Failed fetching/processing quarterly cashflow for MSFT: KeyError - [None]
2025-04-19 14:26:47,489 - INFO - [load_data_to_table] Loading 1 rows into company_profile for ticker MSFT (Mode: initial_load)
2025-04-19 14:26:47,498 - INFO - [load_data_to_table] Loading 1 rows into company_key_metrics for ticker MSFT (Mode: initial_load)
2025-04-19 14:26:47,506 - ERROR - [load_data_to_table] DB error loading data into company_key_metrics for MSFT: Conversion Error: Unimplemented type for cast (INTEGER -> DATE)

LINE 1: ...sClose", "volume", "averageVolume", "averageVolume10days", "exDividendDate" FROM company_key_metrics_reg_1745090807501
                                                                      ^
2025-04-19 14:26:47,506 - INFO - [load_data_to_table] Loading 94 rows into stock_actions for ticker MSFT (Mode: initial_load)
2025-04-19 14:26:47,507 - ERROR - [get_db_columns] Cannot get columns for stock_actions, transaction aborted: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:26:47,507 - ERROR - [run_stock_info_pipeline] Error during load transaction for MSFT: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 613, in run_stock_info_pipeline
    if not load_data_to_table(write_conn, actions_df, ACTIONS_TABLE_NAME, ['ticker', 'action_date', 'action_type'], mode):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 395, in load_data_to_table
    db_cols = get_db_columns(con, table_name)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 374, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:26:47,508 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=MSFT, Type=Load Transaction Error, Msg=TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:26:49,862 - ERROR - [fetch_financial_statement] Failed fetching/processing annual financials for GOOG: KeyError - [None]
2025-04-19 14:26:49,868 - ERROR - [fetch_financial_statement] Failed fetching/processing quarterly financials for GOOG: KeyError - [None]
2025-04-19 14:26:49,874 - ERROR - [fetch_financial_statement] Failed fetching/processing annual balance_sheet for GOOG: KeyError - [None]
2025-04-19 14:26:49,879 - ERROR - [fetch_financial_statement] Failed fetching/processing quarterly balance_sheet for GOOG: KeyError - [None]
2025-04-19 14:26:49,884 - ERROR - [fetch_financial_statement] Failed fetching/processing annual cashflow for GOOG: KeyError - [None]
2025-04-19 14:26:49,888 - ERROR - [fetch_financial_statement] Failed fetching/processing quarterly cashflow for GOOG: KeyError - [None]
2025-04-19 14:26:50,236 - INFO - [load_data_to_table] Loading 1 rows into company_profile for ticker GOOG (Mode: initial_load)
2025-04-19 14:26:50,244 - INFO - [load_data_to_table] Loading 1 rows into company_key_metrics for ticker GOOG (Mode: initial_load)
2025-04-19 14:26:50,252 - ERROR - [load_data_to_table] DB error loading data into company_key_metrics for GOOG: Conversion Error: Unimplemented type for cast (INTEGER -> DATE)

LINE 1: ...sClose", "volume", "averageVolume", "averageVolume10days", "exDividendDate" FROM company_key_metrics_reg_1745090810247
                                                                      ^
2025-04-19 14:26:50,253 - INFO - [load_data_to_table] Loading 7 rows into stock_actions for ticker GOOG (Mode: initial_load)
2025-04-19 14:26:50,253 - ERROR - [get_db_columns] Cannot get columns for stock_actions, transaction aborted: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:26:50,253 - ERROR - [run_stock_info_pipeline] Error during load transaction for GOOG: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 613, in run_stock_info_pipeline
    if not load_data_to_table(write_conn, actions_df, ACTIONS_TABLE_NAME, ['ticker', 'action_date', 'action_type'], mode):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 395, in load_data_to_table
    db_cols = get_db_columns(con, table_name)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 374, in get_db_columns
    cols = con.execute(f"PRAGMA table_info('{table_name}');").fetchall()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.TransactionException: TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:26:50,254 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=GOOG, Type=Load Transaction Error, Msg=TransactionContext Error: Current transaction is aborted (please ROLLBACK)
2025-04-19 14:26:52,162 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 14:26:52,163 - ERROR - [fetch_company_info] Failed processing .info for NONEXISTENTTICKER: AttributeError - 'NoneType' object has no attribute 'update'
2025-04-19 14:26:52,163 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=ticker.info fetch or processing failed
2025-04-19 14:26:53,430 - INFO - [fetch_financial_statement] No annual financials data found for NONEXISTENTTICKER.
2025-04-19 14:26:53,430 - INFO - [fetch_financial_statement] No quarterly financials data found for NONEXISTENTTICKER.
2025-04-19 14:26:53,431 - INFO - [fetch_financial_statement] No annual balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 14:26:53,431 - INFO - [fetch_financial_statement] No quarterly balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 14:26:53,431 - INFO - [fetch_financial_statement] No annual cashflow data found for NONEXISTENTTICKER.
2025-04-19 14:26:53,432 - INFO - [fetch_financial_statement] No quarterly cashflow data found for NONEXISTENTTICKER.
2025-04-19 14:26:54,331 - ERROR - [fetch_stock_actions] Failed fetching actions for NONEXISTENTTICKER: TypeError - argument of type 'NoneType' is not iterable
2025-04-19 14:26:54,943 - INFO - [run_stock_info_pipeline] Write database connection closed.
2025-04-19 14:26:54,943 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 14:26:54,943 - INFO - [run_stock_info_pipeline] Total Time: 13.00 seconds
2025-04-19 14:26:54,943 - INFO - [run_stock_info_pipeline] Total Tickers Attempted: 4
2025-04-19 14:26:54,944 - INFO - [run_stock_info_pipeline] Tickers Successfully Processed (All Loads OK): 0
2025-04-19 14:26:54,944 - INFO - [run_stock_info_pipeline] Tickers Skipped or Errored: 4
2025-04-19 14:26:54,944 - INFO - [run_stock_info_pipeline] Total Fetch Errors (API/Processing): 26
2025-04-19 14:26:54,944 - INFO - [run_stock_info_pipeline] Total Tickers with Load Errors: 3
2025-04-19 14:26:54,944 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors' table for details on errors.
2025-04-19 14:26:54,944 - INFO - [<module>] Script execution finished.
2025-04-19 14:29:05,684 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v2.2) ---
2025-04-19 14:29:05,686 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 14:29:05,686 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 14:29:05,686 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 14:29:05,686 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 14:29:05,716 - INFO - [connect_db] Successfully connected: :memory: (Read-Only: False)
2025-04-19 14:29:05,716 - INFO - [setup_info_tables] Setting up database tables for supplementary stock info...
2025-04-19 14:29:05,717 - INFO - [setup_info_tables] Table 'company_profile' setup complete.
2025-04-19 14:29:05,717 - INFO - [setup_info_tables] Table 'company_key_metrics' setup complete.
2025-04-19 14:29:05,718 - INFO - [setup_info_tables] Table 'financials_income_annual' setup complete.
2025-04-19 14:29:05,718 - INFO - [setup_info_tables] Table 'financials_income_quarterly' setup complete.
2025-04-19 14:29:05,718 - INFO - [setup_info_tables] Table 'financials_balance_annual' setup complete.
2025-04-19 14:29:05,718 - INFO - [setup_info_tables] Table 'financials_balance_quarterly' setup complete.
2025-04-19 14:29:05,718 - INFO - [setup_info_tables] Table 'financials_cashflow_annual' setup complete.
2025-04-19 14:29:05,719 - INFO - [setup_info_tables] Table 'financials_cashflow_quarterly' setup complete.
2025-04-19 14:29:05,719 - INFO - [setup_info_tables] Table 'stock_actions' setup complete.
2025-04-19 14:29:05,719 - INFO - [setup_info_tables] Table 'stock_fetch_errors' setup complete.
2025-04-19 14:29:05,719 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 14:29:05,720 - INFO - [run_stock_info_pipeline] Found profile timestamps for 0 tickers.
2025-04-19 14:29:05,720 - INFO - [run_stock_info_pipeline] Starting fetch and load loop for 4 tickers...
2025-04-19 14:29:10,234 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v2.2) ---
2025-04-19 14:29:10,234 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 14:29:10,235 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 14:29:10,235 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 14:29:10,235 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 14:29:10,240 - INFO - [connect_db] Successfully connected: :memory: (Read-Only: False)
2025-04-19 14:29:10,241 - INFO - [setup_info_tables] Setting up database tables for supplementary stock info...
2025-04-19 14:29:10,241 - INFO - [setup_info_tables] Table 'company_profile' setup complete.
2025-04-19 14:29:10,242 - INFO - [setup_info_tables] Table 'company_key_metrics' setup complete.
2025-04-19 14:29:10,242 - INFO - [setup_info_tables] Table 'financials_income_annual' setup complete.
2025-04-19 14:29:10,242 - INFO - [setup_info_tables] Table 'financials_income_quarterly' setup complete.
2025-04-19 14:29:10,242 - INFO - [setup_info_tables] Table 'financials_balance_annual' setup complete.
2025-04-19 14:29:10,242 - INFO - [setup_info_tables] Table 'financials_balance_quarterly' setup complete.
2025-04-19 14:29:10,243 - INFO - [setup_info_tables] Table 'financials_cashflow_annual' setup complete.
2025-04-19 14:29:10,243 - INFO - [setup_info_tables] Table 'financials_cashflow_quarterly' setup complete.
2025-04-19 14:29:10,243 - INFO - [setup_info_tables] Table 'stock_actions' setup complete.
2025-04-19 14:29:10,243 - INFO - [setup_info_tables] Table 'stock_fetch_errors' setup complete.
2025-04-19 14:29:10,243 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 14:29:10,244 - INFO - [run_stock_info_pipeline] Found profile timestamps for 0 tickers.
2025-04-19 14:29:10,244 - INFO - [run_stock_info_pipeline] Starting fetch and load loop for 4 tickers...
2025-04-19 14:29:12,323 - ERROR - [fetch_financial_statement] KeyError processing annual financials for AAPL: [None]. Data structure might be unexpected.
2025-04-19 14:29:12,327 - ERROR - [fetch_financial_statement] KeyError processing quarterly financials for AAPL: [None]. Data structure might be unexpected.
2025-04-19 14:29:12,332 - ERROR - [fetch_financial_statement] KeyError processing annual balance_sheet for AAPL: [None]. Data structure might be unexpected.
2025-04-19 14:29:12,337 - ERROR - [fetch_financial_statement] KeyError processing quarterly balance_sheet for AAPL: [None]. Data structure might be unexpected.
2025-04-19 14:29:12,341 - ERROR - [fetch_financial_statement] KeyError processing annual cashflow for AAPL: [None]. Data structure might be unexpected.
2025-04-19 14:29:12,346 - ERROR - [fetch_financial_statement] KeyError processing quarterly cashflow for AAPL: [None]. Data structure might be unexpected.
2025-04-19 14:29:12,956 - WARNING - [run_stock_info_pipeline] Skipping load phase for AAPL due to fetch errors.
2025-04-19 14:29:14,823 - ERROR - [fetch_financial_statement] KeyError processing annual financials for MSFT: [None]. Data structure might be unexpected.
2025-04-19 14:29:14,829 - ERROR - [fetch_financial_statement] KeyError processing quarterly financials for MSFT: [None]. Data structure might be unexpected.
2025-04-19 14:29:14,835 - ERROR - [fetch_financial_statement] KeyError processing annual balance_sheet for MSFT: [None]. Data structure might be unexpected.
2025-04-19 14:29:14,841 - ERROR - [fetch_financial_statement] KeyError processing quarterly balance_sheet for MSFT: [None]. Data structure might be unexpected.
2025-04-19 14:29:14,846 - ERROR - [fetch_financial_statement] KeyError processing annual cashflow for MSFT: [None]. Data structure might be unexpected.
2025-04-19 14:29:14,851 - ERROR - [fetch_financial_statement] KeyError processing quarterly cashflow for MSFT: [None]. Data structure might be unexpected.
2025-04-19 14:29:15,336 - WARNING - [run_stock_info_pipeline] Skipping load phase for MSFT due to fetch errors.
2025-04-19 14:29:17,328 - ERROR - [fetch_financial_statement] KeyError processing annual financials for GOOG: [None]. Data structure might be unexpected.
2025-04-19 14:29:17,334 - ERROR - [fetch_financial_statement] KeyError processing quarterly financials for GOOG: [None]. Data structure might be unexpected.
2025-04-19 14:29:17,341 - ERROR - [fetch_financial_statement] KeyError processing annual balance_sheet for GOOG: [None]. Data structure might be unexpected.
2025-04-19 14:29:17,346 - ERROR - [fetch_financial_statement] KeyError processing quarterly balance_sheet for GOOG: [None]. Data structure might be unexpected.
2025-04-19 14:29:17,352 - ERROR - [fetch_financial_statement] KeyError processing annual cashflow for GOOG: [None]. Data structure might be unexpected.
2025-04-19 14:29:17,357 - ERROR - [fetch_financial_statement] KeyError processing quarterly cashflow for GOOG: [None]. Data structure might be unexpected.
2025-04-19 14:29:17,812 - WARNING - [run_stock_info_pipeline] Skipping load phase for GOOG due to fetch errors.
2025-04-19 14:29:19,115 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 14:29:19,115 - ERROR - [fetch_company_info] Failed processing .info for NONEXISTENTTICKER: AttributeError - 'NoneType' object has no attribute 'update'
2025-04-19 14:29:19,115 - WARNING - [log_info_fetch_error] Logging info fetch error: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=ticker.info fetch or processing failed
2025-04-19 14:29:20,455 - INFO - [fetch_financial_statement] No annual financials data found for NONEXISTENTTICKER.
2025-04-19 14:29:20,456 - INFO - [fetch_financial_statement] No quarterly financials data found for NONEXISTENTTICKER.
2025-04-19 14:29:20,456 - INFO - [fetch_financial_statement] No annual balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 14:29:20,456 - INFO - [fetch_financial_statement] No quarterly balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 14:29:20,457 - INFO - [fetch_financial_statement] No annual cashflow data found for NONEXISTENTTICKER.
2025-04-19 14:29:20,457 - INFO - [fetch_financial_statement] No quarterly cashflow data found for NONEXISTENTTICKER.
2025-04-19 14:29:21,477 - ERROR - [fetch_stock_actions] Failed fetching actions for NONEXISTENTTICKER: TypeError - argument of type 'NoneType' is not iterable
2025-04-19 14:29:21,477 - WARNING - [run_stock_info_pipeline] Skipping load phase for NONEXISTENTTICKER due to fetch errors.
2025-04-19 14:29:21,483 - INFO - [run_stock_info_pipeline] Write database connection closed.
2025-04-19 14:29:21,483 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 14:29:21,484 - INFO - [run_stock_info_pipeline] Total Time: 11.25 seconds
2025-04-19 14:29:21,484 - INFO - [run_stock_info_pipeline] Total Tickers Attempted: 4
2025-04-19 14:29:21,484 - INFO - [run_stock_info_pipeline] Tickers Successfully Processed (All Fetches/Loads OK): 0
2025-04-19 14:29:21,484 - INFO - [run_stock_info_pipeline] Tickers Skipped or Errored: 4
2025-04-19 14:29:21,484 - INFO - [run_stock_info_pipeline] Total Fetch Errors (API/Processing): 26
2025-04-19 14:29:21,484 - INFO - [run_stock_info_pipeline] Total Tickers with Load Errors: 0
2025-04-19 14:29:21,484 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors' table for details on errors.
2025-04-19 14:29:21,484 - INFO - [<module>] Script execution finished.
2025-04-19 14:31:36,158 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v2.3) ---
2025-04-19 14:31:36,159 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 14:31:36,159 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 14:31:36,159 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 14:31:36,159 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 14:31:36,194 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 14:31:36,194 - INFO - [setup_info_tables] Setting up supplementary tables...
2025-04-19 14:31:36,195 - DEBUG - [setup_info_tables] Table 'company_profile' setup ok.
2025-04-19 14:31:36,195 - DEBUG - [setup_info_tables] Table 'company_key_metrics' setup ok.
2025-04-19 14:31:36,195 - DEBUG - [setup_info_tables] Table 'financials_income_annual' setup ok.
2025-04-19 14:31:36,196 - DEBUG - [setup_info_tables] Table 'financials_income_quarterly' setup ok.
2025-04-19 14:31:36,196 - DEBUG - [setup_info_tables] Table 'financials_balance_annual' setup ok.
2025-04-19 14:31:36,196 - DEBUG - [setup_info_tables] Table 'financials_balance_quarterly' setup ok.
2025-04-19 14:31:36,196 - DEBUG - [setup_info_tables] Table 'financials_cashflow_annual' setup ok.
2025-04-19 14:31:36,196 - DEBUG - [setup_info_tables] Table 'financials_cashflow_quarterly' setup ok.
2025-04-19 14:31:36,197 - DEBUG - [setup_info_tables] Table 'stock_actions' setup ok.
2025-04-19 14:31:36,197 - DEBUG - [setup_info_tables] Table 'stock_fetch_errors' setup ok.
2025-04-19 14:31:36,197 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 14:31:36,198 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 14:31:36,198 - INFO - [run_stock_info_pipeline] Starting fetch and load loop for 4 tickers...
2025-04-19 14:31:36,210 - DEBUG - [run_stock_info_pipeline] Processing 1/4: Ticker AAPL
2025-04-19 14:31:36,211 - DEBUG - [__init__] Using User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
2025-04-19 14:31:36,211 - DEBUG - [get_raw_json] get_raw_json(): https://query2.finance.yahoo.com/v10/finance/quoteSummary/AAPL
2025-04-19 14:31:36,212 - DEBUG - [wrapper] Entering get()
2025-04-19 14:31:36,212 - DEBUG - [wrapper]  Entering _make_request()
2025-04-19 14:31:36,212 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/v10/finance/quoteSummary/AAPL
2025-04-19 14:31:36,212 - DEBUG - [_make_request] params={'modules': 'financialData,quoteType,defaultKeyStatistics,assetProfile,summaryDetail', 'corsDomain': 'finance.yahoo.com', 'formatted': 'false', 'symbol': 'AAPL'}
2025-04-19 14:31:36,212 - DEBUG - [wrapper]   Entering _get_cookie_and_crumb()
2025-04-19 14:31:36,212 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:36,212 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:36,218 - DEBUG - [execute_sql] ('CREATE TABLE IF NOT EXISTS "_cookieschema" ("strategy" VARCHAR(255) NOT NULL PRIMARY KEY, "fetch_date" DATETIME NOT NULL, "cookie_bytes" BLOB NOT NULL) WITHOUT ROWID', [])
2025-04-19 14:31:36,219 - DEBUG - [execute_sql] ('SELECT "t1"."strategy", "t1"."fetch_date", "t1"."cookie_bytes" FROM "_cookieschema" AS "t1" WHERE ("t1"."strategy" = ?) LIMIT ? OFFSET ?', ['basic', 1, 0])
2025-04-19 14:31:36,219 - DEBUG - [_load_cookie_basic] loaded persistent cookie
2025-04-19 14:31:36,219 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:36,226 - DEBUG - [_new_conn] Starting new HTTPS connection (1): query1.finance.yahoo.com:443
2025-04-19 14:31:36,407 - DEBUG - [_make_request] https://query1.finance.yahoo.com:443 "GET /v1/test/getcrumb HTTP/1.1" 200 11
2025-04-19 14:31:36,408 - DEBUG - [_get_crumb_basic] crumb = 'NgZIowMiLwG'
2025-04-19 14:31:36,408 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:36,408 - DEBUG - [wrapper]   Exiting _get_cookie_and_crumb()
2025-04-19 14:31:36,410 - DEBUG - [_new_conn] Starting new HTTPS connection (1): query2.finance.yahoo.com:443
2025-04-19 14:31:36,598 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /v10/finance/quoteSummary/AAPL?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=AAPL&crumb=NgZIowMiLwG HTTP/1.1" 200 3130
2025-04-19 14:31:36,599 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:36,599 - DEBUG - [wrapper]  Exiting _make_request()
2025-04-19 14:31:36,599 - DEBUG - [wrapper] Exiting get()
2025-04-19 14:31:36,600 - DEBUG - [get_raw_json] get_raw_json(): https://query1.finance.yahoo.com/v7/finance/quote?
2025-04-19 14:31:36,600 - DEBUG - [wrapper] Entering get()
2025-04-19 14:31:36,600 - DEBUG - [wrapper]  Entering _make_request()
2025-04-19 14:31:36,600 - DEBUG - [_make_request] url=https://query1.finance.yahoo.com/v7/finance/quote?
2025-04-19 14:31:36,600 - DEBUG - [_make_request] params={'symbols': 'AAPL', 'formatted': 'false'}
2025-04-19 14:31:36,600 - DEBUG - [wrapper]   Entering _get_cookie_and_crumb()
2025-04-19 14:31:36,600 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:36,601 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:36,601 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:36,601 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:36,601 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:36,601 - DEBUG - [wrapper]   Exiting _get_cookie_and_crumb()
2025-04-19 14:31:36,691 - DEBUG - [_make_request] https://query1.finance.yahoo.com:443 "GET /v7/finance/quote?symbols=AAPL&formatted=false&crumb=NgZIowMiLwG HTTP/1.1" 200 1136
2025-04-19 14:31:36,702 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:36,702 - DEBUG - [wrapper]  Exiting _make_request()
2025-04-19 14:31:36,702 - DEBUG - [wrapper] Exiting get()
2025-04-19 14:31:36,704 - DEBUG - [wrapper] Entering get()
2025-04-19 14:31:36,704 - DEBUG - [wrapper]  Entering _make_request()
2025-04-19 14:31:36,704 - DEBUG - [_make_request] url=https://query1.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/AAPL?symbol=AAPL&type=trailingPegRatio&period1=1729296000&period2=1745107200
2025-04-19 14:31:36,704 - DEBUG - [_make_request] params=None
2025-04-19 14:31:36,704 - DEBUG - [wrapper]   Entering _get_cookie_and_crumb()
2025-04-19 14:31:36,704 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:36,704 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:36,705 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:36,705 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:36,705 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:36,705 - DEBUG - [wrapper]   Exiting _get_cookie_and_crumb()
2025-04-19 14:31:36,798 - DEBUG - [_make_request] https://query1.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/AAPL?symbol=AAPL&type=trailingPegRatio&period1=1729296000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 247
2025-04-19 14:31:36,798 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:36,798 - DEBUG - [wrapper]  Exiting _make_request()
2025-04-19 14:31:36,798 - DEBUG - [wrapper] Exiting get()
2025-04-19 14:31:36,798 - DEBUG - [fetch_company_info] Skip complex type key 'companyOfficers'
2025-04-19 14:31:36,799 - DEBUG - [fetch_company_info] Skip complex type key 'executiveTeam'
2025-04-19 14:31:36,799 - DEBUG - [fetch_company_info] Skip complex type key 'corporateActions'
2025-04-19 14:31:36,826 - DEBUG - [fetch_financial_statement] Fetching annual financials for AAPL
2025-04-19 14:31:36,826 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:36,826 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:36,826 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:36,826 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/AAPL?symbol=AAPL&type=quarterlyTaxEffectOfUnusualItems,quarterlyTaxRateForCalcs,quarterlyNormalizedEBITDA,quarterlyNor...
2025-04-19 14:31:36,826 - DEBUG - [_make_request] params=None
2025-04-19 14:31:36,826 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:36,826 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:36,826 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:36,826 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:36,826 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:36,827 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:36,827 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:37,005 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/AAPL?symbol=AAPL&type=quarterlyTaxEffectOfUnusualItems,quarterlyTaxRateForCalcs,quarterlyNormalizedEBITDA,quarterlyNormalizedDilutedEPS,quarterlyNormalizedBasicEPS,quarterlyTotalUnusualItems,quarterlyTotalUnusualItemsExcludingGoodwill,quarterlyNetIncomeFromContinuingOperationNetMinorityInterest,quarterlyReconciledDepreciation,quarterlyReconciledCostOfRevenue,quarterlyEBITDA,quarterlyEBIT,quarterlyNetInterestIncome,quarterlyInterestExpense,quarterlyInterestIncome,quarterlyContinuingAndDiscontinuedDilutedEPS,quarterlyContinuingAndDiscontinuedBasicEPS,quarterlyNormalizedIncome,quarterlyNetIncomeFromContinuingAndDiscontinuedOperation,quarterlyTotalExpenses,quarterlyRentExpenseSupplemental,quarterlyReportedNormalizedDilutedEPS,quarterlyReportedNormalizedBasicEPS,quarterlyTotalOperatingIncomeAsReported,quarterlyDividendPerShare,quarterlyDilutedAverageShares,quarterlyBasicAverageShares,quarterlyDilutedEPS,quarterlyDilutedEPSOtherGainsLosses,quarterlyTaxLossCarryforwardDilutedEPS,quarterlyDilutedAccountingChange,quarterlyDilutedExtraordinary,quarterlyDilutedDiscontinuousOperations,quarterlyDilutedContinuousOperations,quarterlyBasicEPS,quarterlyBasicEPSOtherGainsLosses,quarterlyTaxLossCarryforwardBasicEPS,quarterlyBasicAccountingChange,quarterlyBasicExtraordinary,quarterlyBasicDiscontinuousOperations,quarterlyBasicContinuousOperations,quarterlyDilutedNIAvailtoComStockholders,quarterlyAverageDilutionEarnings,quarterlyNetIncomeCommonStockholders,quarterlyOtherunderPreferredStockDividend,quarterlyPreferredStockDividends,quarterlyNetIncome,quarterlyMinorityInterests,quarterlyNetIncomeIncludingNoncontrollingInterests,quarterlyNetIncomeFromTaxLossCarryforward,quarterlyNetIncomeExtraordinary,quarterlyNetIncomeDiscontinuousOperations,quarterlyNetIncomeContinuousOperations,quarterlyEarningsFromEquityInterestNetOfTax,quarterlyTaxProvision,quarterlyPretaxIncome,quarterlyOtherIncomeExpense,quarterlyOtherNonOperatingIncomeExpenses,quarterlySpecialIncomeCharges,quarterlyGainOnSaleOfPPE,quarterlyGainOnSaleOfBusiness,quarterlyOtherSpecialCharges,quarterlyWriteOff,quarterlyImpairmentOfCapitalAssets,quarterlyRestructuringAndMergernAcquisition,quarterlySecuritiesAmortization,quarterlyEarningsFromEquityInterest,quarterlyGainOnSaleOfSecurity,quarterlyNetNonOperatingInterestIncomeExpense,quarterlyTotalOtherFinanceCost,quarterlyInterestExpenseNonOperating,quarterlyInterestIncomeNonOperating,quarterlyOperatingIncome,quarterlyOperatingExpense,quarterlyOtherOperatingExpenses,quarterlyOtherTaxes,quarterlyProvisionForDoubtfulAccounts,quarterlyDepreciationAmortizationDepletionIncomeStatement,quarterlyDepletionIncomeStatement,quarterlyDepreciationAndAmortizationInIncomeStatement,quarterlyAmortization,quarterlyAmortizationOfIntangiblesIncomeStatement,quarterlyDepreciationIncomeStatement,quarterlyResearchAndDevelopment,quarterlySellingGeneralAndAdministration,quarterlySellingAndMarketingExpense,quarterlyGeneralAndAdministrativeExpense,quarterlyOtherGandA,quarterlyInsuranceAndClaims,quarterlyRentAndLandingFees,quarterlySalariesAndWages,quarterlyGrossProfit,quarterlyCostOfRevenue,quarterlyTotalRevenue,quarterlyExciseTaxes,quarterlyOperatingRevenue,quarterlyLossAdjustmentExpense,quarterlyNetPolicyholderBenefitsAndClaims,quarterlyPolicyholderBenefitsGross,quarterlyPolicyholderBenefitsCeded,quarterlyOccupancyAndEquipment,quarterlyProfessionalExpenseAndContractServicesExpense,quarterlyOtherNonInterestExpense&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:37,007 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:37,007 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:37,007 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:37,047 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:37,050 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:37,050 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:37,050 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:37,050 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/AAPL?symbol=AAPL&type=annualTaxEffectOfUnusualItems,annualTaxRateForCalcs,annualNormalizedEBITDA,annualNormalizedDilut...
2025-04-19 14:31:37,050 - DEBUG - [_make_request] params=None
2025-04-19 14:31:37,050 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:37,050 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:37,050 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:37,051 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:37,051 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:37,051 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:37,051 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:37,249 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/AAPL?symbol=AAPL&type=annualTaxEffectOfUnusualItems,annualTaxRateForCalcs,annualNormalizedEBITDA,annualNormalizedDilutedEPS,annualNormalizedBasicEPS,annualTotalUnusualItems,annualTotalUnusualItemsExcludingGoodwill,annualNetIncomeFromContinuingOperationNetMinorityInterest,annualReconciledDepreciation,annualReconciledCostOfRevenue,annualEBITDA,annualEBIT,annualNetInterestIncome,annualInterestExpense,annualInterestIncome,annualContinuingAndDiscontinuedDilutedEPS,annualContinuingAndDiscontinuedBasicEPS,annualNormalizedIncome,annualNetIncomeFromContinuingAndDiscontinuedOperation,annualTotalExpenses,annualRentExpenseSupplemental,annualReportedNormalizedDilutedEPS,annualReportedNormalizedBasicEPS,annualTotalOperatingIncomeAsReported,annualDividendPerShare,annualDilutedAverageShares,annualBasicAverageShares,annualDilutedEPS,annualDilutedEPSOtherGainsLosses,annualTaxLossCarryforwardDilutedEPS,annualDilutedAccountingChange,annualDilutedExtraordinary,annualDilutedDiscontinuousOperations,annualDilutedContinuousOperations,annualBasicEPS,annualBasicEPSOtherGainsLosses,annualTaxLossCarryforwardBasicEPS,annualBasicAccountingChange,annualBasicExtraordinary,annualBasicDiscontinuousOperations,annualBasicContinuousOperations,annualDilutedNIAvailtoComStockholders,annualAverageDilutionEarnings,annualNetIncomeCommonStockholders,annualOtherunderPreferredStockDividend,annualPreferredStockDividends,annualNetIncome,annualMinorityInterests,annualNetIncomeIncludingNoncontrollingInterests,annualNetIncomeFromTaxLossCarryforward,annualNetIncomeExtraordinary,annualNetIncomeDiscontinuousOperations,annualNetIncomeContinuousOperations,annualEarningsFromEquityInterestNetOfTax,annualTaxProvision,annualPretaxIncome,annualOtherIncomeExpense,annualOtherNonOperatingIncomeExpenses,annualSpecialIncomeCharges,annualGainOnSaleOfPPE,annualGainOnSaleOfBusiness,annualOtherSpecialCharges,annualWriteOff,annualImpairmentOfCapitalAssets,annualRestructuringAndMergernAcquisition,annualSecuritiesAmortization,annualEarningsFromEquityInterest,annualGainOnSaleOfSecurity,annualNetNonOperatingInterestIncomeExpense,annualTotalOtherFinanceCost,annualInterestExpenseNonOperating,annualInterestIncomeNonOperating,annualOperatingIncome,annualOperatingExpense,annualOtherOperatingExpenses,annualOtherTaxes,annualProvisionForDoubtfulAccounts,annualDepreciationAmortizationDepletionIncomeStatement,annualDepletionIncomeStatement,annualDepreciationAndAmortizationInIncomeStatement,annualAmortization,annualAmortizationOfIntangiblesIncomeStatement,annualDepreciationIncomeStatement,annualResearchAndDevelopment,annualSellingGeneralAndAdministration,annualSellingAndMarketingExpense,annualGeneralAndAdministrativeExpense,annualOtherGandA,annualInsuranceAndClaims,annualRentAndLandingFees,annualSalariesAndWages,annualGrossProfit,annualCostOfRevenue,annualTotalRevenue,annualExciseTaxes,annualOperatingRevenue,annualLossAdjustmentExpense,annualNetPolicyholderBenefitsAndClaims,annualPolicyholderBenefitsGross,annualPolicyholderBenefitsCeded,annualOccupancyAndEquipment,annualProfessionalExpenseAndContractServicesExpense,annualOtherNonInterestExpense&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:37,250 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:37,251 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:37,251 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:37,285 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:37,287 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:37,287 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:37,287 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:37,287 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/AAPL?symbol=AAPL&type=quarterlyTreasurySharesNumber,quarterlyPreferredSharesNumber,quarterlyOrdinarySharesNumber,quart...
2025-04-19 14:31:37,287 - DEBUG - [_make_request] params=None
2025-04-19 14:31:37,288 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:37,288 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:37,288 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:37,288 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:37,288 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:37,288 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:37,288 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:37,512 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/AAPL?symbol=AAPL&type=quarterlyTreasurySharesNumber,quarterlyPreferredSharesNumber,quarterlyOrdinarySharesNumber,quarterlyShareIssued,quarterlyNetDebt,quarterlyTotalDebt,quarterlyTangibleBookValue,quarterlyInvestedCapital,quarterlyWorkingCapital,quarterlyNetTangibleAssets,quarterlyCapitalLeaseObligations,quarterlyCommonStockEquity,quarterlyPreferredStockEquity,quarterlyTotalCapitalization,quarterlyTotalEquityGrossMinorityInterest,quarterlyMinorityInterest,quarterlyStockholdersEquity,quarterlyOtherEquityInterest,quarterlyGainsLossesNotAffectingRetainedEarnings,quarterlyOtherEquityAdjustments,quarterlyFixedAssetsRevaluationReserve,quarterlyForeignCurrencyTranslationAdjustments,quarterlyMinimumPensionLiabilities,quarterlyUnrealizedGainLoss,quarterlyTreasuryStock,quarterlyRetainedEarnings,quarterlyAdditionalPaidInCapital,quarterlyCapitalStock,quarterlyOtherCapitalStock,quarterlyCommonStock,quarterlyPreferredStock,quarterlyTotalPartnershipCapital,quarterlyGeneralPartnershipCapital,quarterlyLimitedPartnershipCapital,quarterlyTotalLiabilitiesNetMinorityInterest,quarterlyTotalNonCurrentLiabilitiesNetMinorityInterest,quarterlyOtherNonCurrentLiabilities,quarterlyLiabilitiesHeldforSaleNonCurrent,quarterlyRestrictedCommonStock,quarterlyPreferredSecuritiesOutsideStockEquity,quarterlyDerivativeProductLiabilities,quarterlyEmployeeBenefits,quarterlyNonCurrentPensionAndOtherPostretirementBenefitPlans,quarterlyNonCurrentAccruedExpenses,quarterlyDuetoRelatedPartiesNonCurrent,quarterlyTradeandOtherPayablesNonCurrent,quarterlyNonCurrentDeferredLiabilities,quarterlyNonCurrentDeferredRevenue,quarterlyNonCurrentDeferredTaxesLiabilities,quarterlyLongTermDebtAndCapitalLeaseObligation,quarterlyLongTermCapitalLeaseObligation,quarterlyLongTermDebt,quarterlyLongTermProvisions,quarterlyCurrentLiabilities,quarterlyOtherCurrentLiabilities,quarterlyCurrentDeferredLiabilities,quarterlyCurrentDeferredRevenue,quarterlyCurrentDeferredTaxesLiabilities,quarterlyCurrentDebtAndCapitalLeaseObligation,quarterlyCurrentCapitalLeaseObligation,quarterlyCurrentDebt,quarterlyOtherCurrentBorrowings,quarterlyLineOfCredit,quarterlyCommercialPaper,quarterlyCurrentNotesPayable,quarterlyPensionandOtherPostRetirementBenefitPlansCurrent,quarterlyCurrentProvisions,quarterlyPayablesAndAccruedExpenses,quarterlyCurrentAccruedExpenses,quarterlyInterestPayable,quarterlyPayables,quarterlyOtherPayable,quarterlyDuetoRelatedPartiesCurrent,quarterlyDividendsPayable,quarterlyTotalTaxPayable,quarterlyIncomeTaxPayable,quarterlyAccountsPayable,quarterlyTotalAssets,quarterlyTotalNonCurrentAssets,quarterlyOtherNonCurrentAssets,quarterlyDefinedPensionBenefit,quarterlyNonCurrentPrepaidAssets,quarterlyNonCurrentDeferredAssets,quarterlyNonCurrentDeferredTaxesAssets,quarterlyDuefromRelatedPartiesNonCurrent,quarterlyNonCurrentNoteReceivables,quarterlyNonCurrentAccountsReceivable,quarterlyFinancialAssets,quarterlyInvestmentsAndAdvances,quarterlyOtherInvestments,quarterlyInvestmentinFinancialAssets,quarterlyHeldToMaturitySecurities,quarterlyAvailableForSaleSecurities,quarterlyFinancialAssetsDesignatedasFairValueThroughProfitorLossTotal,quarterlyTradingSecurities,quarterlyLongTermEquityInvestment,quarterlyInvestmentsinJointVenturesatCost,quarterlyInvestmentsInOtherVenturesUnderEquityMethod,quarterlyInvestmentsinAssociatesatCost,quarterlyInvestmentsinSubsidiariesatCost,quarterlyInvestmentProperties,quarterlyGoodwillAndOtherIntangibleAssets,quarterlyOtherIntangibleAssets,quarterlyGoodwill,quarterlyNetPPE,quarterlyAccumulatedDepreciation,quarterlyGrossPPE,quarterlyLeases,quarterlyConstructionInProgress,quarterlyOtherProperties,quarterlyMachineryFurnitureEquipment,quarterlyBuildingsAndImprovements,quarterlyLandAndImprovements,quarterlyProperties,quarterlyCurrentAssets,quarterlyOtherCurrentAssets,quarterlyHedgingAssetsCurrent,quarterlyAssetsHeldForSaleCurrent,quarterlyCurrentDeferredAssets,quarterlyCurrentDeferredTaxesAssets,quarterlyRestrictedCash,quarterlyPrepaidAssets,quarterlyInventory,quarterlyInventoriesAdjustmentsAllowances,quarterlyOtherInventories,quarterlyFinishedGoods,quarterlyWorkInProcess,quarterlyRawMaterials,quarterlyReceivables,quarterlyReceivablesAdjustmentsAllowances,quarterlyOtherReceivables,quarterlyDuefromRelatedPartiesCurrent,quarterlyTaxesReceivable,quarterlyAccruedInterestReceivable,quarterlyNotesReceivable,quarterlyLoansReceivable,quarterlyAccountsReceivable,quarterlyAllowanceForDoubtfulAccountsReceivable,quarterlyGrossAccountsReceivable,quarterlyCashCashEquivalentsAndShortTermInvestments,quarterlyOtherShortTermInvestments,quarterlyCashAndCashEquivalents,quarterlyCashEquivalents,quarterlyCashFinancial,quarterlyCashCashEquivalentsAndFederalFundsSold&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:37,540 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:37,540 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:37,540 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:37,590 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:37,592 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:37,593 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:37,593 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:37,593 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/AAPL?symbol=AAPL&type=annualTreasurySharesNumber,annualPreferredSharesNumber,annualOrdinarySharesNumber,annualShareIss...
2025-04-19 14:31:37,593 - DEBUG - [_make_request] params=None
2025-04-19 14:31:37,593 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:37,593 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:37,593 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:37,593 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:37,593 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:37,593 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:37,593 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:37,812 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/AAPL?symbol=AAPL&type=annualTreasurySharesNumber,annualPreferredSharesNumber,annualOrdinarySharesNumber,annualShareIssued,annualNetDebt,annualTotalDebt,annualTangibleBookValue,annualInvestedCapital,annualWorkingCapital,annualNetTangibleAssets,annualCapitalLeaseObligations,annualCommonStockEquity,annualPreferredStockEquity,annualTotalCapitalization,annualTotalEquityGrossMinorityInterest,annualMinorityInterest,annualStockholdersEquity,annualOtherEquityInterest,annualGainsLossesNotAffectingRetainedEarnings,annualOtherEquityAdjustments,annualFixedAssetsRevaluationReserve,annualForeignCurrencyTranslationAdjustments,annualMinimumPensionLiabilities,annualUnrealizedGainLoss,annualTreasuryStock,annualRetainedEarnings,annualAdditionalPaidInCapital,annualCapitalStock,annualOtherCapitalStock,annualCommonStock,annualPreferredStock,annualTotalPartnershipCapital,annualGeneralPartnershipCapital,annualLimitedPartnershipCapital,annualTotalLiabilitiesNetMinorityInterest,annualTotalNonCurrentLiabilitiesNetMinorityInterest,annualOtherNonCurrentLiabilities,annualLiabilitiesHeldforSaleNonCurrent,annualRestrictedCommonStock,annualPreferredSecuritiesOutsideStockEquity,annualDerivativeProductLiabilities,annualEmployeeBenefits,annualNonCurrentPensionAndOtherPostretirementBenefitPlans,annualNonCurrentAccruedExpenses,annualDuetoRelatedPartiesNonCurrent,annualTradeandOtherPayablesNonCurrent,annualNonCurrentDeferredLiabilities,annualNonCurrentDeferredRevenue,annualNonCurrentDeferredTaxesLiabilities,annualLongTermDebtAndCapitalLeaseObligation,annualLongTermCapitalLeaseObligation,annualLongTermDebt,annualLongTermProvisions,annualCurrentLiabilities,annualOtherCurrentLiabilities,annualCurrentDeferredLiabilities,annualCurrentDeferredRevenue,annualCurrentDeferredTaxesLiabilities,annualCurrentDebtAndCapitalLeaseObligation,annualCurrentCapitalLeaseObligation,annualCurrentDebt,annualOtherCurrentBorrowings,annualLineOfCredit,annualCommercialPaper,annualCurrentNotesPayable,annualPensionandOtherPostRetirementBenefitPlansCurrent,annualCurrentProvisions,annualPayablesAndAccruedExpenses,annualCurrentAccruedExpenses,annualInterestPayable,annualPayables,annualOtherPayable,annualDuetoRelatedPartiesCurrent,annualDividendsPayable,annualTotalTaxPayable,annualIncomeTaxPayable,annualAccountsPayable,annualTotalAssets,annualTotalNonCurrentAssets,annualOtherNonCurrentAssets,annualDefinedPensionBenefit,annualNonCurrentPrepaidAssets,annualNonCurrentDeferredAssets,annualNonCurrentDeferredTaxesAssets,annualDuefromRelatedPartiesNonCurrent,annualNonCurrentNoteReceivables,annualNonCurrentAccountsReceivable,annualFinancialAssets,annualInvestmentsAndAdvances,annualOtherInvestments,annualInvestmentinFinancialAssets,annualHeldToMaturitySecurities,annualAvailableForSaleSecurities,annualFinancialAssetsDesignatedasFairValueThroughProfitorLossTotal,annualTradingSecurities,annualLongTermEquityInvestment,annualInvestmentsinJointVenturesatCost,annualInvestmentsInOtherVenturesUnderEquityMethod,annualInvestmentsinAssociatesatCost,annualInvestmentsinSubsidiariesatCost,annualInvestmentProperties,annualGoodwillAndOtherIntangibleAssets,annualOtherIntangibleAssets,annualGoodwill,annualNetPPE,annualAccumulatedDepreciation,annualGrossPPE,annualLeases,annualConstructionInProgress,annualOtherProperties,annualMachineryFurnitureEquipment,annualBuildingsAndImprovements,annualLandAndImprovements,annualProperties,annualCurrentAssets,annualOtherCurrentAssets,annualHedgingAssetsCurrent,annualAssetsHeldForSaleCurrent,annualCurrentDeferredAssets,annualCurrentDeferredTaxesAssets,annualRestrictedCash,annualPrepaidAssets,annualInventory,annualInventoriesAdjustmentsAllowances,annualOtherInventories,annualFinishedGoods,annualWorkInProcess,annualRawMaterials,annualReceivables,annualReceivablesAdjustmentsAllowances,annualOtherReceivables,annualDuefromRelatedPartiesCurrent,annualTaxesReceivable,annualAccruedInterestReceivable,annualNotesReceivable,annualLoansReceivable,annualAccountsReceivable,annualAllowanceForDoubtfulAccountsReceivable,annualGrossAccountsReceivable,annualCashCashEquivalentsAndShortTermInvestments,annualOtherShortTermInvestments,annualCashAndCashEquivalents,annualCashEquivalents,annualCashFinancial,annualCashCashEquivalentsAndFederalFundsSold&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:37,814 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:37,815 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:37,815 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:37,874 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:37,886 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:37,887 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:37,887 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:37,887 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/AAPL?symbol=AAPL&type=quarterlyForeignSales,quarterlyDomesticSales,quarterlyAdjustedGeographySegmentData,quarterlyFree...
2025-04-19 14:31:37,887 - DEBUG - [_make_request] params=None
2025-04-19 14:31:37,887 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:37,887 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:37,887 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:37,887 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:37,887 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:37,887 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:37,887 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:38,301 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/AAPL?symbol=AAPL&type=quarterlyForeignSales,quarterlyDomesticSales,quarterlyAdjustedGeographySegmentData,quarterlyFreeCashFlow,quarterlyRepurchaseOfCapitalStock,quarterlyRepaymentOfDebt,quarterlyIssuanceOfDebt,quarterlyIssuanceOfCapitalStock,quarterlyCapitalExpenditure,quarterlyInterestPaidSupplementalData,quarterlyIncomeTaxPaidSupplementalData,quarterlyEndCashPosition,quarterlyOtherCashAdjustmentOutsideChangeinCash,quarterlyBeginningCashPosition,quarterlyEffectOfExchangeRateChanges,quarterlyChangesInCash,quarterlyOtherCashAdjustmentInsideChangeinCash,quarterlyCashFlowFromDiscontinuedOperation,quarterlyFinancingCashFlow,quarterlyCashFromDiscontinuedFinancingActivities,quarterlyCashFlowFromContinuingFinancingActivities,quarterlyNetOtherFinancingCharges,quarterlyInterestPaidCFF,quarterlyProceedsFromStockOptionExercised,quarterlyCashDividendsPaid,quarterlyPreferredStockDividendPaid,quarterlyCommonStockDividendPaid,quarterlyNetPreferredStockIssuance,quarterlyPreferredStockPayments,quarterlyPreferredStockIssuance,quarterlyNetCommonStockIssuance,quarterlyCommonStockPayments,quarterlyCommonStockIssuance,quarterlyNetIssuancePaymentsOfDebt,quarterlyNetShortTermDebtIssuance,quarterlyShortTermDebtPayments,quarterlyShortTermDebtIssuance,quarterlyNetLongTermDebtIssuance,quarterlyLongTermDebtPayments,quarterlyLongTermDebtIssuance,quarterlyInvestingCashFlow,quarterlyCashFromDiscontinuedInvestingActivities,quarterlyCashFlowFromContinuingInvestingActivities,quarterlyNetOtherInvestingChanges,quarterlyInterestReceivedCFI,quarterlyDividendsReceivedCFI,quarterlyNetInvestmentPurchaseAndSale,quarterlySaleOfInvestment,quarterlyPurchaseOfInvestment,quarterlyNetInvestmentPropertiesPurchaseAndSale,quarterlySaleOfInvestmentProperties,quarterlyPurchaseOfInvestmentProperties,quarterlyNetBusinessPurchaseAndSale,quarterlySaleOfBusiness,quarterlyPurchaseOfBusiness,quarterlyNetIntangiblesPurchaseAndSale,quarterlySaleOfIntangibles,quarterlyPurchaseOfIntangibles,quarterlyNetPPEPurchaseAndSale,quarterlySaleOfPPE,quarterlyPurchaseOfPPE,quarterlyCapitalExpenditureReported,quarterlyOperatingCashFlow,quarterlyCashFromDiscontinuedOperatingActivities,quarterlyCashFlowFromContinuingOperatingActivities,quarterlyTaxesRefundPaid,quarterlyInterestReceivedCFO,quarterlyInterestPaidCFO,quarterlyDividendReceivedCFO,quarterlyDividendPaidCFO,quarterlyChangeInWorkingCapital,quarterlyChangeInOtherWorkingCapital,quarterlyChangeInOtherCurrentLiabilities,quarterlyChangeInOtherCurrentAssets,quarterlyChangeInPayablesAndAccruedExpense,quarterlyChangeInAccruedExpense,quarterlyChangeInInterestPayable,quarterlyChangeInPayable,quarterlyChangeInDividendPayable,quarterlyChangeInAccountPayable,quarterlyChangeInTaxPayable,quarterlyChangeInIncomeTaxPayable,quarterlyChangeInPrepaidAssets,quarterlyChangeInInventory,quarterlyChangeInReceivables,quarterlyChangesInAccountReceivables,quarterlyOtherNonCashItems,quarterlyExcessTaxBenefitFromStockBasedCompensation,quarterlyStockBasedCompensation,quarterlyUnrealizedGainLossOnInvestmentSecurities,quarterlyProvisionandWriteOffofAssets,quarterlyAssetImpairmentCharge,quarterlyAmortizationOfSecurities,quarterlyDeferredTax,quarterlyDeferredIncomeTax,quarterlyDepreciationAmortizationDepletion,quarterlyDepletion,quarterlyDepreciationAndAmortization,quarterlyAmortizationCashFlow,quarterlyAmortizationOfIntangibles,quarterlyDepreciation,quarterlyOperatingGainsLosses,quarterlyPensionAndEmployeeBenefitExpense,quarterlyEarningsLossesFromEquityInvestments,quarterlyGainLossOnInvestmentSecurities,quarterlyNetForeignCurrencyExchangeGainLoss,quarterlyGainLossOnSaleOfPPE,quarterlyGainLossOnSaleOfBusiness,quarterlyNetIncomeFromContinuingOperations,quarterlyCashFlowsfromusedinOperatingActivitiesDirect,quarterlyTaxesRefundPaidDirect,quarterlyInterestReceivedDirect,quarterlyInterestPaidDirect,quarterlyDividendsReceivedDirect,quarterlyDividendsPaidDirect,quarterlyClassesofCashPayments,quarterlyOtherCashPaymentsfromOperatingActivities,quarterlyPaymentsonBehalfofEmployees,quarterlyPaymentstoSuppliersforGoodsandServices,quarterlyClassesofCashReceiptsfromOperatingActivities,quarterlyOtherCashReceiptsfromOperatingActivities,quarterlyReceiptsfromGovernmentGrants,quarterlyReceiptsfromCustomers&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:38,303 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:38,303 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:38,303 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:38,346 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:38,347 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:38,347 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:38,347 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:38,348 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/AAPL?symbol=AAPL&type=annualForeignSales,annualDomesticSales,annualAdjustedGeographySegmentData,annualFreeCashFlow,ann...
2025-04-19 14:31:38,348 - DEBUG - [_make_request] params=None
2025-04-19 14:31:38,348 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:38,348 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:38,348 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:38,348 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:38,348 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:38,348 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:38,348 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:38,582 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/AAPL?symbol=AAPL&type=annualForeignSales,annualDomesticSales,annualAdjustedGeographySegmentData,annualFreeCashFlow,annualRepurchaseOfCapitalStock,annualRepaymentOfDebt,annualIssuanceOfDebt,annualIssuanceOfCapitalStock,annualCapitalExpenditure,annualInterestPaidSupplementalData,annualIncomeTaxPaidSupplementalData,annualEndCashPosition,annualOtherCashAdjustmentOutsideChangeinCash,annualBeginningCashPosition,annualEffectOfExchangeRateChanges,annualChangesInCash,annualOtherCashAdjustmentInsideChangeinCash,annualCashFlowFromDiscontinuedOperation,annualFinancingCashFlow,annualCashFromDiscontinuedFinancingActivities,annualCashFlowFromContinuingFinancingActivities,annualNetOtherFinancingCharges,annualInterestPaidCFF,annualProceedsFromStockOptionExercised,annualCashDividendsPaid,annualPreferredStockDividendPaid,annualCommonStockDividendPaid,annualNetPreferredStockIssuance,annualPreferredStockPayments,annualPreferredStockIssuance,annualNetCommonStockIssuance,annualCommonStockPayments,annualCommonStockIssuance,annualNetIssuancePaymentsOfDebt,annualNetShortTermDebtIssuance,annualShortTermDebtPayments,annualShortTermDebtIssuance,annualNetLongTermDebtIssuance,annualLongTermDebtPayments,annualLongTermDebtIssuance,annualInvestingCashFlow,annualCashFromDiscontinuedInvestingActivities,annualCashFlowFromContinuingInvestingActivities,annualNetOtherInvestingChanges,annualInterestReceivedCFI,annualDividendsReceivedCFI,annualNetInvestmentPurchaseAndSale,annualSaleOfInvestment,annualPurchaseOfInvestment,annualNetInvestmentPropertiesPurchaseAndSale,annualSaleOfInvestmentProperties,annualPurchaseOfInvestmentProperties,annualNetBusinessPurchaseAndSale,annualSaleOfBusiness,annualPurchaseOfBusiness,annualNetIntangiblesPurchaseAndSale,annualSaleOfIntangibles,annualPurchaseOfIntangibles,annualNetPPEPurchaseAndSale,annualSaleOfPPE,annualPurchaseOfPPE,annualCapitalExpenditureReported,annualOperatingCashFlow,annualCashFromDiscontinuedOperatingActivities,annualCashFlowFromContinuingOperatingActivities,annualTaxesRefundPaid,annualInterestReceivedCFO,annualInterestPaidCFO,annualDividendReceivedCFO,annualDividendPaidCFO,annualChangeInWorkingCapital,annualChangeInOtherWorkingCapital,annualChangeInOtherCurrentLiabilities,annualChangeInOtherCurrentAssets,annualChangeInPayablesAndAccruedExpense,annualChangeInAccruedExpense,annualChangeInInterestPayable,annualChangeInPayable,annualChangeInDividendPayable,annualChangeInAccountPayable,annualChangeInTaxPayable,annualChangeInIncomeTaxPayable,annualChangeInPrepaidAssets,annualChangeInInventory,annualChangeInReceivables,annualChangesInAccountReceivables,annualOtherNonCashItems,annualExcessTaxBenefitFromStockBasedCompensation,annualStockBasedCompensation,annualUnrealizedGainLossOnInvestmentSecurities,annualProvisionandWriteOffofAssets,annualAssetImpairmentCharge,annualAmortizationOfSecurities,annualDeferredTax,annualDeferredIncomeTax,annualDepreciationAmortizationDepletion,annualDepletion,annualDepreciationAndAmortization,annualAmortizationCashFlow,annualAmortizationOfIntangibles,annualDepreciation,annualOperatingGainsLosses,annualPensionAndEmployeeBenefitExpense,annualEarningsLossesFromEquityInvestments,annualGainLossOnInvestmentSecurities,annualNetForeignCurrencyExchangeGainLoss,annualGainLossOnSaleOfPPE,annualGainLossOnSaleOfBusiness,annualNetIncomeFromContinuingOperations,annualCashFlowsfromusedinOperatingActivitiesDirect,annualTaxesRefundPaidDirect,annualInterestReceivedDirect,annualInterestPaidDirect,annualDividendsReceivedDirect,annualDividendsPaidDirect,annualClassesofCashPayments,annualOtherCashPaymentsfromOperatingActivities,annualPaymentsonBehalfofEmployees,annualPaymentstoSuppliersforGoodsandServices,annualClassesofCashReceiptsfromOperatingActivities,annualOtherCashReceiptsfromOperatingActivities,annualReceiptsfromGovernmentGrants,annualReceiptsfromCustomers&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:38,585 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:38,585 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:38,585 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:38,635 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:38,649 - DEBUG - [fetch_financial_statement] Raw annual financials data head for AAPL:
                                                        2024-09-30      2023-09-30      2022-09-30      2021-09-30 2020-09-30
Tax Effect Of Unusual Items                                    0.0             0.0             0.0             0.0        NaN
Tax Rate For Calcs                                           0.241           0.147           0.162           0.133        NaN
Normalized EBITDA                                   134661000000.0  125820000000.0  130541000000.0  123136000000.0        NaN
Net Income From Continuing Operation Net Minori...   93736000000.0   96995000000.0   99803000000.0   94680000000.0        NaN
Reconciled Depreciation                              11445000000.0   11519000000.0   11104000000.0   11284000000.0        NaN
2025-04-19 14:31:38,649 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Tax Effect Of Unusual Items', 'Tax Rate For Calcs',
       'Normalized EBITDA',
       'Net Income From Continuing Operation Net Minority Interest',
       'Reconciled Depreciation', 'Reconciled Cost Of Revenue', 'EBITDA',
       'EBIT', 'Net Interest Income', 'Interest Expense', 'Interest Income',
       'Normalized Income',
       'Net Income From Continuing And Discontinued Operation',
       'Total Expenses', 'Total Operating Income As Reported',
       'Diluted Average Shares', 'Basic Average Shares', 'Diluted EPS',
       'Basic EPS', 'Diluted NI Availto Com Stockholders',
       'Net Income Common Stockholders', 'Net Income',
       'Net Income Including Noncontrolling Interests',
       'Net Income Continuous Operations', 'Tax Provision', 'Pretax Income',
       'Other Income Expense', 'Other Non Operating Income Expenses',
       'Net Non Operating Interest Income Expense',
       'Interest Expense Non Operating', 'Interest Income Non Operating',
       'Operating Income', 'Operating Expense', 'Research And Development',
       'Selling General And Administration', 'Gross Profit', 'Cost Of Revenue',
       'Total Revenue', 'Operating Revenue'],
      dtype='object')
2025-04-19 14:31:38,650 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-09-30', '2023-09-30', '2022-09-30', '2021-09-30',
               '2020-09-30'],
              dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:38,659 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 39 entries, Tax Effect Of Unusual Items to Operating Revenue
Data columns (total 5 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-09-30 00:00:00  33 non-null     object
 1   2023-09-30 00:00:00  39 non-null     object
 2   2022-09-30 00:00:00  39 non-null     object
 3   2021-09-30 00:00:00  39 non-null     object
 4   2020-09-30 00:00:00  6 non-null      object
dtypes: object(5)
memory usage: 1.8+ KB

2025-04-19 14:31:38,686 - DEBUG - [fetch_financial_statement] Fetching quarterly financials for AAPL
2025-04-19 14:31:38,694 - DEBUG - [fetch_financial_statement] Raw quarterly financials data head for AAPL:
                                                       2024-12-31     2024-09-30     2024-06-30     2024-03-31     2023-12-31 2023-09-30
Tax Effect Of Unusual Items                                   0.0            0.0            0.0            0.0            0.0        NaN
Tax Rate For Calcs                                           0.21           0.21          0.159          0.158           0.21        NaN
Normalized EBITDA                                   45912000000.0  32502000000.0  28202000000.0  30736000000.0  43221000000.0        NaN
Net Income From Continuing Operation Net Minori...  36330000000.0  14736000000.0  21448000000.0  23636000000.0  33916000000.0        NaN
Reconciled Depreciation                              3080000000.0   2911000000.0   2850000000.0   2836000000.0   2848000000.0        NaN
2025-04-19 14:31:38,694 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Tax Effect Of Unusual Items', 'Tax Rate For Calcs',
       'Normalized EBITDA',
       'Net Income From Continuing Operation Net Minority Interest',
       'Reconciled Depreciation', 'Reconciled Cost Of Revenue', 'EBITDA',
       'EBIT', 'Net Interest Income', 'Interest Expense', 'Interest Income',
       'Normalized Income',
       'Net Income From Continuing And Discontinued Operation',
       'Total Expenses', 'Total Operating Income As Reported',
       'Diluted Average Shares', 'Basic Average Shares', 'Diluted EPS',
       'Basic EPS', 'Diluted NI Availto Com Stockholders',
       'Net Income Common Stockholders', 'Net Income',
       'Net Income Including Noncontrolling Interests',
       'Net Income Continuous Operations', 'Tax Provision', 'Pretax Income',
       'Other Income Expense', 'Other Non Operating Income Expenses',
       'Net Non Operating Interest Income Expense',
       'Interest Expense Non Operating', 'Interest Income Non Operating',
       'Operating Income', 'Operating Expense', 'Research And Development',
       'Selling General And Administration', 'Gross Profit', 'Cost Of Revenue',
       'Total Revenue', 'Operating Revenue'],
      dtype='object')
2025-04-19 14:31:38,694 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-12-31', '2024-09-30', '2024-06-30', '2024-03-31',
               '2023-12-31', '2023-09-30'],
              dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:38,697 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 39 entries, Tax Effect Of Unusual Items to Operating Revenue
Data columns (total 6 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-12-31 00:00:00  33 non-null     object
 1   2024-09-30 00:00:00  33 non-null     object
 2   2024-06-30 00:00:00  33 non-null     object
 3   2024-03-31 00:00:00  33 non-null     object
 4   2023-12-31 00:00:00  33 non-null     object
 5   2023-09-30 00:00:00  6 non-null      object
dtypes: object(6)
memory usage: 2.1+ KB

2025-04-19 14:31:38,717 - DEBUG - [fetch_financial_statement] Fetching annual balance_sheet for AAPL
2025-04-19 14:31:38,724 - DEBUG - [fetch_financial_statement] Raw annual balance_sheet data head for AAPL:
                            2024-09-30      2023-09-30      2022-09-30      2021-09-30 2020-09-30
Treasury Shares Number             NaN             0.0             NaN             NaN        NaN
Ordinary Shares Number   15116786000.0   15550061000.0   15943425000.0   16426786000.0        NaN
Share Issued             15116786000.0   15550061000.0   15943425000.0   16426786000.0        NaN
Net Debt                 76686000000.0   81123000000.0   96423000000.0   89779000000.0        NaN
Total Debt              106629000000.0  111088000000.0  132480000000.0  136522000000.0        NaN
2025-04-19 14:31:38,725 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Treasury Shares Number', 'Ordinary Shares Number', 'Share Issued',
       'Net Debt', 'Total Debt', 'Tangible Book Value', 'Invested Capital',
       'Working Capital', 'Net Tangible Assets', 'Capital Lease Obligations',
       'Common Stock Equity', 'Total Capitalization',
       'Total Equity Gross Minority Interest', 'Stockholders Equity',
       'Gains Losses Not Affecting Retained Earnings',
       'Other Equity Adjustments', 'Retained Earnings', 'Capital Stock',
       'Common Stock', 'Total Liabilities Net Minority Interest',
       'Total Non Current Liabilities Net Minority Interest',
       'Other Non Current Liabilities', 'Tradeand Other Payables Non Current',
       'Long Term Debt And Capital Lease Obligation',
       'Long Term Capital Lease Obligation', 'Long Term Debt',
       'Current Liabilities', 'Other Current Liabilities',
       'Current Deferred Liabilities', 'Current Deferred Revenue',
       'Current Debt And Capital Lease Obligation',
       'Current Capital Lease Obligation', 'Current Debt',
       'Other Current Borrowings', 'Commercial Paper',
       'Payables And Accrued Expenses', 'Payables', 'Total Tax Payable',
       'Income Tax Payable', 'Accounts Payable', 'Total Assets',
       'Total Non Current Assets', 'Other Non Current Assets',
       'Non Current Deferred Assets', 'Non Current Deferred Taxes Assets',
       'Investments And Advances', 'Other Investments',
       'Investmentin Financial Assets', 'Available For Sale Securities',
       'Net PPE', 'Accumulated Depreciation', 'Gross PPE', 'Leases',
       'Other Properties', 'Machinery Furniture Equipment',
       'Land And Improvements', 'Properties', 'Current Assets',
       'Other Current Assets', 'Inventory', 'Receivables', 'Other Receivables',
       'Accounts Receivable',
       'Cash Cash Equivalents And Short Term Investments',
       'Other Short Term Investments', 'Cash And Cash Equivalents',
       'Cash Equivalents', 'Cash Financial'],
      dtype='object')
2025-04-19 14:31:38,725 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-09-30', '2023-09-30', '2022-09-30', '2021-09-30',
               '2020-09-30'],
              dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:38,727 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 68 entries, Treasury Shares Number to Cash Financial
Data columns (total 5 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-09-30 00:00:00  62 non-null     object
 1   2023-09-30 00:00:00  67 non-null     object
 2   2022-09-30 00:00:00  67 non-null     object
 3   2021-09-30 00:00:00  63 non-null     object
 4   2020-09-30 00:00:00  5 non-null      object
dtypes: object(5)
memory usage: 3.2+ KB

2025-04-19 14:31:38,761 - DEBUG - [fetch_financial_statement] Fetching quarterly balance_sheet for AAPL
2025-04-19 14:31:38,768 - DEBUG - [fetch_financial_statement] Raw quarterly balance_sheet data head for AAPL:
                           2024-12-31      2024-09-30      2024-06-30      2024-03-31      2023-12-31 2023-09-30
Treasury Shares Number            NaN             NaN             NaN             NaN             0.0        0.0
Ordinary Shares Number  15037874000.0   15116786000.0   15222259000.0   15337686000.0   15460223000.0        NaN
Share Issued            15037874000.0   15116786000.0   15222259000.0   15337686000.0   15460223000.0        NaN
Net Debt                66500000000.0   76686000000.0   75739000000.0   71895000000.0   67280000000.0        NaN
Total Debt              96799000000.0  106629000000.0  101304000000.0  104590000000.0  108040000000.0        NaN
2025-04-19 14:31:38,769 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Treasury Shares Number', 'Ordinary Shares Number', 'Share Issued',
       'Net Debt', 'Total Debt', 'Tangible Book Value', 'Invested Capital',
       'Working Capital', 'Net Tangible Assets', 'Capital Lease Obligations',
       'Common Stock Equity', 'Total Capitalization',
       'Total Equity Gross Minority Interest', 'Stockholders Equity',
       'Gains Losses Not Affecting Retained Earnings',
       'Other Equity Adjustments', 'Retained Earnings', 'Capital Stock',
       'Common Stock', 'Total Liabilities Net Minority Interest',
       'Total Non Current Liabilities Net Minority Interest',
       'Other Non Current Liabilities', 'Tradeand Other Payables Non Current',
       'Long Term Debt And Capital Lease Obligation',
       'Long Term Capital Lease Obligation', 'Long Term Debt',
       'Current Liabilities', 'Other Current Liabilities',
       'Current Deferred Liabilities', 'Current Deferred Revenue',
       'Current Debt And Capital Lease Obligation',
       'Current Capital Lease Obligation', 'Current Debt',
       'Other Current Borrowings', 'Commercial Paper',
       'Payables And Accrued Expenses', 'Payables', 'Total Tax Payable',
       'Income Tax Payable', 'Accounts Payable', 'Total Assets',
       'Total Non Current Assets', 'Other Non Current Assets',
       'Non Current Deferred Assets', 'Non Current Deferred Taxes Assets',
       'Investments And Advances', 'Investmentin Financial Assets',
       'Available For Sale Securities', 'Net PPE', 'Accumulated Depreciation',
       'Gross PPE', 'Leases', 'Other Properties',
       'Machinery Furniture Equipment', 'Land And Improvements', 'Properties',
       'Current Assets', 'Other Current Assets', 'Inventory', 'Finished Goods',
       'Raw Materials', 'Receivables', 'Other Receivables',
       'Accounts Receivable',
       'Cash Cash Equivalents And Short Term Investments',
       'Other Short Term Investments', 'Cash And Cash Equivalents',
       'Cash Equivalents', 'Cash Financial'],
      dtype='object')
2025-04-19 14:31:38,769 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-12-31', '2024-09-30', '2024-06-30', '2024-03-31',
               '2023-12-31', '2023-09-30'],
              dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:38,771 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 69 entries, Treasury Shares Number to Cash Financial
Data columns (total 6 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-12-31 00:00:00  55 non-null     object
 1   2024-09-30 00:00:00  62 non-null     object
 2   2024-06-30 00:00:00  53 non-null     object
 3   2024-03-31 00:00:00  53 non-null     object
 4   2023-12-31 00:00:00  54 non-null     object
 5   2023-09-30 00:00:00  14 non-null     object
dtypes: object(6)
memory usage: 3.8+ KB

2025-04-19 14:31:38,805 - DEBUG - [fetch_financial_statement] Fetching annual cashflow for AAPL
2025-04-19 14:31:38,813 - DEBUG - [fetch_financial_statement] Raw annual cashflow data head for AAPL:
                                 2024-09-30     2023-09-30      2022-09-30     2021-09-30   2020-09-30
Free Cash Flow               108807000000.0  99584000000.0  111443000000.0  92953000000.0          NaN
Repurchase Of Capital Stock  -94949000000.0 -77550000000.0  -89402000000.0 -85971000000.0          NaN
Repayment Of Debt             -9958000000.0 -11151000000.0   -9543000000.0  -8750000000.0          NaN
Issuance Of Debt                        0.0   5228000000.0    5465000000.0  20393000000.0          NaN
Issuance Of Capital Stock               NaN            NaN             NaN   1105000000.0  880000000.0
2025-04-19 14:31:38,846 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Free Cash Flow', 'Repurchase Of Capital Stock', 'Repayment Of Debt',
       'Issuance Of Debt', 'Issuance Of Capital Stock', 'Capital Expenditure',
       'Interest Paid Supplemental Data', 'Income Tax Paid Supplemental Data',
       'End Cash Position', 'Beginning Cash Position', 'Changes In Cash',
       'Financing Cash Flow', 'Cash Flow From Continuing Financing Activities',
       'Net Other Financing Charges', 'Cash Dividends Paid',
       'Common Stock Dividend Paid', 'Net Common Stock Issuance',
       'Common Stock Payments', 'Common Stock Issuance',
       'Net Issuance Payments Of Debt', 'Net Short Term Debt Issuance',
       'Net Long Term Debt Issuance', 'Long Term Debt Payments',
       'Long Term Debt Issuance', 'Investing Cash Flow',
       'Cash Flow From Continuing Investing Activities',
       'Net Other Investing Changes', 'Net Investment Purchase And Sale',
       'Sale Of Investment', 'Purchase Of Investment',
       'Net Business Purchase And Sale', 'Purchase Of Business',
       'Net PPE Purchase And Sale', 'Purchase Of PPE', 'Operating Cash Flow',
       'Cash Flow From Continuing Operating Activities',
       'Change In Working Capital', 'Change In Other Working Capital',
       'Change In Other Current Liabilities', 'Change In Other Current Assets',
       'Change In Payables And Accrued Expense', 'Change In Payable',
       'Change In Account Payable', 'Change In Inventory',
       'Change In Receivables', 'Changes In Account Receivables',
       'Other Non Cash Items', 'Stock Based Compensation', 'Deferred Tax',
       'Deferred Income Tax', 'Depreciation Amortization Depletion',
       'Depreciation And Amortization',
       'Net Income From Continuing Operations'],
      dtype='object')
2025-04-19 14:31:38,876 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-09-30', '2023-09-30', '2022-09-30', '2021-09-30',
               '2020-09-30'],
              dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:38,887 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 53 entries, Free Cash Flow to Net Income From Continuing Operations
Data columns (total 5 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-09-30 00:00:00  45 non-null     object
 1   2023-09-30 00:00:00  46 non-null     object
 2   2022-09-30 00:00:00  51 non-null     object
 3   2021-09-30 00:00:00  53 non-null     object
 4   2020-09-30 00:00:00  8 non-null      object
dtypes: object(5)
memory usage: 2.5+ KB

2025-04-19 14:31:38,923 - DEBUG - [fetch_financial_statement] Fetching quarterly cashflow for AAPL
2025-04-19 14:31:38,931 - DEBUG - [fetch_financial_statement] Raw quarterly cashflow data head for AAPL:
                                2024-12-31     2024-09-30     2024-06-30     2024-03-31     2023-12-31 2023-09-30
Free Cash Flow               26995000000.0  23903000000.0  26707000000.0  20694000000.0  37503000000.0        NaN
Repurchase Of Capital Stock -23606000000.0 -25083000000.0 -26522000000.0 -23205000000.0 -20139000000.0        NaN
Repayment Of Debt            -8953000000.0    427000000.0  -3253000000.0  -3148000000.0  -3984000000.0        NaN
Issuance Of Debt                       NaN            0.0            NaN            NaN            NaN        0.0
Capital Expenditure          -2940000000.0  -2908000000.0  -2151000000.0  -1996000000.0  -2392000000.0        NaN
2025-04-19 14:31:38,931 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Free Cash Flow', 'Repurchase Of Capital Stock', 'Repayment Of Debt',
       'Issuance Of Debt', 'Capital Expenditure',
       'Interest Paid Supplemental Data', 'Income Tax Paid Supplemental Data',
       'End Cash Position', 'Beginning Cash Position', 'Changes In Cash',
       'Financing Cash Flow', 'Cash Flow From Continuing Financing Activities',
       'Net Other Financing Charges', 'Cash Dividends Paid',
       'Common Stock Dividend Paid', 'Net Common Stock Issuance',
       'Common Stock Payments', 'Net Issuance Payments Of Debt',
       'Net Short Term Debt Issuance', 'Short Term Debt Payments',
       'Net Long Term Debt Issuance', 'Long Term Debt Payments',
       'Long Term Debt Issuance', 'Investing Cash Flow',
       'Cash Flow From Continuing Investing Activities',
       'Net Other Investing Changes', 'Net Investment Purchase And Sale',
       'Sale Of Investment', 'Purchase Of Investment',
       'Net PPE Purchase And Sale', 'Purchase Of PPE', 'Operating Cash Flow',
       'Cash Flow From Continuing Operating Activities',
       'Change In Working Capital', 'Change In Other Current Liabilities',
       'Change In Other Current Assets',
       'Change In Payables And Accrued Expense', 'Change In Payable',
       'Change In Account Payable', 'Change In Inventory',
       'Change In Receivables', 'Changes In Account Receivables',
       'Other Non Cash Items', 'Stock Based Compensation',
       'Depreciation Amortization Depletion', 'Depreciation And Amortization',
       'Net Income From Continuing Operations'],
      dtype='object')
2025-04-19 14:31:38,931 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-12-31', '2024-09-30', '2024-06-30', '2024-03-31',
               '2023-12-31', '2023-09-30'],
              dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:38,934 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 47 entries, Free Cash Flow to Net Income From Continuing Operations
Data columns (total 6 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-12-31 00:00:00  44 non-null     object
 1   2024-09-30 00:00:00  45 non-null     object
 2   2024-06-30 00:00:00  44 non-null     object
 3   2024-03-31 00:00:00  44 non-null     object
 4   2023-12-31 00:00:00  44 non-null     object
 5   2023-09-30 00:00:00  3 non-null      object
dtypes: object(6)
memory usage: 2.6+ KB

2025-04-19 14:31:38,957 - DEBUG - [fetch_stock_actions] Fetching actions for AAPL
2025-04-19 14:31:38,959 - DEBUG - [execute_sql] ('CREATE TABLE IF NOT EXISTS "_kv" ("key" VARCHAR(255) NOT NULL PRIMARY KEY, "value" VARCHAR(255)) WITHOUT ROWID', [])
2025-04-19 14:31:38,960 - DEBUG - [execute_sql] ('SELECT "t1"."key", "t1"."value" FROM "_kv" AS "t1" WHERE ("t1"."key" = ?) LIMIT ? OFFSET ?', ['AAPL', 1, 0])
2025-04-19 14:31:38,991 - DEBUG - [wrapper] Entering history()
2025-04-19 14:31:38,992 - DEBUG - [history] AAPL: Yahoo GET parameters: {'period1': '1926-05-14 15:31:38-04:00', 'period2': '2025-04-19 15:31:38-04:00', 'interval': '1d', 'includePrePost': True, 'events': 'div,splits,capitalGains'}
2025-04-19 14:31:38,992 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:38,992 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:38,992 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/v8/finance/chart/AAPL
2025-04-19 14:31:38,992 - DEBUG - [_make_request] params={'period1': -1376972902, 'period2': 1745091098, 'interval': '1d', 'includePrePost': True, 'events': 'div,splits,capitalGains'}
2025-04-19 14:31:38,992 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:38,992 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:38,992 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:38,992 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:38,992 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:38,992 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:38,992 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:39,187 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /v8/finance/chart/AAPL?period1=-1376972902&period2=1745091098&interval=1d&includePrePost=True&events=div%2Csplits%2CcapitalGains&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:39,983 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:39,983 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:39,983 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:40,027 - DEBUG - [history] AAPL: yfinance received OHLC data: 1980-12-12 14:30:00 -> 2025-04-17 13:30:00
2025-04-19 14:31:40,031 - DEBUG - [history] AAPL: OHLC after cleaning: 1980-12-12 09:30:00-05:00 -> 2025-04-17 09:30:00-04:00
2025-04-19 14:31:40,073 - DEBUG - [history] AAPL: OHLC after combining events: 1980-12-12 00:00:00-05:00 -> 2025-04-17 00:00:00-04:00
2025-04-19 14:31:40,078 - DEBUG - [history] AAPL: yfinance returning OHLC: 1980-12-12 00:00:00-05:00 -> 2025-04-17 00:00:00-04:00
2025-04-19 14:31:40,079 - DEBUG - [wrapper] Exiting history()
2025-04-19 14:31:40,087 - INFO - [load_data_to_table] Loading 1 rows company_profile Ticker AAPL (Mode initial_load)
2025-04-19 14:31:40,095 - DEBUG - [load_data_to_table] Loaded company_profile for AAPL.
2025-04-19 14:31:40,096 - INFO - [load_data_to_table] Loading 1 rows company_key_metrics Ticker AAPL (Mode initial_load)
2025-04-19 14:31:40,102 - DEBUG - [load_data_to_table] Loaded company_key_metrics for AAPL.
2025-04-19 14:31:40,102 - INFO - [load_data_to_table] Loading 5 rows financials_income_annual Ticker AAPL (Mode initial_load)
2025-04-19 14:31:40,103 - WARNING - [load_data_to_table] Cols missing DF->financials_income_annual (AAPL): ['TotalRevenue', 'CostOfRevenue', 'GrossProfit', 'OperatingIncome', 'NetIncome', 'NetIncomeFromContinuingOperations', 'NetIncomeApplicableToCommonShares', 'InterestExpense', 'IncomeBeforeTax', 'IncomeTaxExpense', 'ResearchDevelopment', 'SellingGeneralAdministrative', 'BasicEPS', 'DilutedEPS']. NULL.
2025-04-19 14:31:40,103 - ERROR - [load_data_to_table] Err prep DF financials_income_annual (AAPL): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:40,106 - INFO - [load_data_to_table] Loading 6 rows financials_income_quarterly Ticker AAPL (Mode initial_load)
2025-04-19 14:31:40,107 - WARNING - [load_data_to_table] Cols missing DF->financials_income_quarterly (AAPL): ['TotalRevenue', 'CostOfRevenue', 'GrossProfit', 'OperatingIncome', 'NetIncome', 'NetIncomeFromContinuingOperations', 'NetIncomeApplicableToCommonShares', 'InterestExpense', 'IncomeBeforeTax', 'IncomeTaxExpense', 'ResearchDevelopment', 'SellingGeneralAdministrative', 'BasicEPS', 'DilutedEPS']. NULL.
2025-04-19 14:31:40,107 - ERROR - [load_data_to_table] Err prep DF financials_income_quarterly (AAPL): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:40,108 - INFO - [load_data_to_table] Loading 5 rows financials_balance_annual Ticker AAPL (Mode initial_load)
2025-04-19 14:31:40,109 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_annual (AAPL): ['TotalAssets', 'CurrentAssets', 'TotalLiabilities', 'CurrentLiabilities', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'CommonStockEquity', 'CashAndCashEquivalents', 'AccountsReceivable', 'PropertyPlantEquipmentNet', 'AccountsPayable', 'ShortTermDebt', 'LongTermDebt', 'RetainedEarnings']. NULL.
2025-04-19 14:31:40,110 - ERROR - [load_data_to_table] Err prep DF financials_balance_annual (AAPL): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:40,110 - INFO - [load_data_to_table] Loading 6 rows financials_balance_quarterly Ticker AAPL (Mode initial_load)
2025-04-19 14:31:40,111 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_quarterly (AAPL): ['TotalAssets', 'CurrentAssets', 'TotalLiabilities', 'CurrentLiabilities', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'CommonStockEquity', 'CashAndCashEquivalents', 'AccountsReceivable', 'PropertyPlantEquipmentNet', 'AccountsPayable', 'ShortTermDebt', 'LongTermDebt', 'RetainedEarnings']. NULL.
2025-04-19 14:31:40,111 - ERROR - [load_data_to_table] Err prep DF financials_balance_quarterly (AAPL): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:40,111 - INFO - [load_data_to_table] Loading 5 rows financials_cashflow_annual Ticker AAPL (Mode initial_load)
2025-04-19 14:31:40,112 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_annual (AAPL): ['OperatingCashFlow', 'InvestingCashFlow', 'FinancingCashFlow', 'EndCashPosition', 'FreeCashFlow', 'CapitalExpenditure', 'IssuanceOfDebt', 'RepaymentOfDebt', 'RepurchaseOfCapitalStock', 'DividendPaid']. NULL.
2025-04-19 14:31:40,112 - ERROR - [load_data_to_table] Err prep DF financials_cashflow_annual (AAPL): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:40,113 - INFO - [load_data_to_table] Loading 6 rows financials_cashflow_quarterly Ticker AAPL (Mode initial_load)
2025-04-19 14:31:40,114 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_quarterly (AAPL): ['OperatingCashFlow', 'InvestingCashFlow', 'FinancingCashFlow', 'EndCashPosition', 'FreeCashFlow', 'CapitalExpenditure', 'IssuanceOfDebt', 'RepaymentOfDebt', 'RepurchaseOfCapitalStock', 'DividendPaid']. NULL.
2025-04-19 14:31:40,114 - ERROR - [load_data_to_table] Err prep DF financials_cashflow_quarterly (AAPL): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:40,114 - INFO - [load_data_to_table] Loading 91 rows stock_actions Ticker AAPL (Mode initial_load)
2025-04-19 14:31:40,117 - DEBUG - [load_data_to_table] Loaded stock_actions for AAPL.
2025-04-19 14:31:40,118 - WARNING - [run_stock_info_pipeline] Rollback AAPL due to load errors.
2025-04-19 14:31:40,118 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=AAPL, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 14:31:40,724 - DEBUG - [run_stock_info_pipeline] Processing 2/4: Ticker MSFT
2025-04-19 14:31:40,725 - DEBUG - [get_raw_json] get_raw_json(): https://query2.finance.yahoo.com/v10/finance/quoteSummary/MSFT
2025-04-19 14:31:40,726 - DEBUG - [wrapper] Entering get()
2025-04-19 14:31:40,726 - DEBUG - [wrapper]  Entering _make_request()
2025-04-19 14:31:40,726 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/v10/finance/quoteSummary/MSFT
2025-04-19 14:31:40,726 - DEBUG - [_make_request] params={'modules': 'financialData,quoteType,defaultKeyStatistics,assetProfile,summaryDetail', 'corsDomain': 'finance.yahoo.com', 'formatted': 'false', 'symbol': 'MSFT'}
2025-04-19 14:31:40,726 - DEBUG - [wrapper]   Entering _get_cookie_and_crumb()
2025-04-19 14:31:40,726 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:40,727 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:40,727 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:40,727 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:40,727 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:40,727 - DEBUG - [wrapper]   Exiting _get_cookie_and_crumb()
2025-04-19 14:31:40,829 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /v10/finance/quoteSummary/MSFT?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=MSFT&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:40,830 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:40,830 - DEBUG - [wrapper]  Exiting _make_request()
2025-04-19 14:31:40,830 - DEBUG - [wrapper] Exiting get()
2025-04-19 14:31:40,830 - DEBUG - [get_raw_json] get_raw_json(): https://query1.finance.yahoo.com/v7/finance/quote?
2025-04-19 14:31:40,830 - DEBUG - [wrapper] Entering get()
2025-04-19 14:31:40,830 - DEBUG - [wrapper]  Entering _make_request()
2025-04-19 14:31:40,830 - DEBUG - [_make_request] url=https://query1.finance.yahoo.com/v7/finance/quote?
2025-04-19 14:31:40,830 - DEBUG - [_make_request] params={'symbols': 'MSFT', 'formatted': 'false'}
2025-04-19 14:31:40,831 - DEBUG - [wrapper]   Entering _get_cookie_and_crumb()
2025-04-19 14:31:40,831 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:40,831 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:40,831 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:40,831 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:40,831 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:40,831 - DEBUG - [wrapper]   Exiting _get_cookie_and_crumb()
2025-04-19 14:31:40,929 - DEBUG - [_make_request] https://query1.finance.yahoo.com:443 "GET /v7/finance/quote?symbols=MSFT&formatted=false&crumb=NgZIowMiLwG HTTP/1.1" 200 1253
2025-04-19 14:31:40,929 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:40,929 - DEBUG - [wrapper]  Exiting _make_request()
2025-04-19 14:31:40,929 - DEBUG - [wrapper] Exiting get()
2025-04-19 14:31:40,931 - DEBUG - [wrapper] Entering get()
2025-04-19 14:31:40,931 - DEBUG - [wrapper]  Entering _make_request()
2025-04-19 14:31:40,931 - DEBUG - [_make_request] url=https://query1.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/MSFT?symbol=MSFT&type=trailingPegRatio&period1=1729296000&period2=1745107200
2025-04-19 14:31:40,931 - DEBUG - [_make_request] params=None
2025-04-19 14:31:40,931 - DEBUG - [wrapper]   Entering _get_cookie_and_crumb()
2025-04-19 14:31:40,931 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:40,931 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:40,932 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:40,932 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:40,932 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:40,932 - DEBUG - [wrapper]   Exiting _get_cookie_and_crumb()
2025-04-19 14:31:41,028 - DEBUG - [_make_request] https://query1.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/MSFT?symbol=MSFT&type=trailingPegRatio&period1=1729296000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 247
2025-04-19 14:31:41,035 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:41,035 - DEBUG - [wrapper]  Exiting _make_request()
2025-04-19 14:31:41,035 - DEBUG - [wrapper] Exiting get()
2025-04-19 14:31:41,036 - DEBUG - [fetch_company_info] Skip complex type key 'companyOfficers'
2025-04-19 14:31:41,036 - DEBUG - [fetch_company_info] Skip complex type key 'executiveTeam'
2025-04-19 14:31:41,037 - DEBUG - [fetch_company_info] Skip complex type key 'corporateActions'
2025-04-19 14:31:41,046 - DEBUG - [fetch_financial_statement] Fetching annual financials for MSFT
2025-04-19 14:31:41,046 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:41,047 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:41,047 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:41,047 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/MSFT?symbol=MSFT&type=quarterlyTaxEffectOfUnusualItems,quarterlyTaxRateForCalcs,quarterlyNormalizedEBITDA,quarterlyNor...
2025-04-19 14:31:41,047 - DEBUG - [_make_request] params=None
2025-04-19 14:31:41,047 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:41,047 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:41,048 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:41,048 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:41,048 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:41,048 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:41,048 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:41,263 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/MSFT?symbol=MSFT&type=quarterlyTaxEffectOfUnusualItems,quarterlyTaxRateForCalcs,quarterlyNormalizedEBITDA,quarterlyNormalizedDilutedEPS,quarterlyNormalizedBasicEPS,quarterlyTotalUnusualItems,quarterlyTotalUnusualItemsExcludingGoodwill,quarterlyNetIncomeFromContinuingOperationNetMinorityInterest,quarterlyReconciledDepreciation,quarterlyReconciledCostOfRevenue,quarterlyEBITDA,quarterlyEBIT,quarterlyNetInterestIncome,quarterlyInterestExpense,quarterlyInterestIncome,quarterlyContinuingAndDiscontinuedDilutedEPS,quarterlyContinuingAndDiscontinuedBasicEPS,quarterlyNormalizedIncome,quarterlyNetIncomeFromContinuingAndDiscontinuedOperation,quarterlyTotalExpenses,quarterlyRentExpenseSupplemental,quarterlyReportedNormalizedDilutedEPS,quarterlyReportedNormalizedBasicEPS,quarterlyTotalOperatingIncomeAsReported,quarterlyDividendPerShare,quarterlyDilutedAverageShares,quarterlyBasicAverageShares,quarterlyDilutedEPS,quarterlyDilutedEPSOtherGainsLosses,quarterlyTaxLossCarryforwardDilutedEPS,quarterlyDilutedAccountingChange,quarterlyDilutedExtraordinary,quarterlyDilutedDiscontinuousOperations,quarterlyDilutedContinuousOperations,quarterlyBasicEPS,quarterlyBasicEPSOtherGainsLosses,quarterlyTaxLossCarryforwardBasicEPS,quarterlyBasicAccountingChange,quarterlyBasicExtraordinary,quarterlyBasicDiscontinuousOperations,quarterlyBasicContinuousOperations,quarterlyDilutedNIAvailtoComStockholders,quarterlyAverageDilutionEarnings,quarterlyNetIncomeCommonStockholders,quarterlyOtherunderPreferredStockDividend,quarterlyPreferredStockDividends,quarterlyNetIncome,quarterlyMinorityInterests,quarterlyNetIncomeIncludingNoncontrollingInterests,quarterlyNetIncomeFromTaxLossCarryforward,quarterlyNetIncomeExtraordinary,quarterlyNetIncomeDiscontinuousOperations,quarterlyNetIncomeContinuousOperations,quarterlyEarningsFromEquityInterestNetOfTax,quarterlyTaxProvision,quarterlyPretaxIncome,quarterlyOtherIncomeExpense,quarterlyOtherNonOperatingIncomeExpenses,quarterlySpecialIncomeCharges,quarterlyGainOnSaleOfPPE,quarterlyGainOnSaleOfBusiness,quarterlyOtherSpecialCharges,quarterlyWriteOff,quarterlyImpairmentOfCapitalAssets,quarterlyRestructuringAndMergernAcquisition,quarterlySecuritiesAmortization,quarterlyEarningsFromEquityInterest,quarterlyGainOnSaleOfSecurity,quarterlyNetNonOperatingInterestIncomeExpense,quarterlyTotalOtherFinanceCost,quarterlyInterestExpenseNonOperating,quarterlyInterestIncomeNonOperating,quarterlyOperatingIncome,quarterlyOperatingExpense,quarterlyOtherOperatingExpenses,quarterlyOtherTaxes,quarterlyProvisionForDoubtfulAccounts,quarterlyDepreciationAmortizationDepletionIncomeStatement,quarterlyDepletionIncomeStatement,quarterlyDepreciationAndAmortizationInIncomeStatement,quarterlyAmortization,quarterlyAmortizationOfIntangiblesIncomeStatement,quarterlyDepreciationIncomeStatement,quarterlyResearchAndDevelopment,quarterlySellingGeneralAndAdministration,quarterlySellingAndMarketingExpense,quarterlyGeneralAndAdministrativeExpense,quarterlyOtherGandA,quarterlyInsuranceAndClaims,quarterlyRentAndLandingFees,quarterlySalariesAndWages,quarterlyGrossProfit,quarterlyCostOfRevenue,quarterlyTotalRevenue,quarterlyExciseTaxes,quarterlyOperatingRevenue,quarterlyLossAdjustmentExpense,quarterlyNetPolicyholderBenefitsAndClaims,quarterlyPolicyholderBenefitsGross,quarterlyPolicyholderBenefitsCeded,quarterlyOccupancyAndEquipment,quarterlyProfessionalExpenseAndContractServicesExpense,quarterlyOtherNonInterestExpense&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:41,265 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:41,265 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:41,266 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:41,282 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:41,283 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:41,283 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:41,283 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:41,283 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/MSFT?symbol=MSFT&type=annualTaxEffectOfUnusualItems,annualTaxRateForCalcs,annualNormalizedEBITDA,annualNormalizedDilut...
2025-04-19 14:31:41,283 - DEBUG - [_make_request] params=None
2025-04-19 14:31:41,283 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:41,284 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:41,284 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:41,284 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:41,284 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:41,284 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:41,284 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:41,501 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/MSFT?symbol=MSFT&type=annualTaxEffectOfUnusualItems,annualTaxRateForCalcs,annualNormalizedEBITDA,annualNormalizedDilutedEPS,annualNormalizedBasicEPS,annualTotalUnusualItems,annualTotalUnusualItemsExcludingGoodwill,annualNetIncomeFromContinuingOperationNetMinorityInterest,annualReconciledDepreciation,annualReconciledCostOfRevenue,annualEBITDA,annualEBIT,annualNetInterestIncome,annualInterestExpense,annualInterestIncome,annualContinuingAndDiscontinuedDilutedEPS,annualContinuingAndDiscontinuedBasicEPS,annualNormalizedIncome,annualNetIncomeFromContinuingAndDiscontinuedOperation,annualTotalExpenses,annualRentExpenseSupplemental,annualReportedNormalizedDilutedEPS,annualReportedNormalizedBasicEPS,annualTotalOperatingIncomeAsReported,annualDividendPerShare,annualDilutedAverageShares,annualBasicAverageShares,annualDilutedEPS,annualDilutedEPSOtherGainsLosses,annualTaxLossCarryforwardDilutedEPS,annualDilutedAccountingChange,annualDilutedExtraordinary,annualDilutedDiscontinuousOperations,annualDilutedContinuousOperations,annualBasicEPS,annualBasicEPSOtherGainsLosses,annualTaxLossCarryforwardBasicEPS,annualBasicAccountingChange,annualBasicExtraordinary,annualBasicDiscontinuousOperations,annualBasicContinuousOperations,annualDilutedNIAvailtoComStockholders,annualAverageDilutionEarnings,annualNetIncomeCommonStockholders,annualOtherunderPreferredStockDividend,annualPreferredStockDividends,annualNetIncome,annualMinorityInterests,annualNetIncomeIncludingNoncontrollingInterests,annualNetIncomeFromTaxLossCarryforward,annualNetIncomeExtraordinary,annualNetIncomeDiscontinuousOperations,annualNetIncomeContinuousOperations,annualEarningsFromEquityInterestNetOfTax,annualTaxProvision,annualPretaxIncome,annualOtherIncomeExpense,annualOtherNonOperatingIncomeExpenses,annualSpecialIncomeCharges,annualGainOnSaleOfPPE,annualGainOnSaleOfBusiness,annualOtherSpecialCharges,annualWriteOff,annualImpairmentOfCapitalAssets,annualRestructuringAndMergernAcquisition,annualSecuritiesAmortization,annualEarningsFromEquityInterest,annualGainOnSaleOfSecurity,annualNetNonOperatingInterestIncomeExpense,annualTotalOtherFinanceCost,annualInterestExpenseNonOperating,annualInterestIncomeNonOperating,annualOperatingIncome,annualOperatingExpense,annualOtherOperatingExpenses,annualOtherTaxes,annualProvisionForDoubtfulAccounts,annualDepreciationAmortizationDepletionIncomeStatement,annualDepletionIncomeStatement,annualDepreciationAndAmortizationInIncomeStatement,annualAmortization,annualAmortizationOfIntangiblesIncomeStatement,annualDepreciationIncomeStatement,annualResearchAndDevelopment,annualSellingGeneralAndAdministration,annualSellingAndMarketingExpense,annualGeneralAndAdministrativeExpense,annualOtherGandA,annualInsuranceAndClaims,annualRentAndLandingFees,annualSalariesAndWages,annualGrossProfit,annualCostOfRevenue,annualTotalRevenue,annualExciseTaxes,annualOperatingRevenue,annualLossAdjustmentExpense,annualNetPolicyholderBenefitsAndClaims,annualPolicyholderBenefitsGross,annualPolicyholderBenefitsCeded,annualOccupancyAndEquipment,annualProfessionalExpenseAndContractServicesExpense,annualOtherNonInterestExpense&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:41,502 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:41,503 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:41,503 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:41,532 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:41,533 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:41,533 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:41,533 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:41,534 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/MSFT?symbol=MSFT&type=quarterlyTreasurySharesNumber,quarterlyPreferredSharesNumber,quarterlyOrdinarySharesNumber,quart...
2025-04-19 14:31:41,534 - DEBUG - [_make_request] params=None
2025-04-19 14:31:41,534 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:41,534 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:41,534 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:41,534 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:41,534 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:41,534 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:41,534 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:41,794 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/MSFT?symbol=MSFT&type=quarterlyTreasurySharesNumber,quarterlyPreferredSharesNumber,quarterlyOrdinarySharesNumber,quarterlyShareIssued,quarterlyNetDebt,quarterlyTotalDebt,quarterlyTangibleBookValue,quarterlyInvestedCapital,quarterlyWorkingCapital,quarterlyNetTangibleAssets,quarterlyCapitalLeaseObligations,quarterlyCommonStockEquity,quarterlyPreferredStockEquity,quarterlyTotalCapitalization,quarterlyTotalEquityGrossMinorityInterest,quarterlyMinorityInterest,quarterlyStockholdersEquity,quarterlyOtherEquityInterest,quarterlyGainsLossesNotAffectingRetainedEarnings,quarterlyOtherEquityAdjustments,quarterlyFixedAssetsRevaluationReserve,quarterlyForeignCurrencyTranslationAdjustments,quarterlyMinimumPensionLiabilities,quarterlyUnrealizedGainLoss,quarterlyTreasuryStock,quarterlyRetainedEarnings,quarterlyAdditionalPaidInCapital,quarterlyCapitalStock,quarterlyOtherCapitalStock,quarterlyCommonStock,quarterlyPreferredStock,quarterlyTotalPartnershipCapital,quarterlyGeneralPartnershipCapital,quarterlyLimitedPartnershipCapital,quarterlyTotalLiabilitiesNetMinorityInterest,quarterlyTotalNonCurrentLiabilitiesNetMinorityInterest,quarterlyOtherNonCurrentLiabilities,quarterlyLiabilitiesHeldforSaleNonCurrent,quarterlyRestrictedCommonStock,quarterlyPreferredSecuritiesOutsideStockEquity,quarterlyDerivativeProductLiabilities,quarterlyEmployeeBenefits,quarterlyNonCurrentPensionAndOtherPostretirementBenefitPlans,quarterlyNonCurrentAccruedExpenses,quarterlyDuetoRelatedPartiesNonCurrent,quarterlyTradeandOtherPayablesNonCurrent,quarterlyNonCurrentDeferredLiabilities,quarterlyNonCurrentDeferredRevenue,quarterlyNonCurrentDeferredTaxesLiabilities,quarterlyLongTermDebtAndCapitalLeaseObligation,quarterlyLongTermCapitalLeaseObligation,quarterlyLongTermDebt,quarterlyLongTermProvisions,quarterlyCurrentLiabilities,quarterlyOtherCurrentLiabilities,quarterlyCurrentDeferredLiabilities,quarterlyCurrentDeferredRevenue,quarterlyCurrentDeferredTaxesLiabilities,quarterlyCurrentDebtAndCapitalLeaseObligation,quarterlyCurrentCapitalLeaseObligation,quarterlyCurrentDebt,quarterlyOtherCurrentBorrowings,quarterlyLineOfCredit,quarterlyCommercialPaper,quarterlyCurrentNotesPayable,quarterlyPensionandOtherPostRetirementBenefitPlansCurrent,quarterlyCurrentProvisions,quarterlyPayablesAndAccruedExpenses,quarterlyCurrentAccruedExpenses,quarterlyInterestPayable,quarterlyPayables,quarterlyOtherPayable,quarterlyDuetoRelatedPartiesCurrent,quarterlyDividendsPayable,quarterlyTotalTaxPayable,quarterlyIncomeTaxPayable,quarterlyAccountsPayable,quarterlyTotalAssets,quarterlyTotalNonCurrentAssets,quarterlyOtherNonCurrentAssets,quarterlyDefinedPensionBenefit,quarterlyNonCurrentPrepaidAssets,quarterlyNonCurrentDeferredAssets,quarterlyNonCurrentDeferredTaxesAssets,quarterlyDuefromRelatedPartiesNonCurrent,quarterlyNonCurrentNoteReceivables,quarterlyNonCurrentAccountsReceivable,quarterlyFinancialAssets,quarterlyInvestmentsAndAdvances,quarterlyOtherInvestments,quarterlyInvestmentinFinancialAssets,quarterlyHeldToMaturitySecurities,quarterlyAvailableForSaleSecurities,quarterlyFinancialAssetsDesignatedasFairValueThroughProfitorLossTotal,quarterlyTradingSecurities,quarterlyLongTermEquityInvestment,quarterlyInvestmentsinJointVenturesatCost,quarterlyInvestmentsInOtherVenturesUnderEquityMethod,quarterlyInvestmentsinAssociatesatCost,quarterlyInvestmentsinSubsidiariesatCost,quarterlyInvestmentProperties,quarterlyGoodwillAndOtherIntangibleAssets,quarterlyOtherIntangibleAssets,quarterlyGoodwill,quarterlyNetPPE,quarterlyAccumulatedDepreciation,quarterlyGrossPPE,quarterlyLeases,quarterlyConstructionInProgress,quarterlyOtherProperties,quarterlyMachineryFurnitureEquipment,quarterlyBuildingsAndImprovements,quarterlyLandAndImprovements,quarterlyProperties,quarterlyCurrentAssets,quarterlyOtherCurrentAssets,quarterlyHedgingAssetsCurrent,quarterlyAssetsHeldForSaleCurrent,quarterlyCurrentDeferredAssets,quarterlyCurrentDeferredTaxesAssets,quarterlyRestrictedCash,quarterlyPrepaidAssets,quarterlyInventory,quarterlyInventoriesAdjustmentsAllowances,quarterlyOtherInventories,quarterlyFinishedGoods,quarterlyWorkInProcess,quarterlyRawMaterials,quarterlyReceivables,quarterlyReceivablesAdjustmentsAllowances,quarterlyOtherReceivables,quarterlyDuefromRelatedPartiesCurrent,quarterlyTaxesReceivable,quarterlyAccruedInterestReceivable,quarterlyNotesReceivable,quarterlyLoansReceivable,quarterlyAccountsReceivable,quarterlyAllowanceForDoubtfulAccountsReceivable,quarterlyGrossAccountsReceivable,quarterlyCashCashEquivalentsAndShortTermInvestments,quarterlyOtherShortTermInvestments,quarterlyCashAndCashEquivalents,quarterlyCashEquivalents,quarterlyCashFinancial,quarterlyCashCashEquivalentsAndFederalFundsSold&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:41,797 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:41,798 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:41,798 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:41,860 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:41,862 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:41,862 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:41,862 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:41,862 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/MSFT?symbol=MSFT&type=annualTreasurySharesNumber,annualPreferredSharesNumber,annualOrdinarySharesNumber,annualShareIss...
2025-04-19 14:31:41,862 - DEBUG - [_make_request] params=None
2025-04-19 14:31:41,862 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:41,862 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:41,862 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:41,862 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:41,862 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:41,862 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:41,863 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:42,108 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/MSFT?symbol=MSFT&type=annualTreasurySharesNumber,annualPreferredSharesNumber,annualOrdinarySharesNumber,annualShareIssued,annualNetDebt,annualTotalDebt,annualTangibleBookValue,annualInvestedCapital,annualWorkingCapital,annualNetTangibleAssets,annualCapitalLeaseObligations,annualCommonStockEquity,annualPreferredStockEquity,annualTotalCapitalization,annualTotalEquityGrossMinorityInterest,annualMinorityInterest,annualStockholdersEquity,annualOtherEquityInterest,annualGainsLossesNotAffectingRetainedEarnings,annualOtherEquityAdjustments,annualFixedAssetsRevaluationReserve,annualForeignCurrencyTranslationAdjustments,annualMinimumPensionLiabilities,annualUnrealizedGainLoss,annualTreasuryStock,annualRetainedEarnings,annualAdditionalPaidInCapital,annualCapitalStock,annualOtherCapitalStock,annualCommonStock,annualPreferredStock,annualTotalPartnershipCapital,annualGeneralPartnershipCapital,annualLimitedPartnershipCapital,annualTotalLiabilitiesNetMinorityInterest,annualTotalNonCurrentLiabilitiesNetMinorityInterest,annualOtherNonCurrentLiabilities,annualLiabilitiesHeldforSaleNonCurrent,annualRestrictedCommonStock,annualPreferredSecuritiesOutsideStockEquity,annualDerivativeProductLiabilities,annualEmployeeBenefits,annualNonCurrentPensionAndOtherPostretirementBenefitPlans,annualNonCurrentAccruedExpenses,annualDuetoRelatedPartiesNonCurrent,annualTradeandOtherPayablesNonCurrent,annualNonCurrentDeferredLiabilities,annualNonCurrentDeferredRevenue,annualNonCurrentDeferredTaxesLiabilities,annualLongTermDebtAndCapitalLeaseObligation,annualLongTermCapitalLeaseObligation,annualLongTermDebt,annualLongTermProvisions,annualCurrentLiabilities,annualOtherCurrentLiabilities,annualCurrentDeferredLiabilities,annualCurrentDeferredRevenue,annualCurrentDeferredTaxesLiabilities,annualCurrentDebtAndCapitalLeaseObligation,annualCurrentCapitalLeaseObligation,annualCurrentDebt,annualOtherCurrentBorrowings,annualLineOfCredit,annualCommercialPaper,annualCurrentNotesPayable,annualPensionandOtherPostRetirementBenefitPlansCurrent,annualCurrentProvisions,annualPayablesAndAccruedExpenses,annualCurrentAccruedExpenses,annualInterestPayable,annualPayables,annualOtherPayable,annualDuetoRelatedPartiesCurrent,annualDividendsPayable,annualTotalTaxPayable,annualIncomeTaxPayable,annualAccountsPayable,annualTotalAssets,annualTotalNonCurrentAssets,annualOtherNonCurrentAssets,annualDefinedPensionBenefit,annualNonCurrentPrepaidAssets,annualNonCurrentDeferredAssets,annualNonCurrentDeferredTaxesAssets,annualDuefromRelatedPartiesNonCurrent,annualNonCurrentNoteReceivables,annualNonCurrentAccountsReceivable,annualFinancialAssets,annualInvestmentsAndAdvances,annualOtherInvestments,annualInvestmentinFinancialAssets,annualHeldToMaturitySecurities,annualAvailableForSaleSecurities,annualFinancialAssetsDesignatedasFairValueThroughProfitorLossTotal,annualTradingSecurities,annualLongTermEquityInvestment,annualInvestmentsinJointVenturesatCost,annualInvestmentsInOtherVenturesUnderEquityMethod,annualInvestmentsinAssociatesatCost,annualInvestmentsinSubsidiariesatCost,annualInvestmentProperties,annualGoodwillAndOtherIntangibleAssets,annualOtherIntangibleAssets,annualGoodwill,annualNetPPE,annualAccumulatedDepreciation,annualGrossPPE,annualLeases,annualConstructionInProgress,annualOtherProperties,annualMachineryFurnitureEquipment,annualBuildingsAndImprovements,annualLandAndImprovements,annualProperties,annualCurrentAssets,annualOtherCurrentAssets,annualHedgingAssetsCurrent,annualAssetsHeldForSaleCurrent,annualCurrentDeferredAssets,annualCurrentDeferredTaxesAssets,annualRestrictedCash,annualPrepaidAssets,annualInventory,annualInventoriesAdjustmentsAllowances,annualOtherInventories,annualFinishedGoods,annualWorkInProcess,annualRawMaterials,annualReceivables,annualReceivablesAdjustmentsAllowances,annualOtherReceivables,annualDuefromRelatedPartiesCurrent,annualTaxesReceivable,annualAccruedInterestReceivable,annualNotesReceivable,annualLoansReceivable,annualAccountsReceivable,annualAllowanceForDoubtfulAccountsReceivable,annualGrossAccountsReceivable,annualCashCashEquivalentsAndShortTermInvestments,annualOtherShortTermInvestments,annualCashAndCashEquivalents,annualCashEquivalents,annualCashFinancial,annualCashCashEquivalentsAndFederalFundsSold&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:42,111 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:42,111 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:42,111 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:42,158 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:42,160 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:42,160 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:42,160 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:42,160 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/MSFT?symbol=MSFT&type=quarterlyForeignSales,quarterlyDomesticSales,quarterlyAdjustedGeographySegmentData,quarterlyFree...
2025-04-19 14:31:42,160 - DEBUG - [_make_request] params=None
2025-04-19 14:31:42,160 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:42,160 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:42,160 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:42,160 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:42,160 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:42,160 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:42,161 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:42,454 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/MSFT?symbol=MSFT&type=quarterlyForeignSales,quarterlyDomesticSales,quarterlyAdjustedGeographySegmentData,quarterlyFreeCashFlow,quarterlyRepurchaseOfCapitalStock,quarterlyRepaymentOfDebt,quarterlyIssuanceOfDebt,quarterlyIssuanceOfCapitalStock,quarterlyCapitalExpenditure,quarterlyInterestPaidSupplementalData,quarterlyIncomeTaxPaidSupplementalData,quarterlyEndCashPosition,quarterlyOtherCashAdjustmentOutsideChangeinCash,quarterlyBeginningCashPosition,quarterlyEffectOfExchangeRateChanges,quarterlyChangesInCash,quarterlyOtherCashAdjustmentInsideChangeinCash,quarterlyCashFlowFromDiscontinuedOperation,quarterlyFinancingCashFlow,quarterlyCashFromDiscontinuedFinancingActivities,quarterlyCashFlowFromContinuingFinancingActivities,quarterlyNetOtherFinancingCharges,quarterlyInterestPaidCFF,quarterlyProceedsFromStockOptionExercised,quarterlyCashDividendsPaid,quarterlyPreferredStockDividendPaid,quarterlyCommonStockDividendPaid,quarterlyNetPreferredStockIssuance,quarterlyPreferredStockPayments,quarterlyPreferredStockIssuance,quarterlyNetCommonStockIssuance,quarterlyCommonStockPayments,quarterlyCommonStockIssuance,quarterlyNetIssuancePaymentsOfDebt,quarterlyNetShortTermDebtIssuance,quarterlyShortTermDebtPayments,quarterlyShortTermDebtIssuance,quarterlyNetLongTermDebtIssuance,quarterlyLongTermDebtPayments,quarterlyLongTermDebtIssuance,quarterlyInvestingCashFlow,quarterlyCashFromDiscontinuedInvestingActivities,quarterlyCashFlowFromContinuingInvestingActivities,quarterlyNetOtherInvestingChanges,quarterlyInterestReceivedCFI,quarterlyDividendsReceivedCFI,quarterlyNetInvestmentPurchaseAndSale,quarterlySaleOfInvestment,quarterlyPurchaseOfInvestment,quarterlyNetInvestmentPropertiesPurchaseAndSale,quarterlySaleOfInvestmentProperties,quarterlyPurchaseOfInvestmentProperties,quarterlyNetBusinessPurchaseAndSale,quarterlySaleOfBusiness,quarterlyPurchaseOfBusiness,quarterlyNetIntangiblesPurchaseAndSale,quarterlySaleOfIntangibles,quarterlyPurchaseOfIntangibles,quarterlyNetPPEPurchaseAndSale,quarterlySaleOfPPE,quarterlyPurchaseOfPPE,quarterlyCapitalExpenditureReported,quarterlyOperatingCashFlow,quarterlyCashFromDiscontinuedOperatingActivities,quarterlyCashFlowFromContinuingOperatingActivities,quarterlyTaxesRefundPaid,quarterlyInterestReceivedCFO,quarterlyInterestPaidCFO,quarterlyDividendReceivedCFO,quarterlyDividendPaidCFO,quarterlyChangeInWorkingCapital,quarterlyChangeInOtherWorkingCapital,quarterlyChangeInOtherCurrentLiabilities,quarterlyChangeInOtherCurrentAssets,quarterlyChangeInPayablesAndAccruedExpense,quarterlyChangeInAccruedExpense,quarterlyChangeInInterestPayable,quarterlyChangeInPayable,quarterlyChangeInDividendPayable,quarterlyChangeInAccountPayable,quarterlyChangeInTaxPayable,quarterlyChangeInIncomeTaxPayable,quarterlyChangeInPrepaidAssets,quarterlyChangeInInventory,quarterlyChangeInReceivables,quarterlyChangesInAccountReceivables,quarterlyOtherNonCashItems,quarterlyExcessTaxBenefitFromStockBasedCompensation,quarterlyStockBasedCompensation,quarterlyUnrealizedGainLossOnInvestmentSecurities,quarterlyProvisionandWriteOffofAssets,quarterlyAssetImpairmentCharge,quarterlyAmortizationOfSecurities,quarterlyDeferredTax,quarterlyDeferredIncomeTax,quarterlyDepreciationAmortizationDepletion,quarterlyDepletion,quarterlyDepreciationAndAmortization,quarterlyAmortizationCashFlow,quarterlyAmortizationOfIntangibles,quarterlyDepreciation,quarterlyOperatingGainsLosses,quarterlyPensionAndEmployeeBenefitExpense,quarterlyEarningsLossesFromEquityInvestments,quarterlyGainLossOnInvestmentSecurities,quarterlyNetForeignCurrencyExchangeGainLoss,quarterlyGainLossOnSaleOfPPE,quarterlyGainLossOnSaleOfBusiness,quarterlyNetIncomeFromContinuingOperations,quarterlyCashFlowsfromusedinOperatingActivitiesDirect,quarterlyTaxesRefundPaidDirect,quarterlyInterestReceivedDirect,quarterlyInterestPaidDirect,quarterlyDividendsReceivedDirect,quarterlyDividendsPaidDirect,quarterlyClassesofCashPayments,quarterlyOtherCashPaymentsfromOperatingActivities,quarterlyPaymentsonBehalfofEmployees,quarterlyPaymentstoSuppliersforGoodsandServices,quarterlyClassesofCashReceiptsfromOperatingActivities,quarterlyOtherCashReceiptsfromOperatingActivities,quarterlyReceiptsfromGovernmentGrants,quarterlyReceiptsfromCustomers&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:42,456 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:42,456 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:42,456 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:42,503 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:42,504 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:42,504 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:42,504 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:42,504 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/MSFT?symbol=MSFT&type=annualForeignSales,annualDomesticSales,annualAdjustedGeographySegmentData,annualFreeCashFlow,ann...
2025-04-19 14:31:42,504 - DEBUG - [_make_request] params=None
2025-04-19 14:31:42,505 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:42,505 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:42,505 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:42,505 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:42,505 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:42,505 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:42,505 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:42,749 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/MSFT?symbol=MSFT&type=annualForeignSales,annualDomesticSales,annualAdjustedGeographySegmentData,annualFreeCashFlow,annualRepurchaseOfCapitalStock,annualRepaymentOfDebt,annualIssuanceOfDebt,annualIssuanceOfCapitalStock,annualCapitalExpenditure,annualInterestPaidSupplementalData,annualIncomeTaxPaidSupplementalData,annualEndCashPosition,annualOtherCashAdjustmentOutsideChangeinCash,annualBeginningCashPosition,annualEffectOfExchangeRateChanges,annualChangesInCash,annualOtherCashAdjustmentInsideChangeinCash,annualCashFlowFromDiscontinuedOperation,annualFinancingCashFlow,annualCashFromDiscontinuedFinancingActivities,annualCashFlowFromContinuingFinancingActivities,annualNetOtherFinancingCharges,annualInterestPaidCFF,annualProceedsFromStockOptionExercised,annualCashDividendsPaid,annualPreferredStockDividendPaid,annualCommonStockDividendPaid,annualNetPreferredStockIssuance,annualPreferredStockPayments,annualPreferredStockIssuance,annualNetCommonStockIssuance,annualCommonStockPayments,annualCommonStockIssuance,annualNetIssuancePaymentsOfDebt,annualNetShortTermDebtIssuance,annualShortTermDebtPayments,annualShortTermDebtIssuance,annualNetLongTermDebtIssuance,annualLongTermDebtPayments,annualLongTermDebtIssuance,annualInvestingCashFlow,annualCashFromDiscontinuedInvestingActivities,annualCashFlowFromContinuingInvestingActivities,annualNetOtherInvestingChanges,annualInterestReceivedCFI,annualDividendsReceivedCFI,annualNetInvestmentPurchaseAndSale,annualSaleOfInvestment,annualPurchaseOfInvestment,annualNetInvestmentPropertiesPurchaseAndSale,annualSaleOfInvestmentProperties,annualPurchaseOfInvestmentProperties,annualNetBusinessPurchaseAndSale,annualSaleOfBusiness,annualPurchaseOfBusiness,annualNetIntangiblesPurchaseAndSale,annualSaleOfIntangibles,annualPurchaseOfIntangibles,annualNetPPEPurchaseAndSale,annualSaleOfPPE,annualPurchaseOfPPE,annualCapitalExpenditureReported,annualOperatingCashFlow,annualCashFromDiscontinuedOperatingActivities,annualCashFlowFromContinuingOperatingActivities,annualTaxesRefundPaid,annualInterestReceivedCFO,annualInterestPaidCFO,annualDividendReceivedCFO,annualDividendPaidCFO,annualChangeInWorkingCapital,annualChangeInOtherWorkingCapital,annualChangeInOtherCurrentLiabilities,annualChangeInOtherCurrentAssets,annualChangeInPayablesAndAccruedExpense,annualChangeInAccruedExpense,annualChangeInInterestPayable,annualChangeInPayable,annualChangeInDividendPayable,annualChangeInAccountPayable,annualChangeInTaxPayable,annualChangeInIncomeTaxPayable,annualChangeInPrepaidAssets,annualChangeInInventory,annualChangeInReceivables,annualChangesInAccountReceivables,annualOtherNonCashItems,annualExcessTaxBenefitFromStockBasedCompensation,annualStockBasedCompensation,annualUnrealizedGainLossOnInvestmentSecurities,annualProvisionandWriteOffofAssets,annualAssetImpairmentCharge,annualAmortizationOfSecurities,annualDeferredTax,annualDeferredIncomeTax,annualDepreciationAmortizationDepletion,annualDepletion,annualDepreciationAndAmortization,annualAmortizationCashFlow,annualAmortizationOfIntangibles,annualDepreciation,annualOperatingGainsLosses,annualPensionAndEmployeeBenefitExpense,annualEarningsLossesFromEquityInvestments,annualGainLossOnInvestmentSecurities,annualNetForeignCurrencyExchangeGainLoss,annualGainLossOnSaleOfPPE,annualGainLossOnSaleOfBusiness,annualNetIncomeFromContinuingOperations,annualCashFlowsfromusedinOperatingActivitiesDirect,annualTaxesRefundPaidDirect,annualInterestReceivedDirect,annualInterestPaidDirect,annualDividendsReceivedDirect,annualDividendsPaidDirect,annualClassesofCashPayments,annualOtherCashPaymentsfromOperatingActivities,annualPaymentsonBehalfofEmployees,annualPaymentstoSuppliersforGoodsandServices,annualClassesofCashReceiptsfromOperatingActivities,annualOtherCashReceiptsfromOperatingActivities,annualReceiptsfromGovernmentGrants,annualReceiptsfromCustomers&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:42,750 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:42,750 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:42,750 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:42,775 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:42,779 - DEBUG - [fetch_financial_statement] Raw annual financials data head for MSFT:
                                            2024-06-30      2023-06-30     2022-06-30        2021-06-30
Tax Effect Of Unusual Items                -99918000.0      -2850000.0     43754000.0  180160797.164637
Tax Rate For Calcs                               0.182            0.19          0.131          0.138266
Normalized EBITDA                       133558000000.0  105155000000.0  99905000000.0     83831000000.0
Total Unusual Items                       -549000000.0     -15000000.0    334000000.0      1303000000.0
Total Unusual Items Excluding Goodwill    -549000000.0     -15000000.0    334000000.0      1303000000.0
2025-04-19 14:31:42,780 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Tax Effect Of Unusual Items', 'Tax Rate For Calcs',
       'Normalized EBITDA', 'Total Unusual Items',
       'Total Unusual Items Excluding Goodwill',
       'Net Income From Continuing Operation Net Minority Interest',
       'Reconciled Depreciation', 'Reconciled Cost Of Revenue', 'EBITDA',
       'EBIT', 'Net Interest Income', 'Interest Expense', 'Interest Income',
       'Normalized Income',
       'Net Income From Continuing And Discontinued Operation',
       'Total Expenses', 'Total Operating Income As Reported',
       'Diluted Average Shares', 'Basic Average Shares', 'Diluted EPS',
       'Basic EPS', 'Diluted NI Availto Com Stockholders',
       'Net Income Common Stockholders', 'Net Income',
       'Net Income Including Noncontrolling Interests',
       'Net Income Continuous Operations', 'Tax Provision', 'Pretax Income',
       'Other Income Expense', 'Other Non Operating Income Expenses',
       'Special Income Charges', 'Write Off', 'Gain On Sale Of Security',
       'Net Non Operating Interest Income Expense',
       'Interest Expense Non Operating', 'Interest Income Non Operating',
       'Operating Income', 'Operating Expense', 'Research And Development',
       'Selling General And Administration', 'Selling And Marketing Expense',
       'General And Administrative Expense', 'Other Gand A', 'Gross Profit',
       'Cost Of Revenue', 'Total Revenue', 'Operating Revenue'],
      dtype='object')
2025-04-19 14:31:42,780 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-06-30', '2023-06-30', '2022-06-30', '2021-06-30'], dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:42,784 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 47 entries, Tax Effect Of Unusual Items to Operating Revenue
Data columns (total 4 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-06-30 00:00:00  47 non-null     object
 1   2023-06-30 00:00:00  47 non-null     object
 2   2022-06-30 00:00:00  47 non-null     object
 3   2021-06-30 00:00:00  47 non-null     object
dtypes: object(4)
memory usage: 1.8+ KB

2025-04-19 14:31:42,811 - DEBUG - [fetch_financial_statement] Fetching quarterly financials for MSFT
2025-04-19 14:31:42,823 - DEBUG - [fetch_financial_statement] Raw quarterly financials data head for MSFT:
                                           2024-12-31     2024-09-30       2024-06-30     2024-03-31     2023-12-31
Tax Effect Of Unusual Items              -203220000.0     57190000.0 -16263853.211009    -33660000.0    -29160000.0
Tax Rate For Calcs                               0.18           0.19         0.191339           0.18           0.18
Normalized EBITDA                       37915000000.0  37933000000.0    34416000000.0  33741000000.0  33556000000.0
Total Unusual Items                     -1129000000.0    301000000.0      -85000000.0   -187000000.0   -162000000.0
Total Unusual Items Excluding Goodwill  -1129000000.0    301000000.0      -85000000.0   -187000000.0   -162000000.0
2025-04-19 14:31:42,823 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Tax Effect Of Unusual Items', 'Tax Rate For Calcs',
       'Normalized EBITDA', 'Total Unusual Items',
       'Total Unusual Items Excluding Goodwill',
       'Net Income From Continuing Operation Net Minority Interest',
       'Reconciled Depreciation', 'Reconciled Cost Of Revenue', 'EBITDA',
       'EBIT', 'Net Interest Income', 'Interest Expense', 'Interest Income',
       'Normalized Income',
       'Net Income From Continuing And Discontinued Operation',
       'Total Expenses', 'Total Operating Income As Reported',
       'Diluted Average Shares', 'Basic Average Shares', 'Diluted EPS',
       'Basic EPS', 'Diluted NI Availto Com Stockholders',
       'Net Income Common Stockholders', 'Net Income',
       'Net Income Including Noncontrolling Interests',
       'Net Income Continuous Operations', 'Tax Provision', 'Pretax Income',
       'Other Income Expense', 'Other Non Operating Income Expenses',
       'Special Income Charges', 'Write Off', 'Gain On Sale Of Security',
       'Net Non Operating Interest Income Expense',
       'Interest Expense Non Operating', 'Interest Income Non Operating',
       'Operating Income', 'Operating Expense', 'Research And Development',
       'Selling General And Administration', 'Selling And Marketing Expense',
       'General And Administrative Expense', 'Other Gand A', 'Gross Profit',
       'Cost Of Revenue', 'Total Revenue', 'Operating Revenue'],
      dtype='object')
2025-04-19 14:31:42,824 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-12-31', '2024-09-30', '2024-06-30', '2024-03-31',
               '2023-12-31'],
              dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:42,827 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 47 entries, Tax Effect Of Unusual Items to Operating Revenue
Data columns (total 5 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-12-31 00:00:00  47 non-null     object
 1   2024-09-30 00:00:00  47 non-null     object
 2   2024-06-30 00:00:00  47 non-null     object
 3   2024-03-31 00:00:00  47 non-null     object
 4   2023-12-31 00:00:00  47 non-null     object
dtypes: object(5)
memory usage: 2.2+ KB

2025-04-19 14:31:42,853 - DEBUG - [fetch_financial_statement] Fetching annual balance_sheet for MSFT
2025-04-19 14:31:42,861 - DEBUG - [fetch_financial_statement] Raw annual balance_sheet data head for MSFT:
                            2024-06-30      2023-06-30     2022-06-30     2021-06-30
Ordinary Shares Number    7434138859.0    7432000000.0   7464000000.0   7519000000.0
Share Issued              7434138859.0    7432000000.0   7464000000.0   7519000000.0
Net Debt                 33315000000.0   12533000000.0  35850000000.0  43922000000.0
Total Debt               67127000000.0   59965000000.0  61270000000.0  67775000000.0
Tangible Book Value     121660000000.0  128971000000.0  87720000000.0  84477000000.0
2025-04-19 14:31:42,861 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Ordinary Shares Number', 'Share Issued', 'Net Debt', 'Total Debt',
       'Tangible Book Value', 'Invested Capital', 'Working Capital',
       'Net Tangible Assets', 'Capital Lease Obligations',
       'Common Stock Equity', 'Total Capitalization',
       'Total Equity Gross Minority Interest', 'Stockholders Equity',
       'Gains Losses Not Affecting Retained Earnings',
       'Other Equity Adjustments', 'Retained Earnings', 'Capital Stock',
       'Common Stock', 'Total Liabilities Net Minority Interest',
       'Total Non Current Liabilities Net Minority Interest',
       'Other Non Current Liabilities', 'Tradeand Other Payables Non Current',
       'Non Current Deferred Liabilities', 'Non Current Deferred Revenue',
       'Non Current Deferred Taxes Liabilities',
       'Long Term Debt And Capital Lease Obligation',
       'Long Term Capital Lease Obligation', 'Long Term Debt',
       'Current Liabilities', 'Other Current Liabilities',
       'Current Deferred Liabilities', 'Current Deferred Revenue',
       'Current Debt And Capital Lease Obligation', 'Current Debt',
       'Other Current Borrowings', 'Commercial Paper',
       'Pensionand Other Post Retirement Benefit Plans Current',
       'Payables And Accrued Expenses', 'Payables', 'Total Tax Payable',
       'Income Tax Payable', 'Accounts Payable', 'Total Assets',
       'Total Non Current Assets', 'Other Non Current Assets',
       'Financial Assets', 'Investments And Advances',
       'Investmentin Financial Assets', 'Available For Sale Securities',
       'Long Term Equity Investment', 'Goodwill And Other Intangible Assets',
       'Other Intangible Assets', 'Goodwill', 'Net PPE',
       'Accumulated Depreciation', 'Gross PPE', 'Leases', 'Other Properties',
       'Machinery Furniture Equipment', 'Buildings And Improvements',
       'Land And Improvements', 'Properties', 'Current Assets',
       'Other Current Assets', 'Hedging Assets Current', 'Inventory',
       'Finished Goods', 'Work In Process', 'Raw Materials', 'Receivables',
       'Accounts Receivable', 'Allowance For Doubtful Accounts Receivable',
       'Gross Accounts Receivable',
       'Cash Cash Equivalents And Short Term Investments',
       'Other Short Term Investments', 'Cash And Cash Equivalents',
       'Cash Equivalents', 'Cash Financial'],
      dtype='object')
2025-04-19 14:31:42,861 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-06-30', '2023-06-30', '2022-06-30', '2021-06-30'], dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:42,864 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 78 entries, Ordinary Shares Number to Cash Financial
Data columns (total 4 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-06-30 00:00:00  78 non-null     object
 1   2023-06-30 00:00:00  77 non-null     object
 2   2022-06-30 00:00:00  75 non-null     object
 3   2021-06-30 00:00:00  75 non-null     object
dtypes: object(4)
memory usage: 3.0+ KB

2025-04-19 14:31:42,905 - DEBUG - [fetch_financial_statement] Fetching quarterly balance_sheet for MSFT
2025-04-19 14:31:42,915 - DEBUG - [fetch_financial_statement] Raw quarterly balance_sheet data head for MSFT:
                            2024-12-31      2024-09-30      2024-06-30      2024-03-31     2023-12-31 2023-09-30
Ordinary Shares Number    7434880776.0    7436000000.0    7434138859.0    7432305794.0   7431612107.0        NaN
Share Issued              7434880776.0    7436000000.0    7434138859.0    7432305794.0   7431612107.0        NaN
Net Debt                 27488000000.0   24277000000.0   33315000000.0   45808000000.0  56914000000.0        NaN
Total Debt               62224000000.0   61478000000.0   67127000000.0   79911000000.0  88374000000.0        NaN
Tangible Book Value     158119000000.0  141598000000.0  121660000000.0  105161000000.0  89441000000.0        NaN
2025-04-19 14:31:42,915 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Ordinary Shares Number', 'Share Issued', 'Net Debt', 'Total Debt',
       'Tangible Book Value', 'Invested Capital', 'Working Capital',
       'Net Tangible Assets', 'Capital Lease Obligations',
       'Common Stock Equity', 'Total Capitalization',
       'Total Equity Gross Minority Interest', 'Stockholders Equity',
       'Gains Losses Not Affecting Retained Earnings',
       'Other Equity Adjustments', 'Retained Earnings', 'Capital Stock',
       'Common Stock', 'Total Liabilities Net Minority Interest',
       'Total Non Current Liabilities Net Minority Interest',
       'Other Non Current Liabilities', 'Tradeand Other Payables Non Current',
       'Non Current Deferred Liabilities', 'Non Current Deferred Revenue',
       'Non Current Deferred Taxes Liabilities',
       'Long Term Debt And Capital Lease Obligation',
       'Long Term Capital Lease Obligation', 'Long Term Debt',
       'Current Liabilities', 'Other Current Liabilities',
       'Current Deferred Liabilities', 'Current Deferred Revenue',
       'Current Debt And Capital Lease Obligation', 'Current Debt',
       'Other Current Borrowings', 'Commercial Paper',
       'Pensionand Other Post Retirement Benefit Plans Current',
       'Payables And Accrued Expenses', 'Payables', 'Total Tax Payable',
       'Income Tax Payable', 'Accounts Payable', 'Total Assets',
       'Total Non Current Assets', 'Other Non Current Assets',
       'Financial Assets', 'Investments And Advances',
       'Investmentin Financial Assets', 'Available For Sale Securities',
       'Long Term Equity Investment', 'Goodwill And Other Intangible Assets',
       'Other Intangible Assets', 'Goodwill', 'Net PPE',
       'Accumulated Depreciation', 'Gross PPE', 'Leases', 'Other Properties',
       'Machinery Furniture Equipment', 'Buildings And Improvements',
       'Land And Improvements', 'Properties', 'Current Assets',
       'Other Current Assets', 'Hedging Assets Current', 'Inventory',
       'Finished Goods', 'Work In Process', 'Raw Materials', 'Receivables',
       'Accounts Receivable', 'Allowance For Doubtful Accounts Receivable',
       'Gross Accounts Receivable',
       'Cash Cash Equivalents And Short Term Investments',
       'Other Short Term Investments', 'Cash And Cash Equivalents',
       'Cash Equivalents', 'Cash Financial'],
      dtype='object')
2025-04-19 14:31:42,916 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-12-31', '2024-09-30', '2024-06-30', '2024-03-31',
               '2023-12-31', '2023-09-30'],
              dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:42,918 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 78 entries, Ordinary Shares Number to Cash Financial
Data columns (total 6 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-12-31 00:00:00  71 non-null     object
 1   2024-09-30 00:00:00  73 non-null     object
 2   2024-06-30 00:00:00  78 non-null     object
 3   2024-03-31 00:00:00  73 non-null     object
 4   2023-12-31 00:00:00  72 non-null     object
 5   2023-09-30 00:00:00  2 non-null      object
dtypes: object(6)
memory usage: 4.3+ KB

2025-04-19 14:31:42,958 - DEBUG - [fetch_financial_statement] Fetching annual cashflow for MSFT
2025-04-19 14:31:42,967 - DEBUG - [fetch_financial_statement] Raw annual cashflow data head for MSFT:
                                2024-06-30     2023-06-30     2022-06-30     2021-06-30 2020-06-30
Free Cash Flow               74071000000.0  59475000000.0  65149000000.0  56118000000.0        NaN
Repurchase Of Capital Stock -17254000000.0 -22245000000.0 -32696000000.0 -27385000000.0        NaN
Repayment Of Debt           -29070000000.0  -2750000000.0  -9023000000.0  -3750000000.0        NaN
Issuance Of Debt             29645000000.0            0.0            0.0            NaN        0.0
Issuance Of Capital Stock     2002000000.0   1866000000.0   1841000000.0   1693000000.0        NaN
2025-04-19 14:31:42,967 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Free Cash Flow', 'Repurchase Of Capital Stock', 'Repayment Of Debt',
       'Issuance Of Debt', 'Issuance Of Capital Stock', 'Capital Expenditure',
       'End Cash Position', 'Beginning Cash Position',
       'Effect Of Exchange Rate Changes', 'Changes In Cash',
       'Financing Cash Flow', 'Cash Flow From Continuing Financing Activities',
       'Net Other Financing Charges', 'Cash Dividends Paid',
       'Common Stock Dividend Paid', 'Net Common Stock Issuance',
       'Common Stock Payments', 'Common Stock Issuance',
       'Net Issuance Payments Of Debt', 'Net Short Term Debt Issuance',
       'Short Term Debt Payments', 'Short Term Debt Issuance',
       'Net Long Term Debt Issuance', 'Long Term Debt Payments',
       'Long Term Debt Issuance', 'Investing Cash Flow',
       'Cash Flow From Continuing Investing Activities',
       'Net Other Investing Changes', 'Net Investment Purchase And Sale',
       'Sale Of Investment', 'Purchase Of Investment',
       'Net Business Purchase And Sale', 'Purchase Of Business',
       'Net PPE Purchase And Sale', 'Purchase Of PPE', 'Operating Cash Flow',
       'Cash Flow From Continuing Operating Activities',
       'Change In Working Capital', 'Change In Other Working Capital',
       'Change In Other Current Liabilities', 'Change In Other Current Assets',
       'Change In Payables And Accrued Expense', 'Change In Payable',
       'Change In Account Payable', 'Change In Tax Payable',
       'Change In Income Tax Payable', 'Change In Inventory',
       'Change In Receivables', 'Changes In Account Receivables',
       'Stock Based Compensation',
       'Unrealized Gain Loss On Investment Securities',
       'Asset Impairment Charge', 'Deferred Tax', 'Deferred Income Tax',
       'Depreciation Amortization Depletion', 'Depreciation And Amortization',
       'Depreciation', 'Operating Gains Losses',
       'Gain Loss On Investment Securities',
       'Net Income From Continuing Operations'],
      dtype='object')
2025-04-19 14:31:42,968 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-06-30', '2023-06-30', '2022-06-30', '2021-06-30',
               '2020-06-30'],
              dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:42,970 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 60 entries, Free Cash Flow to Net Income From Continuing Operations
Data columns (total 5 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-06-30 00:00:00  59 non-null     object
 1   2023-06-30 00:00:00  59 non-null     object
 2   2022-06-30 00:00:00  59 non-null     object
 3   2021-06-30 00:00:00  55 non-null     object
 4   2020-06-30 00:00:00  4 non-null      object
dtypes: object(5)
memory usage: 2.8+ KB

2025-04-19 14:31:43,002 - DEBUG - [fetch_financial_statement] Fetching quarterly cashflow for MSFT
2025-04-19 14:31:43,011 - DEBUG - [fetch_financial_statement] Raw quarterly cashflow data head for MSFT:
                               2024-12-31     2024-09-30     2024-06-30     2024-03-31     2023-12-31 2023-09-30
Free Cash Flow               6487000000.0  19257000000.0  23322000000.0  20965000000.0   9118000000.0        NaN
Repurchase Of Capital Stock -4986000000.0  -4107000000.0  -4210000000.0  -4213000000.0  -4000000000.0        NaN
Repayment Of Debt                     0.0   -966000000.0 -13065000000.0 -11589000000.0  -2916000000.0        NaN
Issuance Of Debt                      0.0            0.0   5447000000.0   6352000000.0  10773000000.0        NaN
Issuance Of Capital Stock     256000000.0    706000000.0    534000000.0    522000000.0    261000000.0        NaN
2025-04-19 14:31:43,012 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Free Cash Flow', 'Repurchase Of Capital Stock', 'Repayment Of Debt',
       'Issuance Of Debt', 'Issuance Of Capital Stock', 'Capital Expenditure',
       'End Cash Position', 'Beginning Cash Position',
       'Effect Of Exchange Rate Changes', 'Changes In Cash',
       'Financing Cash Flow', 'Cash Flow From Continuing Financing Activities',
       'Net Other Financing Charges', 'Cash Dividends Paid',
       'Common Stock Dividend Paid', 'Net Common Stock Issuance',
       'Common Stock Payments', 'Common Stock Issuance',
       'Net Issuance Payments Of Debt', 'Net Short Term Debt Issuance',
       'Short Term Debt Issuance', 'Net Long Term Debt Issuance',
       'Long Term Debt Payments', 'Long Term Debt Issuance',
       'Investing Cash Flow', 'Cash Flow From Continuing Investing Activities',
       'Net Other Investing Changes', 'Net Investment Purchase And Sale',
       'Sale Of Investment', 'Purchase Of Investment',
       'Net Business Purchase And Sale', 'Purchase Of Business',
       'Net PPE Purchase And Sale', 'Purchase Of PPE', 'Operating Cash Flow',
       'Cash Flow From Continuing Operating Activities',
       'Change In Working Capital', 'Change In Other Working Capital',
       'Change In Other Current Liabilities', 'Change In Other Current Assets',
       'Change In Payables And Accrued Expense', 'Change In Payable',
       'Change In Account Payable', 'Change In Tax Payable',
       'Change In Income Tax Payable', 'Change In Inventory',
       'Change In Receivables', 'Changes In Account Receivables',
       'Stock Based Compensation',
       'Unrealized Gain Loss On Investment Securities',
       'Asset Impairment Charge', 'Deferred Tax', 'Deferred Income Tax',
       'Depreciation Amortization Depletion', 'Depreciation And Amortization',
       'Depreciation', 'Operating Gains Losses',
       'Gain Loss On Investment Securities',
       'Net Income From Continuing Operations'],
      dtype='object')
2025-04-19 14:31:43,012 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-12-31', '2024-09-30', '2024-06-30', '2024-03-31',
               '2023-12-31', '2023-09-30'],
              dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:43,015 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 59 entries, Free Cash Flow to Net Income From Continuing Operations
Data columns (total 6 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-12-31 00:00:00  55 non-null     object
 1   2024-09-30 00:00:00  58 non-null     object
 2   2024-06-30 00:00:00  58 non-null     object
 3   2024-03-31 00:00:00  58 non-null     object
 4   2023-12-31 00:00:00  58 non-null     object
 5   2023-09-30 00:00:00  4 non-null      object
dtypes: object(6)
memory usage: 3.2+ KB

2025-04-19 14:31:43,047 - DEBUG - [fetch_stock_actions] Fetching actions for MSFT
2025-04-19 14:31:43,047 - DEBUG - [execute_sql] ('SELECT "t1"."key", "t1"."value" FROM "_kv" AS "t1" WHERE ("t1"."key" = ?) LIMIT ? OFFSET ?', ['MSFT', 1, 0])
2025-04-19 14:31:43,048 - DEBUG - [wrapper] Entering history()
2025-04-19 14:31:43,048 - DEBUG - [history] MSFT: Yahoo GET parameters: {'period1': '1926-05-14 15:31:43-04:00', 'period2': '2025-04-19 15:31:43-04:00', 'interval': '1d', 'includePrePost': True, 'events': 'div,splits,capitalGains'}
2025-04-19 14:31:43,048 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:43,048 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:43,048 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/v8/finance/chart/MSFT
2025-04-19 14:31:43,048 - DEBUG - [_make_request] params={'period1': -1376972897, 'period2': 1745091103, 'interval': '1d', 'includePrePost': True, 'events': 'div,splits,capitalGains'}
2025-04-19 14:31:43,048 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:43,048 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:43,048 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:43,048 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:43,048 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:43,048 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:43,048 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:43,240 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /v8/finance/chart/MSFT?period1=-1376972897&period2=1745091103&interval=1d&includePrePost=True&events=div%2Csplits%2CcapitalGains&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:43,560 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:43,560 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:43,560 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:43,597 - DEBUG - [history] MSFT: yfinance received OHLC data: 1986-03-13 14:30:00 -> 2025-04-17 13:30:00
2025-04-19 14:31:43,601 - DEBUG - [history] MSFT: OHLC after cleaning: 1986-03-13 09:30:00-05:00 -> 2025-04-17 09:30:00-04:00
2025-04-19 14:31:43,639 - DEBUG - [history] MSFT: OHLC after combining events: 1986-03-13 00:00:00-05:00 -> 2025-04-17 00:00:00-04:00
2025-04-19 14:31:43,644 - DEBUG - [history] MSFT: yfinance returning OHLC: 1986-03-13 00:00:00-05:00 -> 2025-04-17 00:00:00-04:00
2025-04-19 14:31:43,644 - DEBUG - [wrapper] Exiting history()
2025-04-19 14:31:43,650 - INFO - [load_data_to_table] Loading 1 rows company_profile Ticker MSFT (Mode initial_load)
2025-04-19 14:31:43,657 - DEBUG - [load_data_to_table] Loaded company_profile for MSFT.
2025-04-19 14:31:43,657 - INFO - [load_data_to_table] Loading 1 rows company_key_metrics Ticker MSFT (Mode initial_load)
2025-04-19 14:31:43,664 - DEBUG - [load_data_to_table] Loaded company_key_metrics for MSFT.
2025-04-19 14:31:43,664 - INFO - [load_data_to_table] Loading 4 rows financials_income_annual Ticker MSFT (Mode initial_load)
2025-04-19 14:31:43,665 - WARNING - [load_data_to_table] Cols missing DF->financials_income_annual (MSFT): ['TotalRevenue', 'CostOfRevenue', 'GrossProfit', 'OperatingIncome', 'NetIncome', 'NetIncomeFromContinuingOperations', 'NetIncomeApplicableToCommonShares', 'InterestExpense', 'IncomeBeforeTax', 'IncomeTaxExpense', 'ResearchDevelopment', 'SellingGeneralAdministrative', 'BasicEPS', 'DilutedEPS']. NULL.
2025-04-19 14:31:43,665 - ERROR - [load_data_to_table] Err prep DF financials_income_annual (MSFT): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:43,666 - INFO - [load_data_to_table] Loading 5 rows financials_income_quarterly Ticker MSFT (Mode initial_load)
2025-04-19 14:31:43,667 - WARNING - [load_data_to_table] Cols missing DF->financials_income_quarterly (MSFT): ['TotalRevenue', 'CostOfRevenue', 'GrossProfit', 'OperatingIncome', 'NetIncome', 'NetIncomeFromContinuingOperations', 'NetIncomeApplicableToCommonShares', 'InterestExpense', 'IncomeBeforeTax', 'IncomeTaxExpense', 'ResearchDevelopment', 'SellingGeneralAdministrative', 'BasicEPS', 'DilutedEPS']. NULL.
2025-04-19 14:31:43,667 - ERROR - [load_data_to_table] Err prep DF financials_income_quarterly (MSFT): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:43,667 - INFO - [load_data_to_table] Loading 4 rows financials_balance_annual Ticker MSFT (Mode initial_load)
2025-04-19 14:31:43,668 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_annual (MSFT): ['TotalAssets', 'CurrentAssets', 'TotalLiabilities', 'CurrentLiabilities', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'CommonStockEquity', 'CashAndCashEquivalents', 'AccountsReceivable', 'PropertyPlantEquipmentNet', 'AccountsPayable', 'ShortTermDebt', 'LongTermDebt', 'RetainedEarnings']. NULL.
2025-04-19 14:31:43,668 - ERROR - [load_data_to_table] Err prep DF financials_balance_annual (MSFT): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:43,668 - INFO - [load_data_to_table] Loading 6 rows financials_balance_quarterly Ticker MSFT (Mode initial_load)
2025-04-19 14:31:43,669 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_quarterly (MSFT): ['TotalAssets', 'CurrentAssets', 'TotalLiabilities', 'CurrentLiabilities', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'CommonStockEquity', 'CashAndCashEquivalents', 'AccountsReceivable', 'PropertyPlantEquipmentNet', 'AccountsPayable', 'ShortTermDebt', 'LongTermDebt', 'RetainedEarnings']. NULL.
2025-04-19 14:31:43,669 - ERROR - [load_data_to_table] Err prep DF financials_balance_quarterly (MSFT): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:43,670 - INFO - [load_data_to_table] Loading 5 rows financials_cashflow_annual Ticker MSFT (Mode initial_load)
2025-04-19 14:31:43,670 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_annual (MSFT): ['OperatingCashFlow', 'InvestingCashFlow', 'FinancingCashFlow', 'EndCashPosition', 'FreeCashFlow', 'CapitalExpenditure', 'IssuanceOfDebt', 'RepaymentOfDebt', 'RepurchaseOfCapitalStock', 'DividendPaid']. NULL.
2025-04-19 14:31:43,670 - ERROR - [load_data_to_table] Err prep DF financials_cashflow_annual (MSFT): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:43,671 - INFO - [load_data_to_table] Loading 6 rows financials_cashflow_quarterly Ticker MSFT (Mode initial_load)
2025-04-19 14:31:43,671 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_quarterly (MSFT): ['OperatingCashFlow', 'InvestingCashFlow', 'FinancingCashFlow', 'EndCashPosition', 'FreeCashFlow', 'CapitalExpenditure', 'IssuanceOfDebt', 'RepaymentOfDebt', 'RepurchaseOfCapitalStock', 'DividendPaid']. NULL.
2025-04-19 14:31:43,672 - ERROR - [load_data_to_table] Err prep DF financials_cashflow_quarterly (MSFT): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:43,672 - INFO - [load_data_to_table] Loading 94 rows stock_actions Ticker MSFT (Mode initial_load)
2025-04-19 14:31:43,676 - DEBUG - [load_data_to_table] Loaded stock_actions for MSFT.
2025-04-19 14:31:43,676 - WARNING - [run_stock_info_pipeline] Rollback MSFT due to load errors.
2025-04-19 14:31:43,676 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=MSFT, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 14:31:44,279 - DEBUG - [run_stock_info_pipeline] Processing 3/4: Ticker GOOG
2025-04-19 14:31:44,280 - DEBUG - [get_raw_json] get_raw_json(): https://query2.finance.yahoo.com/v10/finance/quoteSummary/GOOG
2025-04-19 14:31:44,281 - DEBUG - [wrapper] Entering get()
2025-04-19 14:31:44,281 - DEBUG - [wrapper]  Entering _make_request()
2025-04-19 14:31:44,281 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/v10/finance/quoteSummary/GOOG
2025-04-19 14:31:44,281 - DEBUG - [_make_request] params={'modules': 'financialData,quoteType,defaultKeyStatistics,assetProfile,summaryDetail', 'corsDomain': 'finance.yahoo.com', 'formatted': 'false', 'symbol': 'GOOG'}
2025-04-19 14:31:44,281 - DEBUG - [wrapper]   Entering _get_cookie_and_crumb()
2025-04-19 14:31:44,281 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:44,282 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:44,282 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:44,282 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:44,282 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:44,282 - DEBUG - [wrapper]   Exiting _get_cookie_and_crumb()
2025-04-19 14:31:44,438 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /v10/finance/quoteSummary/GOOG?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=GOOG&crumb=NgZIowMiLwG HTTP/1.1" 200 2836
2025-04-19 14:31:44,439 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:44,439 - DEBUG - [wrapper]  Exiting _make_request()
2025-04-19 14:31:44,439 - DEBUG - [wrapper] Exiting get()
2025-04-19 14:31:44,439 - DEBUG - [get_raw_json] get_raw_json(): https://query1.finance.yahoo.com/v7/finance/quote?
2025-04-19 14:31:44,439 - DEBUG - [wrapper] Entering get()
2025-04-19 14:31:44,439 - DEBUG - [wrapper]  Entering _make_request()
2025-04-19 14:31:44,439 - DEBUG - [_make_request] url=https://query1.finance.yahoo.com/v7/finance/quote?
2025-04-19 14:31:44,439 - DEBUG - [_make_request] params={'symbols': 'GOOG', 'formatted': 'false'}
2025-04-19 14:31:44,439 - DEBUG - [wrapper]   Entering _get_cookie_and_crumb()
2025-04-19 14:31:44,439 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:44,439 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:44,439 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:44,440 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:44,440 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:44,440 - DEBUG - [wrapper]   Exiting _get_cookie_and_crumb()
2025-04-19 14:31:44,558 - DEBUG - [_make_request] https://query1.finance.yahoo.com:443 "GET /v7/finance/quote?symbols=GOOG&formatted=false&crumb=NgZIowMiLwG HTTP/1.1" 200 1138
2025-04-19 14:31:44,558 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:44,558 - DEBUG - [wrapper]  Exiting _make_request()
2025-04-19 14:31:44,558 - DEBUG - [wrapper] Exiting get()
2025-04-19 14:31:44,559 - DEBUG - [wrapper] Entering get()
2025-04-19 14:31:44,559 - DEBUG - [wrapper]  Entering _make_request()
2025-04-19 14:31:44,559 - DEBUG - [_make_request] url=https://query1.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/GOOG?symbol=GOOG&type=trailingPegRatio&period1=1729296000&period2=1745107200
2025-04-19 14:31:44,559 - DEBUG - [_make_request] params=None
2025-04-19 14:31:44,559 - DEBUG - [wrapper]   Entering _get_cookie_and_crumb()
2025-04-19 14:31:44,559 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:44,559 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:44,559 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:44,559 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:44,559 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:44,559 - DEBUG - [wrapper]   Exiting _get_cookie_and_crumb()
2025-04-19 14:31:44,659 - DEBUG - [_make_request] https://query1.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/GOOG?symbol=GOOG&type=trailingPegRatio&period1=1729296000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 247
2025-04-19 14:31:44,660 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:44,660 - DEBUG - [wrapper]  Exiting _make_request()
2025-04-19 14:31:44,660 - DEBUG - [wrapper] Exiting get()
2025-04-19 14:31:44,660 - DEBUG - [fetch_company_info] Skip complex type key 'companyOfficers'
2025-04-19 14:31:44,660 - DEBUG - [fetch_company_info] Skip complex type key 'executiveTeam'
2025-04-19 14:31:44,661 - DEBUG - [fetch_company_info] Skip complex type key 'corporateActions'
2025-04-19 14:31:44,666 - DEBUG - [fetch_financial_statement] Fetching annual financials for GOOG
2025-04-19 14:31:44,666 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:44,667 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:44,667 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:44,667 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/GOOG?symbol=GOOG&type=quarterlyTaxEffectOfUnusualItems,quarterlyTaxRateForCalcs,quarterlyNormalizedEBITDA,quarterlyNor...
2025-04-19 14:31:44,667 - DEBUG - [_make_request] params=None
2025-04-19 14:31:44,667 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:44,667 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:44,667 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:44,667 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:44,667 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:44,667 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:44,667 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:44,834 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/GOOG?symbol=GOOG&type=quarterlyTaxEffectOfUnusualItems,quarterlyTaxRateForCalcs,quarterlyNormalizedEBITDA,quarterlyNormalizedDilutedEPS,quarterlyNormalizedBasicEPS,quarterlyTotalUnusualItems,quarterlyTotalUnusualItemsExcludingGoodwill,quarterlyNetIncomeFromContinuingOperationNetMinorityInterest,quarterlyReconciledDepreciation,quarterlyReconciledCostOfRevenue,quarterlyEBITDA,quarterlyEBIT,quarterlyNetInterestIncome,quarterlyInterestExpense,quarterlyInterestIncome,quarterlyContinuingAndDiscontinuedDilutedEPS,quarterlyContinuingAndDiscontinuedBasicEPS,quarterlyNormalizedIncome,quarterlyNetIncomeFromContinuingAndDiscontinuedOperation,quarterlyTotalExpenses,quarterlyRentExpenseSupplemental,quarterlyReportedNormalizedDilutedEPS,quarterlyReportedNormalizedBasicEPS,quarterlyTotalOperatingIncomeAsReported,quarterlyDividendPerShare,quarterlyDilutedAverageShares,quarterlyBasicAverageShares,quarterlyDilutedEPS,quarterlyDilutedEPSOtherGainsLosses,quarterlyTaxLossCarryforwardDilutedEPS,quarterlyDilutedAccountingChange,quarterlyDilutedExtraordinary,quarterlyDilutedDiscontinuousOperations,quarterlyDilutedContinuousOperations,quarterlyBasicEPS,quarterlyBasicEPSOtherGainsLosses,quarterlyTaxLossCarryforwardBasicEPS,quarterlyBasicAccountingChange,quarterlyBasicExtraordinary,quarterlyBasicDiscontinuousOperations,quarterlyBasicContinuousOperations,quarterlyDilutedNIAvailtoComStockholders,quarterlyAverageDilutionEarnings,quarterlyNetIncomeCommonStockholders,quarterlyOtherunderPreferredStockDividend,quarterlyPreferredStockDividends,quarterlyNetIncome,quarterlyMinorityInterests,quarterlyNetIncomeIncludingNoncontrollingInterests,quarterlyNetIncomeFromTaxLossCarryforward,quarterlyNetIncomeExtraordinary,quarterlyNetIncomeDiscontinuousOperations,quarterlyNetIncomeContinuousOperations,quarterlyEarningsFromEquityInterestNetOfTax,quarterlyTaxProvision,quarterlyPretaxIncome,quarterlyOtherIncomeExpense,quarterlyOtherNonOperatingIncomeExpenses,quarterlySpecialIncomeCharges,quarterlyGainOnSaleOfPPE,quarterlyGainOnSaleOfBusiness,quarterlyOtherSpecialCharges,quarterlyWriteOff,quarterlyImpairmentOfCapitalAssets,quarterlyRestructuringAndMergernAcquisition,quarterlySecuritiesAmortization,quarterlyEarningsFromEquityInterest,quarterlyGainOnSaleOfSecurity,quarterlyNetNonOperatingInterestIncomeExpense,quarterlyTotalOtherFinanceCost,quarterlyInterestExpenseNonOperating,quarterlyInterestIncomeNonOperating,quarterlyOperatingIncome,quarterlyOperatingExpense,quarterlyOtherOperatingExpenses,quarterlyOtherTaxes,quarterlyProvisionForDoubtfulAccounts,quarterlyDepreciationAmortizationDepletionIncomeStatement,quarterlyDepletionIncomeStatement,quarterlyDepreciationAndAmortizationInIncomeStatement,quarterlyAmortization,quarterlyAmortizationOfIntangiblesIncomeStatement,quarterlyDepreciationIncomeStatement,quarterlyResearchAndDevelopment,quarterlySellingGeneralAndAdministration,quarterlySellingAndMarketingExpense,quarterlyGeneralAndAdministrativeExpense,quarterlyOtherGandA,quarterlyInsuranceAndClaims,quarterlyRentAndLandingFees,quarterlySalariesAndWages,quarterlyGrossProfit,quarterlyCostOfRevenue,quarterlyTotalRevenue,quarterlyExciseTaxes,quarterlyOperatingRevenue,quarterlyLossAdjustmentExpense,quarterlyNetPolicyholderBenefitsAndClaims,quarterlyPolicyholderBenefitsGross,quarterlyPolicyholderBenefitsCeded,quarterlyOccupancyAndEquipment,quarterlyProfessionalExpenseAndContractServicesExpense,quarterlyOtherNonInterestExpense&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:44,835 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:44,835 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:44,835 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:44,855 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:44,856 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:44,857 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:44,857 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:44,857 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/GOOG?symbol=GOOG&type=annualTaxEffectOfUnusualItems,annualTaxRateForCalcs,annualNormalizedEBITDA,annualNormalizedDilut...
2025-04-19 14:31:44,857 - DEBUG - [_make_request] params=None
2025-04-19 14:31:44,857 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:44,857 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:44,858 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:44,858 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:44,858 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:44,858 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:44,858 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:45,163 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/GOOG?symbol=GOOG&type=annualTaxEffectOfUnusualItems,annualTaxRateForCalcs,annualNormalizedEBITDA,annualNormalizedDilutedEPS,annualNormalizedBasicEPS,annualTotalUnusualItems,annualTotalUnusualItemsExcludingGoodwill,annualNetIncomeFromContinuingOperationNetMinorityInterest,annualReconciledDepreciation,annualReconciledCostOfRevenue,annualEBITDA,annualEBIT,annualNetInterestIncome,annualInterestExpense,annualInterestIncome,annualContinuingAndDiscontinuedDilutedEPS,annualContinuingAndDiscontinuedBasicEPS,annualNormalizedIncome,annualNetIncomeFromContinuingAndDiscontinuedOperation,annualTotalExpenses,annualRentExpenseSupplemental,annualReportedNormalizedDilutedEPS,annualReportedNormalizedBasicEPS,annualTotalOperatingIncomeAsReported,annualDividendPerShare,annualDilutedAverageShares,annualBasicAverageShares,annualDilutedEPS,annualDilutedEPSOtherGainsLosses,annualTaxLossCarryforwardDilutedEPS,annualDilutedAccountingChange,annualDilutedExtraordinary,annualDilutedDiscontinuousOperations,annualDilutedContinuousOperations,annualBasicEPS,annualBasicEPSOtherGainsLosses,annualTaxLossCarryforwardBasicEPS,annualBasicAccountingChange,annualBasicExtraordinary,annualBasicDiscontinuousOperations,annualBasicContinuousOperations,annualDilutedNIAvailtoComStockholders,annualAverageDilutionEarnings,annualNetIncomeCommonStockholders,annualOtherunderPreferredStockDividend,annualPreferredStockDividends,annualNetIncome,annualMinorityInterests,annualNetIncomeIncludingNoncontrollingInterests,annualNetIncomeFromTaxLossCarryforward,annualNetIncomeExtraordinary,annualNetIncomeDiscontinuousOperations,annualNetIncomeContinuousOperations,annualEarningsFromEquityInterestNetOfTax,annualTaxProvision,annualPretaxIncome,annualOtherIncomeExpense,annualOtherNonOperatingIncomeExpenses,annualSpecialIncomeCharges,annualGainOnSaleOfPPE,annualGainOnSaleOfBusiness,annualOtherSpecialCharges,annualWriteOff,annualImpairmentOfCapitalAssets,annualRestructuringAndMergernAcquisition,annualSecuritiesAmortization,annualEarningsFromEquityInterest,annualGainOnSaleOfSecurity,annualNetNonOperatingInterestIncomeExpense,annualTotalOtherFinanceCost,annualInterestExpenseNonOperating,annualInterestIncomeNonOperating,annualOperatingIncome,annualOperatingExpense,annualOtherOperatingExpenses,annualOtherTaxes,annualProvisionForDoubtfulAccounts,annualDepreciationAmortizationDepletionIncomeStatement,annualDepletionIncomeStatement,annualDepreciationAndAmortizationInIncomeStatement,annualAmortization,annualAmortizationOfIntangiblesIncomeStatement,annualDepreciationIncomeStatement,annualResearchAndDevelopment,annualSellingGeneralAndAdministration,annualSellingAndMarketingExpense,annualGeneralAndAdministrativeExpense,annualOtherGandA,annualInsuranceAndClaims,annualRentAndLandingFees,annualSalariesAndWages,annualGrossProfit,annualCostOfRevenue,annualTotalRevenue,annualExciseTaxes,annualOperatingRevenue,annualLossAdjustmentExpense,annualNetPolicyholderBenefitsAndClaims,annualPolicyholderBenefitsGross,annualPolicyholderBenefitsCeded,annualOccupancyAndEquipment,annualProfessionalExpenseAndContractServicesExpense,annualOtherNonInterestExpense&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:45,164 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:45,164 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:45,164 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:45,186 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:45,187 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:45,187 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:45,187 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:45,188 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/GOOG?symbol=GOOG&type=quarterlyTreasurySharesNumber,quarterlyPreferredSharesNumber,quarterlyOrdinarySharesNumber,quart...
2025-04-19 14:31:45,188 - DEBUG - [_make_request] params=None
2025-04-19 14:31:45,188 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:45,188 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:45,188 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:45,188 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:45,188 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:45,188 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:45,188 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:45,442 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/GOOG?symbol=GOOG&type=quarterlyTreasurySharesNumber,quarterlyPreferredSharesNumber,quarterlyOrdinarySharesNumber,quarterlyShareIssued,quarterlyNetDebt,quarterlyTotalDebt,quarterlyTangibleBookValue,quarterlyInvestedCapital,quarterlyWorkingCapital,quarterlyNetTangibleAssets,quarterlyCapitalLeaseObligations,quarterlyCommonStockEquity,quarterlyPreferredStockEquity,quarterlyTotalCapitalization,quarterlyTotalEquityGrossMinorityInterest,quarterlyMinorityInterest,quarterlyStockholdersEquity,quarterlyOtherEquityInterest,quarterlyGainsLossesNotAffectingRetainedEarnings,quarterlyOtherEquityAdjustments,quarterlyFixedAssetsRevaluationReserve,quarterlyForeignCurrencyTranslationAdjustments,quarterlyMinimumPensionLiabilities,quarterlyUnrealizedGainLoss,quarterlyTreasuryStock,quarterlyRetainedEarnings,quarterlyAdditionalPaidInCapital,quarterlyCapitalStock,quarterlyOtherCapitalStock,quarterlyCommonStock,quarterlyPreferredStock,quarterlyTotalPartnershipCapital,quarterlyGeneralPartnershipCapital,quarterlyLimitedPartnershipCapital,quarterlyTotalLiabilitiesNetMinorityInterest,quarterlyTotalNonCurrentLiabilitiesNetMinorityInterest,quarterlyOtherNonCurrentLiabilities,quarterlyLiabilitiesHeldforSaleNonCurrent,quarterlyRestrictedCommonStock,quarterlyPreferredSecuritiesOutsideStockEquity,quarterlyDerivativeProductLiabilities,quarterlyEmployeeBenefits,quarterlyNonCurrentPensionAndOtherPostretirementBenefitPlans,quarterlyNonCurrentAccruedExpenses,quarterlyDuetoRelatedPartiesNonCurrent,quarterlyTradeandOtherPayablesNonCurrent,quarterlyNonCurrentDeferredLiabilities,quarterlyNonCurrentDeferredRevenue,quarterlyNonCurrentDeferredTaxesLiabilities,quarterlyLongTermDebtAndCapitalLeaseObligation,quarterlyLongTermCapitalLeaseObligation,quarterlyLongTermDebt,quarterlyLongTermProvisions,quarterlyCurrentLiabilities,quarterlyOtherCurrentLiabilities,quarterlyCurrentDeferredLiabilities,quarterlyCurrentDeferredRevenue,quarterlyCurrentDeferredTaxesLiabilities,quarterlyCurrentDebtAndCapitalLeaseObligation,quarterlyCurrentCapitalLeaseObligation,quarterlyCurrentDebt,quarterlyOtherCurrentBorrowings,quarterlyLineOfCredit,quarterlyCommercialPaper,quarterlyCurrentNotesPayable,quarterlyPensionandOtherPostRetirementBenefitPlansCurrent,quarterlyCurrentProvisions,quarterlyPayablesAndAccruedExpenses,quarterlyCurrentAccruedExpenses,quarterlyInterestPayable,quarterlyPayables,quarterlyOtherPayable,quarterlyDuetoRelatedPartiesCurrent,quarterlyDividendsPayable,quarterlyTotalTaxPayable,quarterlyIncomeTaxPayable,quarterlyAccountsPayable,quarterlyTotalAssets,quarterlyTotalNonCurrentAssets,quarterlyOtherNonCurrentAssets,quarterlyDefinedPensionBenefit,quarterlyNonCurrentPrepaidAssets,quarterlyNonCurrentDeferredAssets,quarterlyNonCurrentDeferredTaxesAssets,quarterlyDuefromRelatedPartiesNonCurrent,quarterlyNonCurrentNoteReceivables,quarterlyNonCurrentAccountsReceivable,quarterlyFinancialAssets,quarterlyInvestmentsAndAdvances,quarterlyOtherInvestments,quarterlyInvestmentinFinancialAssets,quarterlyHeldToMaturitySecurities,quarterlyAvailableForSaleSecurities,quarterlyFinancialAssetsDesignatedasFairValueThroughProfitorLossTotal,quarterlyTradingSecurities,quarterlyLongTermEquityInvestment,quarterlyInvestmentsinJointVenturesatCost,quarterlyInvestmentsInOtherVenturesUnderEquityMethod,quarterlyInvestmentsinAssociatesatCost,quarterlyInvestmentsinSubsidiariesatCost,quarterlyInvestmentProperties,quarterlyGoodwillAndOtherIntangibleAssets,quarterlyOtherIntangibleAssets,quarterlyGoodwill,quarterlyNetPPE,quarterlyAccumulatedDepreciation,quarterlyGrossPPE,quarterlyLeases,quarterlyConstructionInProgress,quarterlyOtherProperties,quarterlyMachineryFurnitureEquipment,quarterlyBuildingsAndImprovements,quarterlyLandAndImprovements,quarterlyProperties,quarterlyCurrentAssets,quarterlyOtherCurrentAssets,quarterlyHedgingAssetsCurrent,quarterlyAssetsHeldForSaleCurrent,quarterlyCurrentDeferredAssets,quarterlyCurrentDeferredTaxesAssets,quarterlyRestrictedCash,quarterlyPrepaidAssets,quarterlyInventory,quarterlyInventoriesAdjustmentsAllowances,quarterlyOtherInventories,quarterlyFinishedGoods,quarterlyWorkInProcess,quarterlyRawMaterials,quarterlyReceivables,quarterlyReceivablesAdjustmentsAllowances,quarterlyOtherReceivables,quarterlyDuefromRelatedPartiesCurrent,quarterlyTaxesReceivable,quarterlyAccruedInterestReceivable,quarterlyNotesReceivable,quarterlyLoansReceivable,quarterlyAccountsReceivable,quarterlyAllowanceForDoubtfulAccountsReceivable,quarterlyGrossAccountsReceivable,quarterlyCashCashEquivalentsAndShortTermInvestments,quarterlyOtherShortTermInvestments,quarterlyCashAndCashEquivalents,quarterlyCashEquivalents,quarterlyCashFinancial,quarterlyCashCashEquivalentsAndFederalFundsSold&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:45,493 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:45,493 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:45,493 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:45,538 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:45,539 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:45,539 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:45,539 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:45,539 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/GOOG?symbol=GOOG&type=annualTreasurySharesNumber,annualPreferredSharesNumber,annualOrdinarySharesNumber,annualShareIss...
2025-04-19 14:31:45,539 - DEBUG - [_make_request] params=None
2025-04-19 14:31:45,539 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:45,539 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:45,540 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:45,540 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:45,540 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:45,540 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:45,540 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:45,824 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/GOOG?symbol=GOOG&type=annualTreasurySharesNumber,annualPreferredSharesNumber,annualOrdinarySharesNumber,annualShareIssued,annualNetDebt,annualTotalDebt,annualTangibleBookValue,annualInvestedCapital,annualWorkingCapital,annualNetTangibleAssets,annualCapitalLeaseObligations,annualCommonStockEquity,annualPreferredStockEquity,annualTotalCapitalization,annualTotalEquityGrossMinorityInterest,annualMinorityInterest,annualStockholdersEquity,annualOtherEquityInterest,annualGainsLossesNotAffectingRetainedEarnings,annualOtherEquityAdjustments,annualFixedAssetsRevaluationReserve,annualForeignCurrencyTranslationAdjustments,annualMinimumPensionLiabilities,annualUnrealizedGainLoss,annualTreasuryStock,annualRetainedEarnings,annualAdditionalPaidInCapital,annualCapitalStock,annualOtherCapitalStock,annualCommonStock,annualPreferredStock,annualTotalPartnershipCapital,annualGeneralPartnershipCapital,annualLimitedPartnershipCapital,annualTotalLiabilitiesNetMinorityInterest,annualTotalNonCurrentLiabilitiesNetMinorityInterest,annualOtherNonCurrentLiabilities,annualLiabilitiesHeldforSaleNonCurrent,annualRestrictedCommonStock,annualPreferredSecuritiesOutsideStockEquity,annualDerivativeProductLiabilities,annualEmployeeBenefits,annualNonCurrentPensionAndOtherPostretirementBenefitPlans,annualNonCurrentAccruedExpenses,annualDuetoRelatedPartiesNonCurrent,annualTradeandOtherPayablesNonCurrent,annualNonCurrentDeferredLiabilities,annualNonCurrentDeferredRevenue,annualNonCurrentDeferredTaxesLiabilities,annualLongTermDebtAndCapitalLeaseObligation,annualLongTermCapitalLeaseObligation,annualLongTermDebt,annualLongTermProvisions,annualCurrentLiabilities,annualOtherCurrentLiabilities,annualCurrentDeferredLiabilities,annualCurrentDeferredRevenue,annualCurrentDeferredTaxesLiabilities,annualCurrentDebtAndCapitalLeaseObligation,annualCurrentCapitalLeaseObligation,annualCurrentDebt,annualOtherCurrentBorrowings,annualLineOfCredit,annualCommercialPaper,annualCurrentNotesPayable,annualPensionandOtherPostRetirementBenefitPlansCurrent,annualCurrentProvisions,annualPayablesAndAccruedExpenses,annualCurrentAccruedExpenses,annualInterestPayable,annualPayables,annualOtherPayable,annualDuetoRelatedPartiesCurrent,annualDividendsPayable,annualTotalTaxPayable,annualIncomeTaxPayable,annualAccountsPayable,annualTotalAssets,annualTotalNonCurrentAssets,annualOtherNonCurrentAssets,annualDefinedPensionBenefit,annualNonCurrentPrepaidAssets,annualNonCurrentDeferredAssets,annualNonCurrentDeferredTaxesAssets,annualDuefromRelatedPartiesNonCurrent,annualNonCurrentNoteReceivables,annualNonCurrentAccountsReceivable,annualFinancialAssets,annualInvestmentsAndAdvances,annualOtherInvestments,annualInvestmentinFinancialAssets,annualHeldToMaturitySecurities,annualAvailableForSaleSecurities,annualFinancialAssetsDesignatedasFairValueThroughProfitorLossTotal,annualTradingSecurities,annualLongTermEquityInvestment,annualInvestmentsinJointVenturesatCost,annualInvestmentsInOtherVenturesUnderEquityMethod,annualInvestmentsinAssociatesatCost,annualInvestmentsinSubsidiariesatCost,annualInvestmentProperties,annualGoodwillAndOtherIntangibleAssets,annualOtherIntangibleAssets,annualGoodwill,annualNetPPE,annualAccumulatedDepreciation,annualGrossPPE,annualLeases,annualConstructionInProgress,annualOtherProperties,annualMachineryFurnitureEquipment,annualBuildingsAndImprovements,annualLandAndImprovements,annualProperties,annualCurrentAssets,annualOtherCurrentAssets,annualHedgingAssetsCurrent,annualAssetsHeldForSaleCurrent,annualCurrentDeferredAssets,annualCurrentDeferredTaxesAssets,annualRestrictedCash,annualPrepaidAssets,annualInventory,annualInventoriesAdjustmentsAllowances,annualOtherInventories,annualFinishedGoods,annualWorkInProcess,annualRawMaterials,annualReceivables,annualReceivablesAdjustmentsAllowances,annualOtherReceivables,annualDuefromRelatedPartiesCurrent,annualTaxesReceivable,annualAccruedInterestReceivable,annualNotesReceivable,annualLoansReceivable,annualAccountsReceivable,annualAllowanceForDoubtfulAccountsReceivable,annualGrossAccountsReceivable,annualCashCashEquivalentsAndShortTermInvestments,annualOtherShortTermInvestments,annualCashAndCashEquivalents,annualCashEquivalents,annualCashFinancial,annualCashCashEquivalentsAndFederalFundsSold&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:45,825 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:45,825 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:45,825 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:45,860 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:45,861 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:45,861 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:45,861 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:45,861 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/GOOG?symbol=GOOG&type=quarterlyForeignSales,quarterlyDomesticSales,quarterlyAdjustedGeographySegmentData,quarterlyFree...
2025-04-19 14:31:45,862 - DEBUG - [_make_request] params=None
2025-04-19 14:31:45,862 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:45,862 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:45,862 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:45,862 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:45,862 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:45,862 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:45,862 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:46,035 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/GOOG?symbol=GOOG&type=quarterlyForeignSales,quarterlyDomesticSales,quarterlyAdjustedGeographySegmentData,quarterlyFreeCashFlow,quarterlyRepurchaseOfCapitalStock,quarterlyRepaymentOfDebt,quarterlyIssuanceOfDebt,quarterlyIssuanceOfCapitalStock,quarterlyCapitalExpenditure,quarterlyInterestPaidSupplementalData,quarterlyIncomeTaxPaidSupplementalData,quarterlyEndCashPosition,quarterlyOtherCashAdjustmentOutsideChangeinCash,quarterlyBeginningCashPosition,quarterlyEffectOfExchangeRateChanges,quarterlyChangesInCash,quarterlyOtherCashAdjustmentInsideChangeinCash,quarterlyCashFlowFromDiscontinuedOperation,quarterlyFinancingCashFlow,quarterlyCashFromDiscontinuedFinancingActivities,quarterlyCashFlowFromContinuingFinancingActivities,quarterlyNetOtherFinancingCharges,quarterlyInterestPaidCFF,quarterlyProceedsFromStockOptionExercised,quarterlyCashDividendsPaid,quarterlyPreferredStockDividendPaid,quarterlyCommonStockDividendPaid,quarterlyNetPreferredStockIssuance,quarterlyPreferredStockPayments,quarterlyPreferredStockIssuance,quarterlyNetCommonStockIssuance,quarterlyCommonStockPayments,quarterlyCommonStockIssuance,quarterlyNetIssuancePaymentsOfDebt,quarterlyNetShortTermDebtIssuance,quarterlyShortTermDebtPayments,quarterlyShortTermDebtIssuance,quarterlyNetLongTermDebtIssuance,quarterlyLongTermDebtPayments,quarterlyLongTermDebtIssuance,quarterlyInvestingCashFlow,quarterlyCashFromDiscontinuedInvestingActivities,quarterlyCashFlowFromContinuingInvestingActivities,quarterlyNetOtherInvestingChanges,quarterlyInterestReceivedCFI,quarterlyDividendsReceivedCFI,quarterlyNetInvestmentPurchaseAndSale,quarterlySaleOfInvestment,quarterlyPurchaseOfInvestment,quarterlyNetInvestmentPropertiesPurchaseAndSale,quarterlySaleOfInvestmentProperties,quarterlyPurchaseOfInvestmentProperties,quarterlyNetBusinessPurchaseAndSale,quarterlySaleOfBusiness,quarterlyPurchaseOfBusiness,quarterlyNetIntangiblesPurchaseAndSale,quarterlySaleOfIntangibles,quarterlyPurchaseOfIntangibles,quarterlyNetPPEPurchaseAndSale,quarterlySaleOfPPE,quarterlyPurchaseOfPPE,quarterlyCapitalExpenditureReported,quarterlyOperatingCashFlow,quarterlyCashFromDiscontinuedOperatingActivities,quarterlyCashFlowFromContinuingOperatingActivities,quarterlyTaxesRefundPaid,quarterlyInterestReceivedCFO,quarterlyInterestPaidCFO,quarterlyDividendReceivedCFO,quarterlyDividendPaidCFO,quarterlyChangeInWorkingCapital,quarterlyChangeInOtherWorkingCapital,quarterlyChangeInOtherCurrentLiabilities,quarterlyChangeInOtherCurrentAssets,quarterlyChangeInPayablesAndAccruedExpense,quarterlyChangeInAccruedExpense,quarterlyChangeInInterestPayable,quarterlyChangeInPayable,quarterlyChangeInDividendPayable,quarterlyChangeInAccountPayable,quarterlyChangeInTaxPayable,quarterlyChangeInIncomeTaxPayable,quarterlyChangeInPrepaidAssets,quarterlyChangeInInventory,quarterlyChangeInReceivables,quarterlyChangesInAccountReceivables,quarterlyOtherNonCashItems,quarterlyExcessTaxBenefitFromStockBasedCompensation,quarterlyStockBasedCompensation,quarterlyUnrealizedGainLossOnInvestmentSecurities,quarterlyProvisionandWriteOffofAssets,quarterlyAssetImpairmentCharge,quarterlyAmortizationOfSecurities,quarterlyDeferredTax,quarterlyDeferredIncomeTax,quarterlyDepreciationAmortizationDepletion,quarterlyDepletion,quarterlyDepreciationAndAmortization,quarterlyAmortizationCashFlow,quarterlyAmortizationOfIntangibles,quarterlyDepreciation,quarterlyOperatingGainsLosses,quarterlyPensionAndEmployeeBenefitExpense,quarterlyEarningsLossesFromEquityInvestments,quarterlyGainLossOnInvestmentSecurities,quarterlyNetForeignCurrencyExchangeGainLoss,quarterlyGainLossOnSaleOfPPE,quarterlyGainLossOnSaleOfBusiness,quarterlyNetIncomeFromContinuingOperations,quarterlyCashFlowsfromusedinOperatingActivitiesDirect,quarterlyTaxesRefundPaidDirect,quarterlyInterestReceivedDirect,quarterlyInterestPaidDirect,quarterlyDividendsReceivedDirect,quarterlyDividendsPaidDirect,quarterlyClassesofCashPayments,quarterlyOtherCashPaymentsfromOperatingActivities,quarterlyPaymentsonBehalfofEmployees,quarterlyPaymentstoSuppliersforGoodsandServices,quarterlyClassesofCashReceiptsfromOperatingActivities,quarterlyOtherCashReceiptsfromOperatingActivities,quarterlyReceiptsfromGovernmentGrants,quarterlyReceiptsfromCustomers&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:46,037 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:46,037 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:46,037 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:46,067 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:46,068 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:46,068 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:46,069 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:46,069 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/GOOG?symbol=GOOG&type=annualForeignSales,annualDomesticSales,annualAdjustedGeographySegmentData,annualFreeCashFlow,ann...
2025-04-19 14:31:46,069 - DEBUG - [_make_request] params=None
2025-04-19 14:31:46,069 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:46,069 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:46,069 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:46,069 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:46,069 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:46,069 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:46,069 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:46,295 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/GOOG?symbol=GOOG&type=annualForeignSales,annualDomesticSales,annualAdjustedGeographySegmentData,annualFreeCashFlow,annualRepurchaseOfCapitalStock,annualRepaymentOfDebt,annualIssuanceOfDebt,annualIssuanceOfCapitalStock,annualCapitalExpenditure,annualInterestPaidSupplementalData,annualIncomeTaxPaidSupplementalData,annualEndCashPosition,annualOtherCashAdjustmentOutsideChangeinCash,annualBeginningCashPosition,annualEffectOfExchangeRateChanges,annualChangesInCash,annualOtherCashAdjustmentInsideChangeinCash,annualCashFlowFromDiscontinuedOperation,annualFinancingCashFlow,annualCashFromDiscontinuedFinancingActivities,annualCashFlowFromContinuingFinancingActivities,annualNetOtherFinancingCharges,annualInterestPaidCFF,annualProceedsFromStockOptionExercised,annualCashDividendsPaid,annualPreferredStockDividendPaid,annualCommonStockDividendPaid,annualNetPreferredStockIssuance,annualPreferredStockPayments,annualPreferredStockIssuance,annualNetCommonStockIssuance,annualCommonStockPayments,annualCommonStockIssuance,annualNetIssuancePaymentsOfDebt,annualNetShortTermDebtIssuance,annualShortTermDebtPayments,annualShortTermDebtIssuance,annualNetLongTermDebtIssuance,annualLongTermDebtPayments,annualLongTermDebtIssuance,annualInvestingCashFlow,annualCashFromDiscontinuedInvestingActivities,annualCashFlowFromContinuingInvestingActivities,annualNetOtherInvestingChanges,annualInterestReceivedCFI,annualDividendsReceivedCFI,annualNetInvestmentPurchaseAndSale,annualSaleOfInvestment,annualPurchaseOfInvestment,annualNetInvestmentPropertiesPurchaseAndSale,annualSaleOfInvestmentProperties,annualPurchaseOfInvestmentProperties,annualNetBusinessPurchaseAndSale,annualSaleOfBusiness,annualPurchaseOfBusiness,annualNetIntangiblesPurchaseAndSale,annualSaleOfIntangibles,annualPurchaseOfIntangibles,annualNetPPEPurchaseAndSale,annualSaleOfPPE,annualPurchaseOfPPE,annualCapitalExpenditureReported,annualOperatingCashFlow,annualCashFromDiscontinuedOperatingActivities,annualCashFlowFromContinuingOperatingActivities,annualTaxesRefundPaid,annualInterestReceivedCFO,annualInterestPaidCFO,annualDividendReceivedCFO,annualDividendPaidCFO,annualChangeInWorkingCapital,annualChangeInOtherWorkingCapital,annualChangeInOtherCurrentLiabilities,annualChangeInOtherCurrentAssets,annualChangeInPayablesAndAccruedExpense,annualChangeInAccruedExpense,annualChangeInInterestPayable,annualChangeInPayable,annualChangeInDividendPayable,annualChangeInAccountPayable,annualChangeInTaxPayable,annualChangeInIncomeTaxPayable,annualChangeInPrepaidAssets,annualChangeInInventory,annualChangeInReceivables,annualChangesInAccountReceivables,annualOtherNonCashItems,annualExcessTaxBenefitFromStockBasedCompensation,annualStockBasedCompensation,annualUnrealizedGainLossOnInvestmentSecurities,annualProvisionandWriteOffofAssets,annualAssetImpairmentCharge,annualAmortizationOfSecurities,annualDeferredTax,annualDeferredIncomeTax,annualDepreciationAmortizationDepletion,annualDepletion,annualDepreciationAndAmortization,annualAmortizationCashFlow,annualAmortizationOfIntangibles,annualDepreciation,annualOperatingGainsLosses,annualPensionAndEmployeeBenefitExpense,annualEarningsLossesFromEquityInvestments,annualGainLossOnInvestmentSecurities,annualNetForeignCurrencyExchangeGainLoss,annualGainLossOnSaleOfPPE,annualGainLossOnSaleOfBusiness,annualNetIncomeFromContinuingOperations,annualCashFlowsfromusedinOperatingActivitiesDirect,annualTaxesRefundPaidDirect,annualInterestReceivedDirect,annualInterestPaidDirect,annualDividendsReceivedDirect,annualDividendsPaidDirect,annualClassesofCashPayments,annualOtherCashPaymentsfromOperatingActivities,annualPaymentsonBehalfofEmployees,annualPaymentstoSuppliersforGoodsandServices,annualClassesofCashReceiptsfromOperatingActivities,annualOtherCashReceiptsfromOperatingActivities,annualReceiptsfromGovernmentGrants,annualReceiptsfromCustomers&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:46,298 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:46,298 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:46,298 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:46,349 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:46,356 - DEBUG - [fetch_financial_statement] Raw annual financials data head for GOOG:
                                            2024-12-31      2023-12-31     2022-12-31     2021-12-31 2020-12-31
Tax Effect Of Unusual Items                370968000.0    -286479000.0   -981507000.0   1948860000.0        NaN
Tax Rate For Calcs                               0.164           0.139          0.159          0.162        NaN
Normalized EBITDA                       133132000000.0  100032000000.0  91333000000.0  91491000000.0        NaN
Total Unusual Items                       2262000000.0   -2061000000.0  -6173000000.0  12030000000.0        NaN
Total Unusual Items Excluding Goodwill    2262000000.0   -2061000000.0  -6173000000.0  12030000000.0        NaN
2025-04-19 14:31:46,356 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Tax Effect Of Unusual Items', 'Tax Rate For Calcs',
       'Normalized EBITDA', 'Total Unusual Items',
       'Total Unusual Items Excluding Goodwill',
       'Net Income From Continuing Operation Net Minority Interest',
       'Reconciled Depreciation', 'Reconciled Cost Of Revenue', 'EBITDA',
       'EBIT', 'Net Interest Income', 'Interest Expense', 'Interest Income',
       'Normalized Income',
       'Net Income From Continuing And Discontinued Operation',
       'Total Expenses', 'Total Operating Income As Reported',
       'Diluted Average Shares', 'Basic Average Shares', 'Diluted EPS',
       'Basic EPS', 'Diluted NI Availto Com Stockholders',
       'Net Income Common Stockholders', 'Net Income',
       'Net Income Including Noncontrolling Interests',
       'Net Income Continuous Operations', 'Tax Provision', 'Pretax Income',
       'Other Income Expense', 'Other Non Operating Income Expenses',
       'Special Income Charges', 'Earnings From Equity Interest',
       'Gain On Sale Of Security', 'Net Non Operating Interest Income Expense',
       'Interest Expense Non Operating', 'Interest Income Non Operating',
       'Operating Income', 'Operating Expense', 'Research And Development',
       'Selling General And Administration', 'Selling And Marketing Expense',
       'General And Administrative Expense', 'Other Gand A', 'Gross Profit',
       'Cost Of Revenue', 'Total Revenue', 'Operating Revenue'],
      dtype='object')
2025-04-19 14:31:46,357 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-12-31', '2023-12-31', '2022-12-31', '2021-12-31',
               '2020-12-31'],
              dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:46,361 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 47 entries, Tax Effect Of Unusual Items to Operating Revenue
Data columns (total 5 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-12-31 00:00:00  46 non-null     object
 1   2023-12-31 00:00:00  46 non-null     object
 2   2022-12-31 00:00:00  46 non-null     object
 3   2021-12-31 00:00:00  47 non-null     object
 4   2020-12-31 00:00:00  1 non-null      object
dtypes: object(5)
memory usage: 2.2+ KB

2025-04-19 14:31:46,390 - DEBUG - [fetch_financial_statement] Fetching quarterly financials for GOOG
2025-04-19 14:31:46,398 - DEBUG - [fetch_financial_statement] Raw quarterly financials data head for GOOG:
                                            2024-12-31     2024-09-30     2024-06-30     2024-03-31      2023-12-31 2023-09-30
Tax Effect Of Unusual Items            -15575969.97798    340680000.0   -171171000.0    253052000.0  3356955.595609        NaN
Tax Rate For Calcs                               0.177           0.17          0.143          0.164        0.152589        NaN
Normalized EBITDA                        36589000000.0  33741000000.0  32523000000.0  30279000000.0   26022000000.0        NaN
Total Unusual Items                        -88000000.0   2004000000.0  -1197000000.0   1543000000.0      22000000.0        NaN
Total Unusual Items Excluding Goodwill     -88000000.0   2004000000.0  -1197000000.0   1543000000.0      22000000.0        NaN
2025-04-19 14:31:46,399 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Tax Effect Of Unusual Items', 'Tax Rate For Calcs',
       'Normalized EBITDA', 'Total Unusual Items',
       'Total Unusual Items Excluding Goodwill',
       'Net Income From Continuing Operation Net Minority Interest',
       'Reconciled Depreciation', 'Reconciled Cost Of Revenue', 'EBITDA',
       'EBIT', 'Net Interest Income', 'Interest Expense', 'Interest Income',
       'Normalized Income',
       'Net Income From Continuing And Discontinued Operation',
       'Total Expenses', 'Total Operating Income As Reported',
       'Diluted Average Shares', 'Basic Average Shares', 'Diluted EPS',
       'Basic EPS', 'Diluted NI Availto Com Stockholders',
       'Average Dilution Earnings', 'Net Income Common Stockholders',
       'Net Income', 'Net Income Including Noncontrolling Interests',
       'Net Income Continuous Operations', 'Tax Provision', 'Pretax Income',
       'Other Income Expense', 'Other Non Operating Income Expenses',
       'Earnings From Equity Interest', 'Gain On Sale Of Security',
       'Net Non Operating Interest Income Expense',
       'Interest Expense Non Operating', 'Interest Income Non Operating',
       'Operating Income', 'Operating Expense', 'Research And Development',
       'Selling General And Administration', 'Selling And Marketing Expense',
       'General And Administrative Expense', 'Other Gand A', 'Gross Profit',
       'Cost Of Revenue', 'Total Revenue', 'Operating Revenue'],
      dtype='object')
2025-04-19 14:31:46,399 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-12-31', '2024-09-30', '2024-06-30', '2024-03-31',
               '2023-12-31', '2023-09-30'],
              dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:46,401 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 47 entries, Tax Effect Of Unusual Items to Operating Revenue
Data columns (total 6 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-12-31 00:00:00  42 non-null     object
 1   2024-09-30 00:00:00  46 non-null     object
 2   2024-06-30 00:00:00  46 non-null     object
 3   2024-03-31 00:00:00  47 non-null     object
 4   2023-12-31 00:00:00  46 non-null     object
 5   2023-09-30 00:00:00  4 non-null      object
dtypes: object(6)
memory usage: 2.6+ KB

2025-04-19 14:31:46,426 - DEBUG - [fetch_financial_statement] Fetching annual balance_sheet for GOOG
2025-04-19 14:31:46,434 - DEBUG - [fetch_financial_statement] Raw annual balance_sheet data head for GOOG:
                            2024-12-31      2023-12-31      2022-12-31      2021-12-31 2020-12-31
Treasury Shares Number             NaN             0.0             NaN             NaN        NaN
Ordinary Shares Number   12211000000.0   12460000000.0   12849000000.0   13242420000.0        NaN
Share Issued             12211000000.0   12460000000.0   12849000000.0   13242420000.0        NaN
Total Debt               25461000000.0   27121000000.0   29679000000.0   28395000000.0        NaN
Tangible Book Value     293199000000.0  254181000000.0  227184000000.0  227262000000.0        NaN
2025-04-19 14:31:46,435 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Treasury Shares Number', 'Ordinary Shares Number', 'Share Issued',
       'Total Debt', 'Tangible Book Value', 'Invested Capital',
       'Working Capital', 'Net Tangible Assets', 'Capital Lease Obligations',
       'Common Stock Equity', 'Total Capitalization',
       'Total Equity Gross Minority Interest', 'Stockholders Equity',
       'Gains Losses Not Affecting Retained Earnings',
       'Other Equity Adjustments', 'Retained Earnings', 'Capital Stock',
       'Common Stock', 'Preferred Stock',
       'Total Liabilities Net Minority Interest',
       'Total Non Current Liabilities Net Minority Interest',
       'Other Non Current Liabilities', 'Tradeand Other Payables Non Current',
       'Non Current Deferred Liabilities', 'Non Current Deferred Revenue',
       'Non Current Deferred Taxes Liabilities',
       'Long Term Debt And Capital Lease Obligation',
       'Long Term Capital Lease Obligation', 'Long Term Debt',
       'Current Liabilities', 'Other Current Liabilities',
       'Current Deferred Liabilities', 'Current Deferred Revenue',
       'Current Debt And Capital Lease Obligation',
       'Current Capital Lease Obligation',
       'Pensionand Other Post Retirement Benefit Plans Current',
       'Payables And Accrued Expenses', 'Current Accrued Expenses', 'Payables',
       'Other Payable', 'Total Tax Payable', 'Income Tax Payable',
       'Accounts Payable', 'Total Assets', 'Total Non Current Assets',
       'Other Non Current Assets', 'Non Current Deferred Assets',
       'Non Current Deferred Taxes Assets', 'Investments And Advances',
       'Investmentin Financial Assets', 'Available For Sale Securities',
       'Goodwill And Other Intangible Assets', 'Other Intangible Assets',
       'Goodwill', 'Net PPE', 'Accumulated Depreciation', 'Gross PPE',
       'Leases', 'Construction In Progress', 'Other Properties',
       'Machinery Furniture Equipment', 'Buildings And Improvements',
       'Land And Improvements', 'Properties', 'Current Assets',
       'Other Current Assets', 'Inventory', 'Receivables', 'Taxes Receivable',
       'Accounts Receivable', 'Allowance For Doubtful Accounts Receivable',
       'Gross Accounts Receivable',
       'Cash Cash Equivalents And Short Term Investments',
       'Other Short Term Investments', 'Cash And Cash Equivalents'],
      dtype='object')
2025-04-19 14:31:46,435 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-12-31', '2023-12-31', '2022-12-31', '2021-12-31',
               '2020-12-31'],
              dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:46,437 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 75 entries, Treasury Shares Number to Cash And Cash Equivalents
Data columns (total 5 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-12-31 00:00:00  63 non-null     object
 1   2023-12-31 00:00:00  71 non-null     object
 2   2022-12-31 00:00:00  71 non-null     object
 3   2021-12-31 00:00:00  73 non-null     object
 4   2020-12-31 00:00:00  11 non-null     object
dtypes: object(5)
memory usage: 3.5+ KB

2025-04-19 14:31:46,477 - DEBUG - [fetch_financial_statement] Fetching quarterly balance_sheet for GOOG
2025-04-19 14:31:46,487 - DEBUG - [fetch_financial_statement] Raw quarterly balance_sheet data head for GOOG:
                            2024-12-31      2024-09-30      2024-06-30      2024-03-31      2023-12-31 2023-09-30
Treasury Shares Number             NaN             NaN             NaN             NaN             0.0        NaN
Ordinary Shares Number   12211000000.0   12264000000.0   12322000000.0   12381000000.0   12460000000.0        NaN
Share Issued             12211000000.0   12264000000.0   12322000000.0   12381000000.0   12460000000.0        NaN
Total Debt               25461000000.0   26922000000.0   27801000000.0   28059000000.0   27121000000.0        NaN
Tangible Book Value     293199000000.0  282184000000.0  271568000000.0  263661000000.0  254181000000.0        NaN
2025-04-19 14:31:46,487 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Treasury Shares Number', 'Ordinary Shares Number', 'Share Issued',
       'Total Debt', 'Tangible Book Value', 'Invested Capital',
       'Working Capital', 'Net Tangible Assets', 'Capital Lease Obligations',
       'Common Stock Equity', 'Total Capitalization',
       'Total Equity Gross Minority Interest', 'Stockholders Equity',
       'Gains Losses Not Affecting Retained Earnings',
       'Other Equity Adjustments', 'Retained Earnings', 'Capital Stock',
       'Common Stock', 'Preferred Stock',
       'Total Liabilities Net Minority Interest',
       'Total Non Current Liabilities Net Minority Interest',
       'Other Non Current Liabilities', 'Tradeand Other Payables Non Current',
       'Non Current Deferred Liabilities', 'Non Current Deferred Revenue',
       'Non Current Deferred Taxes Liabilities',
       'Long Term Debt And Capital Lease Obligation',
       'Long Term Capital Lease Obligation', 'Long Term Debt',
       'Current Liabilities', 'Other Current Liabilities',
       'Current Deferred Liabilities', 'Current Deferred Revenue',
       'Current Debt And Capital Lease Obligation',
       'Current Capital Lease Obligation',
       'Pensionand Other Post Retirement Benefit Plans Current',
       'Payables And Accrued Expenses', 'Current Accrued Expenses', 'Payables',
       'Total Tax Payable', 'Income Tax Payable', 'Accounts Payable',
       'Total Assets', 'Total Non Current Assets', 'Other Non Current Assets',
       'Non Current Deferred Assets', 'Non Current Deferred Taxes Assets',
       'Investments And Advances', 'Investmentin Financial Assets',
       'Available For Sale Securities', 'Goodwill And Other Intangible Assets',
       'Other Intangible Assets', 'Goodwill', 'Net PPE',
       'Accumulated Depreciation', 'Gross PPE', 'Leases',
       'Construction In Progress', 'Other Properties',
       'Machinery Furniture Equipment', 'Buildings And Improvements',
       'Land And Improvements', 'Properties', 'Current Assets',
       'Other Current Assets', 'Inventory', 'Receivables',
       'Accounts Receivable', 'Allowance For Doubtful Accounts Receivable',
       'Gross Accounts Receivable',
       'Cash Cash Equivalents And Short Term Investments',
       'Other Short Term Investments', 'Cash And Cash Equivalents',
       'Cash Equivalents', 'Cash Financial'],
      dtype='object')
2025-04-19 14:31:46,488 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-12-31', '2024-09-30', '2024-06-30', '2024-03-31',
               '2023-12-31', '2023-09-30'],
              dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:46,491 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 75 entries, Treasury Shares Number to Cash Financial
Data columns (total 6 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-12-31 00:00:00  63 non-null     object
 1   2024-09-30 00:00:00  71 non-null     object
 2   2024-06-30 00:00:00  71 non-null     object
 3   2024-03-31 00:00:00  71 non-null     object
 4   2023-12-31 00:00:00  71 non-null     object
 5   2023-09-30 00:00:00  11 non-null     object
dtypes: object(6)
memory usage: 4.1+ KB

2025-04-19 14:31:46,580 - DEBUG - [fetch_financial_statement] Fetching annual cashflow for GOOG
2025-04-19 14:31:46,588 - DEBUG - [fetch_financial_statement] Raw annual cashflow data head for GOOG:
                                2024-12-31     2023-12-31     2022-12-31     2021-12-31 2020-12-31
Free Cash Flow               72764000000.0  69495000000.0  60010000000.0  67012000000.0        NaN
Repurchase Of Capital Stock -62222000000.0 -61504000000.0 -59296000000.0 -50274000000.0        NaN
Repayment Of Debt           -12701000000.0 -11550000000.0 -54068000000.0 -21435000000.0        NaN
Issuance Of Debt             13589000000.0  10790000000.0  52872000000.0  20199000000.0        NaN
Capital Expenditure         -52535000000.0 -32251000000.0 -31485000000.0 -24640000000.0        NaN
2025-04-19 14:31:46,588 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Free Cash Flow', 'Repurchase Of Capital Stock', 'Repayment Of Debt',
       'Issuance Of Debt', 'Capital Expenditure',
       'Income Tax Paid Supplemental Data', 'End Cash Position',
       'Beginning Cash Position', 'Effect Of Exchange Rate Changes',
       'Changes In Cash', 'Financing Cash Flow',
       'Cash Flow From Continuing Financing Activities',
       'Net Other Financing Charges', 'Proceeds From Stock Option Exercised',
       'Cash Dividends Paid', 'Common Stock Dividend Paid',
       'Net Common Stock Issuance', 'Common Stock Payments',
       'Net Issuance Payments Of Debt', 'Net Long Term Debt Issuance',
       'Long Term Debt Payments', 'Long Term Debt Issuance',
       'Investing Cash Flow', 'Cash Flow From Continuing Investing Activities',
       'Net Other Investing Changes', 'Net Investment Purchase And Sale',
       'Sale Of Investment', 'Purchase Of Investment',
       'Net Business Purchase And Sale', 'Purchase Of Business',
       'Net PPE Purchase And Sale', 'Purchase Of PPE', 'Operating Cash Flow',
       'Cash Flow From Continuing Operating Activities',
       'Change In Working Capital', 'Change In Other Working Capital',
       'Change In Other Current Assets',
       'Change In Payables And Accrued Expense', 'Change In Accrued Expense',
       'Change In Payable', 'Change In Account Payable',
       'Change In Receivables', 'Changes In Account Receivables',
       'Other Non Cash Items', 'Stock Based Compensation', 'Deferred Tax',
       'Deferred Income Tax', 'Depreciation Amortization Depletion',
       'Depreciation And Amortization', 'Amortization Cash Flow',
       'Amortization Of Intangibles', 'Depreciation', 'Operating Gains Losses',
       'Gain Loss On Investment Securities',
       'Net Income From Continuing Operations'],
      dtype='object')
2025-04-19 14:31:46,589 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-12-31', '2023-12-31', '2022-12-31', '2021-12-31',
               '2020-12-31'],
              dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:46,591 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 55 entries, Free Cash Flow to Net Income From Continuing Operations
Data columns (total 5 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-12-31 00:00:00  52 non-null     object
 1   2023-12-31 00:00:00  53 non-null     object
 2   2022-12-31 00:00:00  55 non-null     object
 3   2021-12-31 00:00:00  53 non-null     object
 4   2020-12-31 00:00:00  3 non-null      object
dtypes: object(5)
memory usage: 2.6+ KB

2025-04-19 14:31:46,618 - DEBUG - [fetch_financial_statement] Fetching quarterly cashflow for GOOG
2025-04-19 14:31:46,627 - DEBUG - [fetch_financial_statement] Raw quarterly cashflow data head for GOOG:
                                2024-12-31     2024-09-30     2024-06-30     2024-03-31     2023-12-31 2023-09-30
Free Cash Flow               24837000000.0  17637000000.0  13454000000.0  16836000000.0   7896000000.0        NaN
Repurchase Of Capital Stock -15551000000.0 -15291000000.0 -15684000000.0 -15696000000.0 -16191000000.0        NaN
Repayment Of Debt            -3750000000.0  -3449000000.0  -2423000000.0  -3079000000.0  -1929000000.0        NaN
Issuance Of Debt              4895000000.0   3819000000.0   2893000000.0   1982000000.0   1492000000.0        NaN
Capital Expenditure         -14276000000.0 -13061000000.0 -13186000000.0 -12012000000.0 -11019000000.0        NaN
2025-04-19 14:31:46,627 - DEBUG - [fetch_financial_statement] Raw data index: Index(['Free Cash Flow', 'Repurchase Of Capital Stock', 'Repayment Of Debt',
       'Issuance Of Debt', 'Capital Expenditure', 'End Cash Position',
       'Beginning Cash Position', 'Effect Of Exchange Rate Changes',
       'Changes In Cash', 'Financing Cash Flow',
       'Cash Flow From Continuing Financing Activities',
       'Net Other Financing Charges', 'Proceeds From Stock Option Exercised',
       'Cash Dividends Paid', 'Common Stock Dividend Paid',
       'Net Common Stock Issuance', 'Common Stock Payments',
       'Net Issuance Payments Of Debt', 'Net Long Term Debt Issuance',
       'Long Term Debt Payments', 'Long Term Debt Issuance',
       'Investing Cash Flow', 'Cash Flow From Continuing Investing Activities',
       'Net Other Investing Changes', 'Net Investment Purchase And Sale',
       'Sale Of Investment', 'Purchase Of Investment',
       'Net Business Purchase And Sale', 'Purchase Of Business',
       'Net PPE Purchase And Sale', 'Purchase Of PPE', 'Operating Cash Flow',
       'Cash Flow From Continuing Operating Activities',
       'Change In Working Capital', 'Change In Other Working Capital',
       'Change In Other Current Assets',
       'Change In Payables And Accrued Expense', 'Change In Accrued Expense',
       'Change In Payable', 'Change In Account Payable',
       'Change In Receivables', 'Changes In Account Receivables',
       'Other Non Cash Items', 'Stock Based Compensation', 'Deferred Tax',
       'Deferred Income Tax', 'Depreciation Amortization Depletion',
       'Depreciation And Amortization', 'Amortization Cash Flow',
       'Amortization Of Intangibles', 'Depreciation', 'Operating Gains Losses',
       'Gain Loss On Investment Securities',
       'Net Income From Continuing Operations'],
      dtype='object')
2025-04-19 14:31:46,628 - DEBUG - [fetch_financial_statement] Raw data columns: DatetimeIndex(['2024-12-31', '2024-09-30', '2024-06-30', '2024-03-31',
               '2023-12-31', '2023-09-30'],
              dtype='datetime64[ns]', freq=None)
2025-04-19 14:31:46,630 - DEBUG - [fetch_financial_statement] Raw data info:
<class 'pandas.core.frame.DataFrame'>
Index: 54 entries, Free Cash Flow to Net Income From Continuing Operations
Data columns (total 6 columns):
 #   Column               Non-Null Count  Dtype 
---  ------               --------------  ----- 
 0   2024-12-31 00:00:00  52 non-null     object
 1   2024-09-30 00:00:00  52 non-null     object
 2   2024-06-30 00:00:00  50 non-null     object
 3   2024-03-31 00:00:00  50 non-null     object
 4   2023-12-31 00:00:00  50 non-null     object
 5   2023-09-30 00:00:00  4 non-null      object
dtypes: object(6)
memory usage: 3.0+ KB

2025-04-19 14:31:46,657 - DEBUG - [fetch_stock_actions] Fetching actions for GOOG
2025-04-19 14:31:46,657 - DEBUG - [execute_sql] ('SELECT "t1"."key", "t1"."value" FROM "_kv" AS "t1" WHERE ("t1"."key" = ?) LIMIT ? OFFSET ?', ['GOOG', 1, 0])
2025-04-19 14:31:46,658 - DEBUG - [wrapper] Entering history()
2025-04-19 14:31:46,658 - DEBUG - [history] GOOG: Yahoo GET parameters: {'period1': '1926-05-14 15:31:46-04:00', 'period2': '2025-04-19 15:31:46-04:00', 'interval': '1d', 'includePrePost': True, 'events': 'div,splits,capitalGains'}
2025-04-19 14:31:46,658 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:46,658 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:46,658 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/v8/finance/chart/GOOG
2025-04-19 14:31:46,658 - DEBUG - [_make_request] params={'period1': -1376972894, 'period2': 1745091106, 'interval': '1d', 'includePrePost': True, 'events': 'div,splits,capitalGains'}
2025-04-19 14:31:46,659 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:46,659 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:46,659 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:46,659 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:46,659 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:46,659 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:46,659 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:46,820 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /v8/finance/chart/GOOG?period1=-1376972894&period2=1745091106&interval=1d&includePrePost=True&events=div%2Csplits%2CcapitalGains&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:46,962 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:46,963 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:46,963 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:46,987 - DEBUG - [history] GOOG: yfinance received OHLC data: 2004-08-19 13:30:00 -> 2025-04-17 13:30:00
2025-04-19 14:31:46,991 - DEBUG - [history] GOOG: OHLC after cleaning: 2004-08-19 09:30:00-04:00 -> 2025-04-17 09:30:00-04:00
2025-04-19 14:31:47,051 - DEBUG - [history] GOOG: OHLC after combining events: 2004-08-19 00:00:00-04:00 -> 2025-04-17 00:00:00-04:00
2025-04-19 14:31:47,056 - DEBUG - [history] GOOG: yfinance returning OHLC: 2004-08-19 00:00:00-04:00 -> 2025-04-17 00:00:00-04:00
2025-04-19 14:31:47,056 - DEBUG - [wrapper] Exiting history()
2025-04-19 14:31:47,062 - INFO - [load_data_to_table] Loading 1 rows company_profile Ticker GOOG (Mode initial_load)
2025-04-19 14:31:47,069 - DEBUG - [load_data_to_table] Loaded company_profile for GOOG.
2025-04-19 14:31:47,069 - INFO - [load_data_to_table] Loading 1 rows company_key_metrics Ticker GOOG (Mode initial_load)
2025-04-19 14:31:47,076 - DEBUG - [load_data_to_table] Loaded company_key_metrics for GOOG.
2025-04-19 14:31:47,076 - INFO - [load_data_to_table] Loading 5 rows financials_income_annual Ticker GOOG (Mode initial_load)
2025-04-19 14:31:47,077 - WARNING - [load_data_to_table] Cols missing DF->financials_income_annual (GOOG): ['TotalRevenue', 'CostOfRevenue', 'GrossProfit', 'OperatingIncome', 'NetIncome', 'NetIncomeFromContinuingOperations', 'NetIncomeApplicableToCommonShares', 'InterestExpense', 'IncomeBeforeTax', 'IncomeTaxExpense', 'ResearchDevelopment', 'SellingGeneralAdministrative', 'BasicEPS', 'DilutedEPS']. NULL.
2025-04-19 14:31:47,077 - ERROR - [load_data_to_table] Err prep DF financials_income_annual (GOOG): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:47,078 - INFO - [load_data_to_table] Loading 6 rows financials_income_quarterly Ticker GOOG (Mode initial_load)
2025-04-19 14:31:47,079 - WARNING - [load_data_to_table] Cols missing DF->financials_income_quarterly (GOOG): ['TotalRevenue', 'CostOfRevenue', 'GrossProfit', 'OperatingIncome', 'NetIncome', 'NetIncomeFromContinuingOperations', 'NetIncomeApplicableToCommonShares', 'InterestExpense', 'IncomeBeforeTax', 'IncomeTaxExpense', 'ResearchDevelopment', 'SellingGeneralAdministrative', 'BasicEPS', 'DilutedEPS']. NULL.
2025-04-19 14:31:47,079 - ERROR - [load_data_to_table] Err prep DF financials_income_quarterly (GOOG): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:47,079 - INFO - [load_data_to_table] Loading 5 rows financials_balance_annual Ticker GOOG (Mode initial_load)
2025-04-19 14:31:47,080 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_annual (GOOG): ['TotalAssets', 'CurrentAssets', 'TotalLiabilities', 'CurrentLiabilities', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'CommonStockEquity', 'CashAndCashEquivalents', 'AccountsReceivable', 'PropertyPlantEquipmentNet', 'AccountsPayable', 'ShortTermDebt', 'LongTermDebt', 'RetainedEarnings']. NULL.
2025-04-19 14:31:47,080 - ERROR - [load_data_to_table] Err prep DF financials_balance_annual (GOOG): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:47,080 - INFO - [load_data_to_table] Loading 6 rows financials_balance_quarterly Ticker GOOG (Mode initial_load)
2025-04-19 14:31:47,081 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_quarterly (GOOG): ['TotalAssets', 'CurrentAssets', 'TotalLiabilities', 'CurrentLiabilities', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'CommonStockEquity', 'CashAndCashEquivalents', 'AccountsReceivable', 'PropertyPlantEquipmentNet', 'AccountsPayable', 'ShortTermDebt', 'LongTermDebt', 'RetainedEarnings']. NULL.
2025-04-19 14:31:47,081 - ERROR - [load_data_to_table] Err prep DF financials_balance_quarterly (GOOG): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:47,082 - INFO - [load_data_to_table] Loading 5 rows financials_cashflow_annual Ticker GOOG (Mode initial_load)
2025-04-19 14:31:47,082 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_annual (GOOG): ['OperatingCashFlow', 'InvestingCashFlow', 'FinancingCashFlow', 'EndCashPosition', 'FreeCashFlow', 'CapitalExpenditure', 'IssuanceOfDebt', 'RepaymentOfDebt', 'RepurchaseOfCapitalStock', 'DividendPaid']. NULL.
2025-04-19 14:31:47,083 - ERROR - [load_data_to_table] Err prep DF financials_cashflow_annual (GOOG): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:47,083 - INFO - [load_data_to_table] Loading 6 rows financials_cashflow_quarterly Ticker GOOG (Mode initial_load)
2025-04-19 14:31:47,084 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_quarterly (GOOG): ['OperatingCashFlow', 'InvestingCashFlow', 'FinancingCashFlow', 'EndCashPosition', 'FreeCashFlow', 'CapitalExpenditure', 'IssuanceOfDebt', 'RepaymentOfDebt', 'RepurchaseOfCapitalStock', 'DividendPaid']. NULL.
2025-04-19 14:31:47,084 - ERROR - [load_data_to_table] Err prep DF financials_cashflow_quarterly (GOOG): 'DataFrame' object has no attribute 'set_value'
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in load_data_to_table
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 138, in <listcomp>
    if missing_cols: logging.warning(f"Cols missing DF->{table_name} ({ticker}): {missing_cols}. NULL."); [load_df.set_value(col, None) for col in missing_cols]
                                                                                                           ^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'set_value'
2025-04-19 14:31:47,084 - INFO - [load_data_to_table] Loading 7 rows stock_actions Ticker GOOG (Mode initial_load)
2025-04-19 14:31:47,087 - DEBUG - [load_data_to_table] Loaded stock_actions for GOOG.
2025-04-19 14:31:47,087 - WARNING - [run_stock_info_pipeline] Rollback GOOG due to load errors.
2025-04-19 14:31:47,087 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=GOOG, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 14:31:47,694 - DEBUG - [run_stock_info_pipeline] Processing 4/4: Ticker NONEXISTENTTICKER
2025-04-19 14:31:47,695 - DEBUG - [get_raw_json] get_raw_json(): https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER
2025-04-19 14:31:47,696 - DEBUG - [wrapper] Entering get()
2025-04-19 14:31:47,696 - DEBUG - [wrapper]  Entering _make_request()
2025-04-19 14:31:47,696 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER
2025-04-19 14:31:47,696 - DEBUG - [_make_request] params={'modules': 'financialData,quoteType,defaultKeyStatistics,assetProfile,summaryDetail', 'corsDomain': 'finance.yahoo.com', 'formatted': 'false', 'symbol': 'NONEXISTENTTICKER'}
2025-04-19 14:31:47,697 - DEBUG - [wrapper]   Entering _get_cookie_and_crumb()
2025-04-19 14:31:47,697 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:47,697 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:47,697 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:47,697 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:47,697 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:47,698 - DEBUG - [wrapper]   Exiting _get_cookie_and_crumb()
2025-04-19 14:31:47,781 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG HTTP/1.1" 404 123
2025-04-19 14:31:47,782 - DEBUG - [_make_request] response code=404
2025-04-19 14:31:47,783 - DEBUG - [_set_cookie_strategy] toggling cookie strategy basic -> csrf
2025-04-19 14:31:47,783 - DEBUG - [wrapper]   Entering _get_cookie_and_crumb()
2025-04-19 14:31:47,783 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'csrf'
2025-04-19 14:31:47,784 - DEBUG - [wrapper]    Entering _get_crumb_csrf()
2025-04-19 14:31:47,785 - DEBUG - [execute_sql] ('SELECT "t1"."strategy", "t1"."fetch_date", "t1"."cookie_bytes" FROM "_cookieschema" AS "t1" WHERE ("t1"."strategy" = ?) LIMIT ? OFFSET ?', ['csrf', 1, 0])
2025-04-19 14:31:47,791 - DEBUG - [_new_conn] Starting new HTTPS connection (1): guce.yahoo.com:443
2025-04-19 14:31:48,194 - DEBUG - [_make_request] https://guce.yahoo.com:443 "GET /consent HTTP/1.1" 302 0
2025-04-19 14:31:48,205 - DEBUG - [_new_conn] Starting new HTTPS connection (1): www.yahoo.com:443
2025-04-19 14:31:48,854 - DEBUG - [_make_request] https://www.yahoo.com:443 "GET /?guccounter=1 HTTP/1.1" 200 None
2025-04-19 14:31:49,146 - DEBUG - [_get_cookie_csrf] Failed to find "csrfToken" in response
2025-04-19 14:31:49,146 - DEBUG - [wrapper]    Exiting _get_crumb_csrf()
2025-04-19 14:31:49,146 - DEBUG - [_set_cookie_strategy] toggling cookie strategy csrf -> basic
2025-04-19 14:31:49,146 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:49,147 - DEBUG - [execute_sql] ('SELECT "t1"."strategy", "t1"."fetch_date", "t1"."cookie_bytes" FROM "_cookieschema" AS "t1" WHERE ("t1"."strategy" = ?) LIMIT ? OFFSET ?', ['basic', 1, 0])
2025-04-19 14:31:49,147 - DEBUG - [_load_cookie_basic] loaded persistent cookie
2025-04-19 14:31:49,147 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:49,263 - DEBUG - [_make_request] https://query1.finance.yahoo.com:443 "GET /v1/test/getcrumb HTTP/1.1" 200 11
2025-04-19 14:31:49,264 - DEBUG - [_get_crumb_basic] crumb = 'NgZIowMiLwG'
2025-04-19 14:31:49,264 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:49,264 - DEBUG - [wrapper]   Exiting _get_cookie_and_crumb()
2025-04-19 14:31:49,348 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG HTTP/1.1" 404 123
2025-04-19 14:31:49,350 - DEBUG - [_make_request] response code=404
2025-04-19 14:31:49,350 - DEBUG - [wrapper]  Exiting _make_request()
2025-04-19 14:31:49,350 - DEBUG - [wrapper] Exiting get()
2025-04-19 14:31:49,351 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 14:31:49,351 - ERROR - [fetch_company_info] Failed processing .info NONEXISTENTTICKER: AttributeError-'NoneType' object has no attribute 'update'
2025-04-19 14:31:49,351 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=fetch_company_info returned None
2025-04-19 14:31:49,354 - DEBUG - [fetch_financial_statement] Fetching annual financials for NONEXISTENTTICKER
2025-04-19 14:31:49,354 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:49,355 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:49,356 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:49,356 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/NONEXISTENTTICKER?symbol=NONEXISTENTTICKER&type=quarterlyTaxEffectOfUnusualItems,quarterlyTaxRateForCalcs,quarterlyNor...
2025-04-19 14:31:49,356 - DEBUG - [_make_request] params=None
2025-04-19 14:31:49,356 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:49,356 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:49,357 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:49,357 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:49,357 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:49,357 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:49,357 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:49,513 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/NONEXISTENTTICKER?symbol=NONEXISTENTTICKER&type=quarterlyTaxEffectOfUnusualItems,quarterlyTaxRateForCalcs,quarterlyNormalizedEBITDA,quarterlyNormalizedDilutedEPS,quarterlyNormalizedBasicEPS,quarterlyTotalUnusualItems,quarterlyTotalUnusualItemsExcludingGoodwill,quarterlyNetIncomeFromContinuingOperationNetMinorityInterest,quarterlyReconciledDepreciation,quarterlyReconciledCostOfRevenue,quarterlyEBITDA,quarterlyEBIT,quarterlyNetInterestIncome,quarterlyInterestExpense,quarterlyInterestIncome,quarterlyContinuingAndDiscontinuedDilutedEPS,quarterlyContinuingAndDiscontinuedBasicEPS,quarterlyNormalizedIncome,quarterlyNetIncomeFromContinuingAndDiscontinuedOperation,quarterlyTotalExpenses,quarterlyRentExpenseSupplemental,quarterlyReportedNormalizedDilutedEPS,quarterlyReportedNormalizedBasicEPS,quarterlyTotalOperatingIncomeAsReported,quarterlyDividendPerShare,quarterlyDilutedAverageShares,quarterlyBasicAverageShares,quarterlyDilutedEPS,quarterlyDilutedEPSOtherGainsLosses,quarterlyTaxLossCarryforwardDilutedEPS,quarterlyDilutedAccountingChange,quarterlyDilutedExtraordinary,quarterlyDilutedDiscontinuousOperations,quarterlyDilutedContinuousOperations,quarterlyBasicEPS,quarterlyBasicEPSOtherGainsLosses,quarterlyTaxLossCarryforwardBasicEPS,quarterlyBasicAccountingChange,quarterlyBasicExtraordinary,quarterlyBasicDiscontinuousOperations,quarterlyBasicContinuousOperations,quarterlyDilutedNIAvailtoComStockholders,quarterlyAverageDilutionEarnings,quarterlyNetIncomeCommonStockholders,quarterlyOtherunderPreferredStockDividend,quarterlyPreferredStockDividends,quarterlyNetIncome,quarterlyMinorityInterests,quarterlyNetIncomeIncludingNoncontrollingInterests,quarterlyNetIncomeFromTaxLossCarryforward,quarterlyNetIncomeExtraordinary,quarterlyNetIncomeDiscontinuousOperations,quarterlyNetIncomeContinuousOperations,quarterlyEarningsFromEquityInterestNetOfTax,quarterlyTaxProvision,quarterlyPretaxIncome,quarterlyOtherIncomeExpense,quarterlyOtherNonOperatingIncomeExpenses,quarterlySpecialIncomeCharges,quarterlyGainOnSaleOfPPE,quarterlyGainOnSaleOfBusiness,quarterlyOtherSpecialCharges,quarterlyWriteOff,quarterlyImpairmentOfCapitalAssets,quarterlyRestructuringAndMergernAcquisition,quarterlySecuritiesAmortization,quarterlyEarningsFromEquityInterest,quarterlyGainOnSaleOfSecurity,quarterlyNetNonOperatingInterestIncomeExpense,quarterlyTotalOtherFinanceCost,quarterlyInterestExpenseNonOperating,quarterlyInterestIncomeNonOperating,quarterlyOperatingIncome,quarterlyOperatingExpense,quarterlyOtherOperatingExpenses,quarterlyOtherTaxes,quarterlyProvisionForDoubtfulAccounts,quarterlyDepreciationAmortizationDepletionIncomeStatement,quarterlyDepletionIncomeStatement,quarterlyDepreciationAndAmortizationInIncomeStatement,quarterlyAmortization,quarterlyAmortizationOfIntangiblesIncomeStatement,quarterlyDepreciationIncomeStatement,quarterlyResearchAndDevelopment,quarterlySellingGeneralAndAdministration,quarterlySellingAndMarketingExpense,quarterlyGeneralAndAdministrativeExpense,quarterlyOtherGandA,quarterlyInsuranceAndClaims,quarterlyRentAndLandingFees,quarterlySalariesAndWages,quarterlyGrossProfit,quarterlyCostOfRevenue,quarterlyTotalRevenue,quarterlyExciseTaxes,quarterlyOperatingRevenue,quarterlyLossAdjustmentExpense,quarterlyNetPolicyholderBenefitsAndClaims,quarterlyPolicyholderBenefitsGross,quarterlyPolicyholderBenefitsCeded,quarterlyOccupancyAndEquipment,quarterlyProfessionalExpenseAndContractServicesExpense,quarterlyOtherNonInterestExpense&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:49,514 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:49,514 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:49,514 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:49,517 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:49,517 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:49,517 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:49,517 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:49,517 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/NONEXISTENTTICKER?symbol=NONEXISTENTTICKER&type=annualTaxEffectOfUnusualItems,annualTaxRateForCalcs,annualNormalizedEB...
2025-04-19 14:31:49,518 - DEBUG - [_make_request] params=None
2025-04-19 14:31:49,518 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:49,518 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:49,518 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:49,518 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:49,518 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:49,519 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:49,519 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:49,698 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/NONEXISTENTTICKER?symbol=NONEXISTENTTICKER&type=annualTaxEffectOfUnusualItems,annualTaxRateForCalcs,annualNormalizedEBITDA,annualNormalizedDilutedEPS,annualNormalizedBasicEPS,annualTotalUnusualItems,annualTotalUnusualItemsExcludingGoodwill,annualNetIncomeFromContinuingOperationNetMinorityInterest,annualReconciledDepreciation,annualReconciledCostOfRevenue,annualEBITDA,annualEBIT,annualNetInterestIncome,annualInterestExpense,annualInterestIncome,annualContinuingAndDiscontinuedDilutedEPS,annualContinuingAndDiscontinuedBasicEPS,annualNormalizedIncome,annualNetIncomeFromContinuingAndDiscontinuedOperation,annualTotalExpenses,annualRentExpenseSupplemental,annualReportedNormalizedDilutedEPS,annualReportedNormalizedBasicEPS,annualTotalOperatingIncomeAsReported,annualDividendPerShare,annualDilutedAverageShares,annualBasicAverageShares,annualDilutedEPS,annualDilutedEPSOtherGainsLosses,annualTaxLossCarryforwardDilutedEPS,annualDilutedAccountingChange,annualDilutedExtraordinary,annualDilutedDiscontinuousOperations,annualDilutedContinuousOperations,annualBasicEPS,annualBasicEPSOtherGainsLosses,annualTaxLossCarryforwardBasicEPS,annualBasicAccountingChange,annualBasicExtraordinary,annualBasicDiscontinuousOperations,annualBasicContinuousOperations,annualDilutedNIAvailtoComStockholders,annualAverageDilutionEarnings,annualNetIncomeCommonStockholders,annualOtherunderPreferredStockDividend,annualPreferredStockDividends,annualNetIncome,annualMinorityInterests,annualNetIncomeIncludingNoncontrollingInterests,annualNetIncomeFromTaxLossCarryforward,annualNetIncomeExtraordinary,annualNetIncomeDiscontinuousOperations,annualNetIncomeContinuousOperations,annualEarningsFromEquityInterestNetOfTax,annualTaxProvision,annualPretaxIncome,annualOtherIncomeExpense,annualOtherNonOperatingIncomeExpenses,annualSpecialIncomeCharges,annualGainOnSaleOfPPE,annualGainOnSaleOfBusiness,annualOtherSpecialCharges,annualWriteOff,annualImpairmentOfCapitalAssets,annualRestructuringAndMergernAcquisition,annualSecuritiesAmortization,annualEarningsFromEquityInterest,annualGainOnSaleOfSecurity,annualNetNonOperatingInterestIncomeExpense,annualTotalOtherFinanceCost,annualInterestExpenseNonOperating,annualInterestIncomeNonOperating,annualOperatingIncome,annualOperatingExpense,annualOtherOperatingExpenses,annualOtherTaxes,annualProvisionForDoubtfulAccounts,annualDepreciationAmortizationDepletionIncomeStatement,annualDepletionIncomeStatement,annualDepreciationAndAmortizationInIncomeStatement,annualAmortization,annualAmortizationOfIntangiblesIncomeStatement,annualDepreciationIncomeStatement,annualResearchAndDevelopment,annualSellingGeneralAndAdministration,annualSellingAndMarketingExpense,annualGeneralAndAdministrativeExpense,annualOtherGandA,annualInsuranceAndClaims,annualRentAndLandingFees,annualSalariesAndWages,annualGrossProfit,annualCostOfRevenue,annualTotalRevenue,annualExciseTaxes,annualOperatingRevenue,annualLossAdjustmentExpense,annualNetPolicyholderBenefitsAndClaims,annualPolicyholderBenefitsGross,annualPolicyholderBenefitsCeded,annualOccupancyAndEquipment,annualProfessionalExpenseAndContractServicesExpense,annualOtherNonInterestExpense&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:49,701 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:49,701 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:49,701 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:49,708 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:49,708 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:49,709 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:49,709 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:49,709 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/NONEXISTENTTICKER?symbol=NONEXISTENTTICKER&type=quarterlyTreasurySharesNumber,quarterlyPreferredSharesNumber,quarterly...
2025-04-19 14:31:49,710 - DEBUG - [_make_request] params=None
2025-04-19 14:31:49,710 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:49,710 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:49,710 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:49,710 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:49,710 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:49,710 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:49,711 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:49,929 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/NONEXISTENTTICKER?symbol=NONEXISTENTTICKER&type=quarterlyTreasurySharesNumber,quarterlyPreferredSharesNumber,quarterlyOrdinarySharesNumber,quarterlyShareIssued,quarterlyNetDebt,quarterlyTotalDebt,quarterlyTangibleBookValue,quarterlyInvestedCapital,quarterlyWorkingCapital,quarterlyNetTangibleAssets,quarterlyCapitalLeaseObligations,quarterlyCommonStockEquity,quarterlyPreferredStockEquity,quarterlyTotalCapitalization,quarterlyTotalEquityGrossMinorityInterest,quarterlyMinorityInterest,quarterlyStockholdersEquity,quarterlyOtherEquityInterest,quarterlyGainsLossesNotAffectingRetainedEarnings,quarterlyOtherEquityAdjustments,quarterlyFixedAssetsRevaluationReserve,quarterlyForeignCurrencyTranslationAdjustments,quarterlyMinimumPensionLiabilities,quarterlyUnrealizedGainLoss,quarterlyTreasuryStock,quarterlyRetainedEarnings,quarterlyAdditionalPaidInCapital,quarterlyCapitalStock,quarterlyOtherCapitalStock,quarterlyCommonStock,quarterlyPreferredStock,quarterlyTotalPartnershipCapital,quarterlyGeneralPartnershipCapital,quarterlyLimitedPartnershipCapital,quarterlyTotalLiabilitiesNetMinorityInterest,quarterlyTotalNonCurrentLiabilitiesNetMinorityInterest,quarterlyOtherNonCurrentLiabilities,quarterlyLiabilitiesHeldforSaleNonCurrent,quarterlyRestrictedCommonStock,quarterlyPreferredSecuritiesOutsideStockEquity,quarterlyDerivativeProductLiabilities,quarterlyEmployeeBenefits,quarterlyNonCurrentPensionAndOtherPostretirementBenefitPlans,quarterlyNonCurrentAccruedExpenses,quarterlyDuetoRelatedPartiesNonCurrent,quarterlyTradeandOtherPayablesNonCurrent,quarterlyNonCurrentDeferredLiabilities,quarterlyNonCurrentDeferredRevenue,quarterlyNonCurrentDeferredTaxesLiabilities,quarterlyLongTermDebtAndCapitalLeaseObligation,quarterlyLongTermCapitalLeaseObligation,quarterlyLongTermDebt,quarterlyLongTermProvisions,quarterlyCurrentLiabilities,quarterlyOtherCurrentLiabilities,quarterlyCurrentDeferredLiabilities,quarterlyCurrentDeferredRevenue,quarterlyCurrentDeferredTaxesLiabilities,quarterlyCurrentDebtAndCapitalLeaseObligation,quarterlyCurrentCapitalLeaseObligation,quarterlyCurrentDebt,quarterlyOtherCurrentBorrowings,quarterlyLineOfCredit,quarterlyCommercialPaper,quarterlyCurrentNotesPayable,quarterlyPensionandOtherPostRetirementBenefitPlansCurrent,quarterlyCurrentProvisions,quarterlyPayablesAndAccruedExpenses,quarterlyCurrentAccruedExpenses,quarterlyInterestPayable,quarterlyPayables,quarterlyOtherPayable,quarterlyDuetoRelatedPartiesCurrent,quarterlyDividendsPayable,quarterlyTotalTaxPayable,quarterlyIncomeTaxPayable,quarterlyAccountsPayable,quarterlyTotalAssets,quarterlyTotalNonCurrentAssets,quarterlyOtherNonCurrentAssets,quarterlyDefinedPensionBenefit,quarterlyNonCurrentPrepaidAssets,quarterlyNonCurrentDeferredAssets,quarterlyNonCurrentDeferredTaxesAssets,quarterlyDuefromRelatedPartiesNonCurrent,quarterlyNonCurrentNoteReceivables,quarterlyNonCurrentAccountsReceivable,quarterlyFinancialAssets,quarterlyInvestmentsAndAdvances,quarterlyOtherInvestments,quarterlyInvestmentinFinancialAssets,quarterlyHeldToMaturitySecurities,quarterlyAvailableForSaleSecurities,quarterlyFinancialAssetsDesignatedasFairValueThroughProfitorLossTotal,quarterlyTradingSecurities,quarterlyLongTermEquityInvestment,quarterlyInvestmentsinJointVenturesatCost,quarterlyInvestmentsInOtherVenturesUnderEquityMethod,quarterlyInvestmentsinAssociatesatCost,quarterlyInvestmentsinSubsidiariesatCost,quarterlyInvestmentProperties,quarterlyGoodwillAndOtherIntangibleAssets,quarterlyOtherIntangibleAssets,quarterlyGoodwill,quarterlyNetPPE,quarterlyAccumulatedDepreciation,quarterlyGrossPPE,quarterlyLeases,quarterlyConstructionInProgress,quarterlyOtherProperties,quarterlyMachineryFurnitureEquipment,quarterlyBuildingsAndImprovements,quarterlyLandAndImprovements,quarterlyProperties,quarterlyCurrentAssets,quarterlyOtherCurrentAssets,quarterlyHedgingAssetsCurrent,quarterlyAssetsHeldForSaleCurrent,quarterlyCurrentDeferredAssets,quarterlyCurrentDeferredTaxesAssets,quarterlyRestrictedCash,quarterlyPrepaidAssets,quarterlyInventory,quarterlyInventoriesAdjustmentsAllowances,quarterlyOtherInventories,quarterlyFinishedGoods,quarterlyWorkInProcess,quarterlyRawMaterials,quarterlyReceivables,quarterlyReceivablesAdjustmentsAllowances,quarterlyOtherReceivables,quarterlyDuefromRelatedPartiesCurrent,quarterlyTaxesReceivable,quarterlyAccruedInterestReceivable,quarterlyNotesReceivable,quarterlyLoansReceivable,quarterlyAccountsReceivable,quarterlyAllowanceForDoubtfulAccountsReceivable,quarterlyGrossAccountsReceivable,quarterlyCashCashEquivalentsAndShortTermInvestments,quarterlyOtherShortTermInvestments,quarterlyCashAndCashEquivalents,quarterlyCashEquivalents,quarterlyCashFinancial,quarterlyCashCashEquivalentsAndFederalFundsSold&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:49,930 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:49,931 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:49,931 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:49,934 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:49,934 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:49,935 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:49,935 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:49,935 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/NONEXISTENTTICKER?symbol=NONEXISTENTTICKER&type=annualTreasurySharesNumber,annualPreferredSharesNumber,annualOrdinaryS...
2025-04-19 14:31:49,936 - DEBUG - [_make_request] params=None
2025-04-19 14:31:49,936 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:49,936 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:49,936 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:49,936 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:49,937 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:49,937 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:49,937 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:50,157 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/NONEXISTENTTICKER?symbol=NONEXISTENTTICKER&type=annualTreasurySharesNumber,annualPreferredSharesNumber,annualOrdinarySharesNumber,annualShareIssued,annualNetDebt,annualTotalDebt,annualTangibleBookValue,annualInvestedCapital,annualWorkingCapital,annualNetTangibleAssets,annualCapitalLeaseObligations,annualCommonStockEquity,annualPreferredStockEquity,annualTotalCapitalization,annualTotalEquityGrossMinorityInterest,annualMinorityInterest,annualStockholdersEquity,annualOtherEquityInterest,annualGainsLossesNotAffectingRetainedEarnings,annualOtherEquityAdjustments,annualFixedAssetsRevaluationReserve,annualForeignCurrencyTranslationAdjustments,annualMinimumPensionLiabilities,annualUnrealizedGainLoss,annualTreasuryStock,annualRetainedEarnings,annualAdditionalPaidInCapital,annualCapitalStock,annualOtherCapitalStock,annualCommonStock,annualPreferredStock,annualTotalPartnershipCapital,annualGeneralPartnershipCapital,annualLimitedPartnershipCapital,annualTotalLiabilitiesNetMinorityInterest,annualTotalNonCurrentLiabilitiesNetMinorityInterest,annualOtherNonCurrentLiabilities,annualLiabilitiesHeldforSaleNonCurrent,annualRestrictedCommonStock,annualPreferredSecuritiesOutsideStockEquity,annualDerivativeProductLiabilities,annualEmployeeBenefits,annualNonCurrentPensionAndOtherPostretirementBenefitPlans,annualNonCurrentAccruedExpenses,annualDuetoRelatedPartiesNonCurrent,annualTradeandOtherPayablesNonCurrent,annualNonCurrentDeferredLiabilities,annualNonCurrentDeferredRevenue,annualNonCurrentDeferredTaxesLiabilities,annualLongTermDebtAndCapitalLeaseObligation,annualLongTermCapitalLeaseObligation,annualLongTermDebt,annualLongTermProvisions,annualCurrentLiabilities,annualOtherCurrentLiabilities,annualCurrentDeferredLiabilities,annualCurrentDeferredRevenue,annualCurrentDeferredTaxesLiabilities,annualCurrentDebtAndCapitalLeaseObligation,annualCurrentCapitalLeaseObligation,annualCurrentDebt,annualOtherCurrentBorrowings,annualLineOfCredit,annualCommercialPaper,annualCurrentNotesPayable,annualPensionandOtherPostRetirementBenefitPlansCurrent,annualCurrentProvisions,annualPayablesAndAccruedExpenses,annualCurrentAccruedExpenses,annualInterestPayable,annualPayables,annualOtherPayable,annualDuetoRelatedPartiesCurrent,annualDividendsPayable,annualTotalTaxPayable,annualIncomeTaxPayable,annualAccountsPayable,annualTotalAssets,annualTotalNonCurrentAssets,annualOtherNonCurrentAssets,annualDefinedPensionBenefit,annualNonCurrentPrepaidAssets,annualNonCurrentDeferredAssets,annualNonCurrentDeferredTaxesAssets,annualDuefromRelatedPartiesNonCurrent,annualNonCurrentNoteReceivables,annualNonCurrentAccountsReceivable,annualFinancialAssets,annualInvestmentsAndAdvances,annualOtherInvestments,annualInvestmentinFinancialAssets,annualHeldToMaturitySecurities,annualAvailableForSaleSecurities,annualFinancialAssetsDesignatedasFairValueThroughProfitorLossTotal,annualTradingSecurities,annualLongTermEquityInvestment,annualInvestmentsinJointVenturesatCost,annualInvestmentsInOtherVenturesUnderEquityMethod,annualInvestmentsinAssociatesatCost,annualInvestmentsinSubsidiariesatCost,annualInvestmentProperties,annualGoodwillAndOtherIntangibleAssets,annualOtherIntangibleAssets,annualGoodwill,annualNetPPE,annualAccumulatedDepreciation,annualGrossPPE,annualLeases,annualConstructionInProgress,annualOtherProperties,annualMachineryFurnitureEquipment,annualBuildingsAndImprovements,annualLandAndImprovements,annualProperties,annualCurrentAssets,annualOtherCurrentAssets,annualHedgingAssetsCurrent,annualAssetsHeldForSaleCurrent,annualCurrentDeferredAssets,annualCurrentDeferredTaxesAssets,annualRestrictedCash,annualPrepaidAssets,annualInventory,annualInventoriesAdjustmentsAllowances,annualOtherInventories,annualFinishedGoods,annualWorkInProcess,annualRawMaterials,annualReceivables,annualReceivablesAdjustmentsAllowances,annualOtherReceivables,annualDuefromRelatedPartiesCurrent,annualTaxesReceivable,annualAccruedInterestReceivable,annualNotesReceivable,annualLoansReceivable,annualAccountsReceivable,annualAllowanceForDoubtfulAccountsReceivable,annualGrossAccountsReceivable,annualCashCashEquivalentsAndShortTermInvestments,annualOtherShortTermInvestments,annualCashAndCashEquivalents,annualCashEquivalents,annualCashFinancial,annualCashCashEquivalentsAndFederalFundsSold&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:50,159 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:50,160 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:50,160 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:50,165 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:50,165 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:50,166 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:50,166 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:50,166 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/NONEXISTENTTICKER?symbol=NONEXISTENTTICKER&type=quarterlyForeignSales,quarterlyDomesticSales,quarterlyAdjustedGeograph...
2025-04-19 14:31:50,166 - DEBUG - [_make_request] params=None
2025-04-19 14:31:50,167 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:50,167 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:50,167 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:50,167 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:50,168 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:50,168 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:50,168 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:50,389 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/NONEXISTENTTICKER?symbol=NONEXISTENTTICKER&type=quarterlyForeignSales,quarterlyDomesticSales,quarterlyAdjustedGeographySegmentData,quarterlyFreeCashFlow,quarterlyRepurchaseOfCapitalStock,quarterlyRepaymentOfDebt,quarterlyIssuanceOfDebt,quarterlyIssuanceOfCapitalStock,quarterlyCapitalExpenditure,quarterlyInterestPaidSupplementalData,quarterlyIncomeTaxPaidSupplementalData,quarterlyEndCashPosition,quarterlyOtherCashAdjustmentOutsideChangeinCash,quarterlyBeginningCashPosition,quarterlyEffectOfExchangeRateChanges,quarterlyChangesInCash,quarterlyOtherCashAdjustmentInsideChangeinCash,quarterlyCashFlowFromDiscontinuedOperation,quarterlyFinancingCashFlow,quarterlyCashFromDiscontinuedFinancingActivities,quarterlyCashFlowFromContinuingFinancingActivities,quarterlyNetOtherFinancingCharges,quarterlyInterestPaidCFF,quarterlyProceedsFromStockOptionExercised,quarterlyCashDividendsPaid,quarterlyPreferredStockDividendPaid,quarterlyCommonStockDividendPaid,quarterlyNetPreferredStockIssuance,quarterlyPreferredStockPayments,quarterlyPreferredStockIssuance,quarterlyNetCommonStockIssuance,quarterlyCommonStockPayments,quarterlyCommonStockIssuance,quarterlyNetIssuancePaymentsOfDebt,quarterlyNetShortTermDebtIssuance,quarterlyShortTermDebtPayments,quarterlyShortTermDebtIssuance,quarterlyNetLongTermDebtIssuance,quarterlyLongTermDebtPayments,quarterlyLongTermDebtIssuance,quarterlyInvestingCashFlow,quarterlyCashFromDiscontinuedInvestingActivities,quarterlyCashFlowFromContinuingInvestingActivities,quarterlyNetOtherInvestingChanges,quarterlyInterestReceivedCFI,quarterlyDividendsReceivedCFI,quarterlyNetInvestmentPurchaseAndSale,quarterlySaleOfInvestment,quarterlyPurchaseOfInvestment,quarterlyNetInvestmentPropertiesPurchaseAndSale,quarterlySaleOfInvestmentProperties,quarterlyPurchaseOfInvestmentProperties,quarterlyNetBusinessPurchaseAndSale,quarterlySaleOfBusiness,quarterlyPurchaseOfBusiness,quarterlyNetIntangiblesPurchaseAndSale,quarterlySaleOfIntangibles,quarterlyPurchaseOfIntangibles,quarterlyNetPPEPurchaseAndSale,quarterlySaleOfPPE,quarterlyPurchaseOfPPE,quarterlyCapitalExpenditureReported,quarterlyOperatingCashFlow,quarterlyCashFromDiscontinuedOperatingActivities,quarterlyCashFlowFromContinuingOperatingActivities,quarterlyTaxesRefundPaid,quarterlyInterestReceivedCFO,quarterlyInterestPaidCFO,quarterlyDividendReceivedCFO,quarterlyDividendPaidCFO,quarterlyChangeInWorkingCapital,quarterlyChangeInOtherWorkingCapital,quarterlyChangeInOtherCurrentLiabilities,quarterlyChangeInOtherCurrentAssets,quarterlyChangeInPayablesAndAccruedExpense,quarterlyChangeInAccruedExpense,quarterlyChangeInInterestPayable,quarterlyChangeInPayable,quarterlyChangeInDividendPayable,quarterlyChangeInAccountPayable,quarterlyChangeInTaxPayable,quarterlyChangeInIncomeTaxPayable,quarterlyChangeInPrepaidAssets,quarterlyChangeInInventory,quarterlyChangeInReceivables,quarterlyChangesInAccountReceivables,quarterlyOtherNonCashItems,quarterlyExcessTaxBenefitFromStockBasedCompensation,quarterlyStockBasedCompensation,quarterlyUnrealizedGainLossOnInvestmentSecurities,quarterlyProvisionandWriteOffofAssets,quarterlyAssetImpairmentCharge,quarterlyAmortizationOfSecurities,quarterlyDeferredTax,quarterlyDeferredIncomeTax,quarterlyDepreciationAmortizationDepletion,quarterlyDepletion,quarterlyDepreciationAndAmortization,quarterlyAmortizationCashFlow,quarterlyAmortizationOfIntangibles,quarterlyDepreciation,quarterlyOperatingGainsLosses,quarterlyPensionAndEmployeeBenefitExpense,quarterlyEarningsLossesFromEquityInvestments,quarterlyGainLossOnInvestmentSecurities,quarterlyNetForeignCurrencyExchangeGainLoss,quarterlyGainLossOnSaleOfPPE,quarterlyGainLossOnSaleOfBusiness,quarterlyNetIncomeFromContinuingOperations,quarterlyCashFlowsfromusedinOperatingActivitiesDirect,quarterlyTaxesRefundPaidDirect,quarterlyInterestReceivedDirect,quarterlyInterestPaidDirect,quarterlyDividendsReceivedDirect,quarterlyDividendsPaidDirect,quarterlyClassesofCashPayments,quarterlyOtherCashPaymentsfromOperatingActivities,quarterlyPaymentsonBehalfofEmployees,quarterlyPaymentstoSuppliersforGoodsandServices,quarterlyClassesofCashReceiptsfromOperatingActivities,quarterlyOtherCashReceiptsfromOperatingActivities,quarterlyReceiptsfromGovernmentGrants,quarterlyReceiptsfromCustomers&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:50,392 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:50,392 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:50,392 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:50,398 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:50,398 - DEBUG - [wrapper] Entering _fetch_time_series()
2025-04-19 14:31:50,399 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:50,399 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:50,399 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/ws/fundamentals-timeseries/v1/finance/timeseries/NONEXISTENTTICKER?symbol=NONEXISTENTTICKER&type=annualForeignSales,annualDomesticSales,annualAdjustedGeographySegmentD...
2025-04-19 14:31:50,399 - DEBUG - [_make_request] params=None
2025-04-19 14:31:50,400 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:50,400 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:50,400 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:50,400 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:50,400 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:50,400 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:50,400 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:50,610 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /ws/fundamentals-timeseries/v1/finance/timeseries/NONEXISTENTTICKER?symbol=NONEXISTENTTICKER&type=annualForeignSales,annualDomesticSales,annualAdjustedGeographySegmentData,annualFreeCashFlow,annualRepurchaseOfCapitalStock,annualRepaymentOfDebt,annualIssuanceOfDebt,annualIssuanceOfCapitalStock,annualCapitalExpenditure,annualInterestPaidSupplementalData,annualIncomeTaxPaidSupplementalData,annualEndCashPosition,annualOtherCashAdjustmentOutsideChangeinCash,annualBeginningCashPosition,annualEffectOfExchangeRateChanges,annualChangesInCash,annualOtherCashAdjustmentInsideChangeinCash,annualCashFlowFromDiscontinuedOperation,annualFinancingCashFlow,annualCashFromDiscontinuedFinancingActivities,annualCashFlowFromContinuingFinancingActivities,annualNetOtherFinancingCharges,annualInterestPaidCFF,annualProceedsFromStockOptionExercised,annualCashDividendsPaid,annualPreferredStockDividendPaid,annualCommonStockDividendPaid,annualNetPreferredStockIssuance,annualPreferredStockPayments,annualPreferredStockIssuance,annualNetCommonStockIssuance,annualCommonStockPayments,annualCommonStockIssuance,annualNetIssuancePaymentsOfDebt,annualNetShortTermDebtIssuance,annualShortTermDebtPayments,annualShortTermDebtIssuance,annualNetLongTermDebtIssuance,annualLongTermDebtPayments,annualLongTermDebtIssuance,annualInvestingCashFlow,annualCashFromDiscontinuedInvestingActivities,annualCashFlowFromContinuingInvestingActivities,annualNetOtherInvestingChanges,annualInterestReceivedCFI,annualDividendsReceivedCFI,annualNetInvestmentPurchaseAndSale,annualSaleOfInvestment,annualPurchaseOfInvestment,annualNetInvestmentPropertiesPurchaseAndSale,annualSaleOfInvestmentProperties,annualPurchaseOfInvestmentProperties,annualNetBusinessPurchaseAndSale,annualSaleOfBusiness,annualPurchaseOfBusiness,annualNetIntangiblesPurchaseAndSale,annualSaleOfIntangibles,annualPurchaseOfIntangibles,annualNetPPEPurchaseAndSale,annualSaleOfPPE,annualPurchaseOfPPE,annualCapitalExpenditureReported,annualOperatingCashFlow,annualCashFromDiscontinuedOperatingActivities,annualCashFlowFromContinuingOperatingActivities,annualTaxesRefundPaid,annualInterestReceivedCFO,annualInterestPaidCFO,annualDividendReceivedCFO,annualDividendPaidCFO,annualChangeInWorkingCapital,annualChangeInOtherWorkingCapital,annualChangeInOtherCurrentLiabilities,annualChangeInOtherCurrentAssets,annualChangeInPayablesAndAccruedExpense,annualChangeInAccruedExpense,annualChangeInInterestPayable,annualChangeInPayable,annualChangeInDividendPayable,annualChangeInAccountPayable,annualChangeInTaxPayable,annualChangeInIncomeTaxPayable,annualChangeInPrepaidAssets,annualChangeInInventory,annualChangeInReceivables,annualChangesInAccountReceivables,annualOtherNonCashItems,annualExcessTaxBenefitFromStockBasedCompensation,annualStockBasedCompensation,annualUnrealizedGainLossOnInvestmentSecurities,annualProvisionandWriteOffofAssets,annualAssetImpairmentCharge,annualAmortizationOfSecurities,annualDeferredTax,annualDeferredIncomeTax,annualDepreciationAmortizationDepletion,annualDepletion,annualDepreciationAndAmortization,annualAmortizationCashFlow,annualAmortizationOfIntangibles,annualDepreciation,annualOperatingGainsLosses,annualPensionAndEmployeeBenefitExpense,annualEarningsLossesFromEquityInvestments,annualGainLossOnInvestmentSecurities,annualNetForeignCurrencyExchangeGainLoss,annualGainLossOnSaleOfPPE,annualGainLossOnSaleOfBusiness,annualNetIncomeFromContinuingOperations,annualCashFlowsfromusedinOperatingActivitiesDirect,annualTaxesRefundPaidDirect,annualInterestReceivedDirect,annualInterestPaidDirect,annualDividendsReceivedDirect,annualDividendsPaidDirect,annualClassesofCashPayments,annualOtherCashPaymentsfromOperatingActivities,annualPaymentsonBehalfofEmployees,annualPaymentstoSuppliersforGoodsandServices,annualClassesofCashReceiptsfromOperatingActivities,annualOtherCashReceiptsfromOperatingActivities,annualReceiptsfromGovernmentGrants,annualReceiptsfromCustomers&period1=1483164000&period2=1745107200&crumb=NgZIowMiLwG HTTP/1.1" 200 None
2025-04-19 14:31:50,612 - DEBUG - [_make_request] response code=200
2025-04-19 14:31:50,612 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:50,612 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:50,618 - DEBUG - [wrapper] Exiting _fetch_time_series()
2025-04-19 14:31:50,619 - INFO - [fetch_financial_statement] No annual financials data found for NONEXISTENTTICKER.
2025-04-19 14:31:50,619 - DEBUG - [fetch_financial_statement] Fetching quarterly financials for NONEXISTENTTICKER
2025-04-19 14:31:50,620 - INFO - [fetch_financial_statement] No quarterly financials data found for NONEXISTENTTICKER.
2025-04-19 14:31:50,620 - DEBUG - [fetch_financial_statement] Fetching annual balance_sheet for NONEXISTENTTICKER
2025-04-19 14:31:50,622 - INFO - [fetch_financial_statement] No annual balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 14:31:50,622 - DEBUG - [fetch_financial_statement] Fetching quarterly balance_sheet for NONEXISTENTTICKER
2025-04-19 14:31:50,623 - INFO - [fetch_financial_statement] No quarterly balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 14:31:50,624 - DEBUG - [fetch_financial_statement] Fetching annual cashflow for NONEXISTENTTICKER
2025-04-19 14:31:50,625 - INFO - [fetch_financial_statement] No annual cashflow data found for NONEXISTENTTICKER.
2025-04-19 14:31:50,625 - DEBUG - [fetch_financial_statement] Fetching quarterly cashflow for NONEXISTENTTICKER
2025-04-19 14:31:50,627 - INFO - [fetch_financial_statement] No quarterly cashflow data found for NONEXISTENTTICKER.
2025-04-19 14:31:50,627 - DEBUG - [fetch_stock_actions] Fetching actions for NONEXISTENTTICKER
2025-04-19 14:31:50,628 - DEBUG - [execute_sql] ('SELECT "t1"."key", "t1"."value" FROM "_kv" AS "t1" WHERE ("t1"."key" = ?) LIMIT ? OFFSET ?', ['NONEXISTENTTICKER', 1, 0])
2025-04-19 14:31:50,630 - DEBUG - [wrapper] Entering _fetch_ticker_tz()
2025-04-19 14:31:50,631 - DEBUG - [wrapper]  Entering get()
2025-04-19 14:31:50,631 - DEBUG - [wrapper]   Entering _make_request()
2025-04-19 14:31:50,631 - DEBUG - [_make_request] url=https://query2.finance.yahoo.com/v8/finance/chart/NONEXISTENTTICKER
2025-04-19 14:31:50,632 - DEBUG - [_make_request] params=frozendict.frozendict({'range': '1d', 'interval': '1d'})
2025-04-19 14:31:50,632 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:50,632 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'basic'
2025-04-19 14:31:50,632 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:50,632 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:50,632 - DEBUG - [_get_crumb_basic] reusing crumb
2025-04-19 14:31:50,632 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:50,633 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:50,794 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /v8/finance/chart/NONEXISTENTTICKER?range=1d&interval=1d&crumb=NgZIowMiLwG HTTP/1.1" 404 108
2025-04-19 14:31:50,795 - DEBUG - [_make_request] response code=404
2025-04-19 14:31:50,795 - DEBUG - [_set_cookie_strategy] toggling cookie strategy basic -> csrf
2025-04-19 14:31:50,795 - DEBUG - [wrapper]    Entering _get_cookie_and_crumb()
2025-04-19 14:31:50,795 - DEBUG - [_get_cookie_and_crumb] cookie_mode = 'csrf'
2025-04-19 14:31:50,795 - DEBUG - [wrapper]     Entering _get_crumb_csrf()
2025-04-19 14:31:50,796 - DEBUG - [execute_sql] ('SELECT "t1"."strategy", "t1"."fetch_date", "t1"."cookie_bytes" FROM "_cookieschema" AS "t1" WHERE ("t1"."strategy" = ?) LIMIT ? OFFSET ?', ['csrf', 1, 0])
2025-04-19 14:31:50,935 - DEBUG - [_make_request] https://guce.yahoo.com:443 "GET /consent HTTP/1.1" 302 0
2025-04-19 14:31:51,257 - DEBUG - [_make_request] https://www.yahoo.com:443 "GET /?guccounter=1 HTTP/1.1" 200 None
2025-04-19 14:31:51,476 - DEBUG - [_get_cookie_csrf] Failed to find "csrfToken" in response
2025-04-19 14:31:51,478 - DEBUG - [wrapper]     Exiting _get_crumb_csrf()
2025-04-19 14:31:51,478 - DEBUG - [_set_cookie_strategy] toggling cookie strategy csrf -> basic
2025-04-19 14:31:51,478 - DEBUG - [wrapper]     Entering _get_cookie_and_crumb_basic()
2025-04-19 14:31:51,479 - DEBUG - [execute_sql] ('SELECT "t1"."strategy", "t1"."fetch_date", "t1"."cookie_bytes" FROM "_cookieschema" AS "t1" WHERE ("t1"."strategy" = ?) LIMIT ? OFFSET ?', ['basic', 1, 0])
2025-04-19 14:31:51,480 - DEBUG - [_load_cookie_basic] loaded persistent cookie
2025-04-19 14:31:51,480 - DEBUG - [_get_cookie_basic] reusing cookie
2025-04-19 14:31:51,562 - DEBUG - [_make_request] https://query1.finance.yahoo.com:443 "GET /v1/test/getcrumb HTTP/1.1" 200 11
2025-04-19 14:31:51,564 - DEBUG - [_get_crumb_basic] crumb = 'NgZIowMiLwG'
2025-04-19 14:31:51,564 - DEBUG - [wrapper]     Exiting _get_cookie_and_crumb_basic()
2025-04-19 14:31:51,564 - DEBUG - [wrapper]    Exiting _get_cookie_and_crumb()
2025-04-19 14:31:51,731 - DEBUG - [_make_request] https://query2.finance.yahoo.com:443 "GET /v8/finance/chart/NONEXISTENTTICKER?range=1d&interval=1d&crumb=NgZIowMiLwG HTTP/1.1" 404 108
2025-04-19 14:31:51,732 - DEBUG - [_make_request] response code=404
2025-04-19 14:31:51,732 - DEBUG - [wrapper]   Exiting _make_request()
2025-04-19 14:31:51,732 - DEBUG - [wrapper]  Exiting get()
2025-04-19 14:31:51,733 - DEBUG - [_fetch_ticker_tz] Got error from yahoo api for ticker NONEXISTENTTICKER, Error: {'code': 'Not Found', 'description': 'No data found, symbol may be delisted'}
2025-04-19 14:31:51,733 - DEBUG - [wrapper] Exiting _fetch_ticker_tz()
2025-04-19 14:31:51,733 - ERROR - [fetch_stock_actions] Failed actions NONEXISTENTTICKER: TypeError - argument of type 'NoneType' is not iterable
2025-04-19 14:31:51,733 - WARNING - [run_stock_info_pipeline] Skip load NONEXISTENTTICKER due to fetch errors.
2025-04-19 14:31:51,739 - INFO - [run_stock_info_pipeline] DB connection closed.
2025-04-19 14:31:51,739 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 14:31:51,740 - INFO - [run_stock_info_pipeline] Total Time: 15.58 sec
2025-04-19 14:31:51,740 - INFO - [run_stock_info_pipeline] Tickers Attempted: 4
2025-04-19 14:31:51,740 - INFO - [run_stock_info_pipeline] Tickers OK: 0
2025-04-19 14:31:51,740 - INFO - [run_stock_info_pipeline] Tickers Skip/Err: 4
2025-04-19 14:31:51,741 - INFO - [run_stock_info_pipeline] Fetch Errors: 8
2025-04-19 14:31:51,741 - INFO - [run_stock_info_pipeline] Load Errors: 3
2025-04-19 14:31:51,741 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors'.
2025-04-19 14:31:51,742 - INFO - [<module>] Script execution finished.
2025-04-19 14:40:46,394 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v2.5) ---
2025-04-19 14:40:46,395 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 14:40:46,395 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 14:40:46,395 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 14:40:46,395 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 14:40:46,426 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 14:40:46,427 - INFO - [setup_info_tables] Setting up supplementary tables...
2025-04-19 14:40:46,429 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 14:40:46,430 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 14:40:46,430 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 14:40:50,858 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v2.5) ---
2025-04-19 14:40:50,859 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 14:40:50,859 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 14:40:50,859 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 14:40:50,859 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 14:40:50,864 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 14:40:50,865 - INFO - [setup_info_tables] Setting up supplementary tables...
2025-04-19 14:40:50,867 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 14:40:50,867 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 14:40:50,867 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 14:40:53,881 - INFO - [load_data_to_table] Loading 1 rows into company_profile for ticker AAPL (Mode: initial_load)
2025-04-19 14:40:53,889 - INFO - [load_data_to_table] Loading 1 rows into company_key_metrics for ticker AAPL (Mode: initial_load)
2025-04-19 14:40:53,897 - INFO - [load_data_to_table] Loading 5 rows into financials_income_annual for ticker AAPL (Mode: initial_load)
2025-04-19 14:40:53,899 - WARNING - [load_data_to_table] Cols missing DF->financials_income_annual (AAPL): ['TotalRevenue', 'CostOfRevenue', 'GrossProfit', 'OperatingIncome', 'NetIncome', 'NetIncomeFromContinuingOperations', 'NetIncomeApplicableToCommonShares', 'InterestExpense', 'IncomeBeforeTax', 'IncomeTaxExpense', 'ResearchDevelopment', 'SellingGeneralAdministrative', 'BasicEPS', 'DilutedEPS']. Inserting NULL.
2025-04-19 14:40:53,911 - INFO - [load_data_to_table] Loading 6 rows into financials_income_quarterly for ticker AAPL (Mode: initial_load)
2025-04-19 14:40:53,912 - WARNING - [load_data_to_table] Cols missing DF->financials_income_quarterly (AAPL): ['TotalRevenue', 'CostOfRevenue', 'GrossProfit', 'OperatingIncome', 'NetIncome', 'NetIncomeFromContinuingOperations', 'NetIncomeApplicableToCommonShares', 'InterestExpense', 'IncomeBeforeTax', 'IncomeTaxExpense', 'ResearchDevelopment', 'SellingGeneralAdministrative', 'BasicEPS', 'DilutedEPS']. Inserting NULL.
2025-04-19 14:40:53,926 - INFO - [load_data_to_table] Loading 5 rows into financials_balance_annual for ticker AAPL (Mode: initial_load)
2025-04-19 14:40:53,929 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_annual (AAPL): ['TotalAssets', 'CurrentAssets', 'TotalLiabilities', 'CurrentLiabilities', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'CommonStockEquity', 'CashAndCashEquivalents', 'AccountsReceivable', 'PropertyPlantEquipmentNet', 'AccountsPayable', 'ShortTermDebt', 'LongTermDebt', 'RetainedEarnings']. Inserting NULL.
2025-04-19 14:40:53,945 - INFO - [load_data_to_table] Loading 6 rows into financials_balance_quarterly for ticker AAPL (Mode: initial_load)
2025-04-19 14:40:53,947 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_quarterly (AAPL): ['TotalAssets', 'CurrentAssets', 'TotalLiabilities', 'CurrentLiabilities', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'CommonStockEquity', 'CashAndCashEquivalents', 'AccountsReceivable', 'PropertyPlantEquipmentNet', 'AccountsPayable', 'ShortTermDebt', 'LongTermDebt', 'RetainedEarnings']. Inserting NULL.
2025-04-19 14:40:53,963 - INFO - [load_data_to_table] Loading 5 rows into financials_cashflow_annual for ticker AAPL (Mode: initial_load)
2025-04-19 14:40:53,966 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_annual (AAPL): ['OperatingCashFlow', 'InvestingCashFlow', 'FinancingCashFlow', 'EndCashPosition', 'FreeCashFlow', 'CapitalExpenditure', 'IssuanceOfDebt', 'RepaymentOfDebt', 'RepurchaseOfCapitalStock', 'DividendPaid']. Inserting NULL.
2025-04-19 14:40:53,977 - INFO - [load_data_to_table] Loading 6 rows into financials_cashflow_quarterly for ticker AAPL (Mode: initial_load)
2025-04-19 14:40:53,980 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_quarterly (AAPL): ['OperatingCashFlow', 'InvestingCashFlow', 'FinancingCashFlow', 'EndCashPosition', 'FreeCashFlow', 'CapitalExpenditure', 'IssuanceOfDebt', 'RepaymentOfDebt', 'RepurchaseOfCapitalStock', 'DividendPaid']. Inserting NULL.
2025-04-19 14:40:53,990 - INFO - [load_data_to_table] Loading 91 rows into stock_actions for ticker AAPL (Mode: initial_load)
2025-04-19 14:40:57,083 - INFO - [load_data_to_table] Loading 1 rows into company_profile for ticker MSFT (Mode: initial_load)
2025-04-19 14:40:57,090 - INFO - [load_data_to_table] Loading 1 rows into company_key_metrics for ticker MSFT (Mode: initial_load)
2025-04-19 14:40:57,097 - INFO - [load_data_to_table] Loading 4 rows into financials_income_annual for ticker MSFT (Mode: initial_load)
2025-04-19 14:40:57,098 - WARNING - [load_data_to_table] Cols missing DF->financials_income_annual (MSFT): ['TotalRevenue', 'CostOfRevenue', 'GrossProfit', 'OperatingIncome', 'NetIncome', 'NetIncomeFromContinuingOperations', 'NetIncomeApplicableToCommonShares', 'InterestExpense', 'IncomeBeforeTax', 'IncomeTaxExpense', 'ResearchDevelopment', 'SellingGeneralAdministrative', 'BasicEPS', 'DilutedEPS']. Inserting NULL.
2025-04-19 14:40:57,107 - INFO - [load_data_to_table] Loading 5 rows into financials_income_quarterly for ticker MSFT (Mode: initial_load)
2025-04-19 14:40:57,108 - WARNING - [load_data_to_table] Cols missing DF->financials_income_quarterly (MSFT): ['TotalRevenue', 'CostOfRevenue', 'GrossProfit', 'OperatingIncome', 'NetIncome', 'NetIncomeFromContinuingOperations', 'NetIncomeApplicableToCommonShares', 'InterestExpense', 'IncomeBeforeTax', 'IncomeTaxExpense', 'ResearchDevelopment', 'SellingGeneralAdministrative', 'BasicEPS', 'DilutedEPS']. Inserting NULL.
2025-04-19 14:40:57,117 - INFO - [load_data_to_table] Loading 4 rows into financials_balance_annual for ticker MSFT (Mode: initial_load)
2025-04-19 14:40:57,118 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_annual (MSFT): ['TotalAssets', 'CurrentAssets', 'TotalLiabilities', 'CurrentLiabilities', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'CommonStockEquity', 'CashAndCashEquivalents', 'AccountsReceivable', 'PropertyPlantEquipmentNet', 'AccountsPayable', 'ShortTermDebt', 'LongTermDebt', 'RetainedEarnings']. Inserting NULL.
2025-04-19 14:40:57,127 - INFO - [load_data_to_table] Loading 6 rows into financials_balance_quarterly for ticker MSFT (Mode: initial_load)
2025-04-19 14:40:57,128 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_quarterly (MSFT): ['TotalAssets', 'CurrentAssets', 'TotalLiabilities', 'CurrentLiabilities', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'CommonStockEquity', 'CashAndCashEquivalents', 'AccountsReceivable', 'PropertyPlantEquipmentNet', 'AccountsPayable', 'ShortTermDebt', 'LongTermDebt', 'RetainedEarnings']. Inserting NULL.
2025-04-19 14:40:57,138 - INFO - [load_data_to_table] Loading 5 rows into financials_cashflow_annual for ticker MSFT (Mode: initial_load)
2025-04-19 14:40:57,139 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_annual (MSFT): ['OperatingCashFlow', 'InvestingCashFlow', 'FinancingCashFlow', 'EndCashPosition', 'FreeCashFlow', 'CapitalExpenditure', 'IssuanceOfDebt', 'RepaymentOfDebt', 'RepurchaseOfCapitalStock', 'DividendPaid']. Inserting NULL.
2025-04-19 14:40:57,145 - INFO - [load_data_to_table] Loading 6 rows into financials_cashflow_quarterly for ticker MSFT (Mode: initial_load)
2025-04-19 14:40:57,146 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_quarterly (MSFT): ['OperatingCashFlow', 'InvestingCashFlow', 'FinancingCashFlow', 'EndCashPosition', 'FreeCashFlow', 'CapitalExpenditure', 'IssuanceOfDebt', 'RepaymentOfDebt', 'RepurchaseOfCapitalStock', 'DividendPaid']. Inserting NULL.
2025-04-19 14:40:57,155 - INFO - [load_data_to_table] Loading 94 rows into stock_actions for ticker MSFT (Mode: initial_load)
2025-04-19 14:41:00,094 - INFO - [load_data_to_table] Loading 1 rows into company_profile for ticker GOOG (Mode: initial_load)
2025-04-19 14:41:00,101 - INFO - [load_data_to_table] Loading 1 rows into company_key_metrics for ticker GOOG (Mode: initial_load)
2025-04-19 14:41:00,110 - INFO - [load_data_to_table] Loading 5 rows into financials_income_annual for ticker GOOG (Mode: initial_load)
2025-04-19 14:41:00,111 - WARNING - [load_data_to_table] Cols missing DF->financials_income_annual (GOOG): ['TotalRevenue', 'CostOfRevenue', 'GrossProfit', 'OperatingIncome', 'NetIncome', 'NetIncomeFromContinuingOperations', 'NetIncomeApplicableToCommonShares', 'InterestExpense', 'IncomeBeforeTax', 'IncomeTaxExpense', 'ResearchDevelopment', 'SellingGeneralAdministrative', 'BasicEPS', 'DilutedEPS']. Inserting NULL.
2025-04-19 14:41:00,120 - INFO - [load_data_to_table] Loading 6 rows into financials_income_quarterly for ticker GOOG (Mode: initial_load)
2025-04-19 14:41:00,121 - WARNING - [load_data_to_table] Cols missing DF->financials_income_quarterly (GOOG): ['TotalRevenue', 'CostOfRevenue', 'GrossProfit', 'OperatingIncome', 'NetIncome', 'NetIncomeFromContinuingOperations', 'NetIncomeApplicableToCommonShares', 'InterestExpense', 'IncomeBeforeTax', 'IncomeTaxExpense', 'ResearchDevelopment', 'SellingGeneralAdministrative', 'BasicEPS', 'DilutedEPS']. Inserting NULL.
2025-04-19 14:41:00,130 - INFO - [load_data_to_table] Loading 5 rows into financials_balance_annual for ticker GOOG (Mode: initial_load)
2025-04-19 14:41:00,131 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_annual (GOOG): ['TotalAssets', 'CurrentAssets', 'TotalLiabilities', 'CurrentLiabilities', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'CommonStockEquity', 'CashAndCashEquivalents', 'AccountsReceivable', 'PropertyPlantEquipmentNet', 'AccountsPayable', 'ShortTermDebt', 'LongTermDebt', 'RetainedEarnings']. Inserting NULL.
2025-04-19 14:41:00,141 - INFO - [load_data_to_table] Loading 6 rows into financials_balance_quarterly for ticker GOOG (Mode: initial_load)
2025-04-19 14:41:00,142 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_quarterly (GOOG): ['TotalAssets', 'CurrentAssets', 'TotalLiabilities', 'CurrentLiabilities', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'CommonStockEquity', 'CashAndCashEquivalents', 'AccountsReceivable', 'PropertyPlantEquipmentNet', 'AccountsPayable', 'ShortTermDebt', 'LongTermDebt', 'RetainedEarnings']. Inserting NULL.
2025-04-19 14:41:00,153 - INFO - [load_data_to_table] Loading 5 rows into financials_cashflow_annual for ticker GOOG (Mode: initial_load)
2025-04-19 14:41:00,154 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_annual (GOOG): ['OperatingCashFlow', 'InvestingCashFlow', 'FinancingCashFlow', 'EndCashPosition', 'FreeCashFlow', 'CapitalExpenditure', 'IssuanceOfDebt', 'RepaymentOfDebt', 'RepurchaseOfCapitalStock', 'DividendPaid']. Inserting NULL.
2025-04-19 14:41:00,162 - INFO - [load_data_to_table] Loading 6 rows into financials_cashflow_quarterly for ticker GOOG (Mode: initial_load)
2025-04-19 14:41:00,163 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_quarterly (GOOG): ['OperatingCashFlow', 'InvestingCashFlow', 'FinancingCashFlow', 'EndCashPosition', 'FreeCashFlow', 'CapitalExpenditure', 'IssuanceOfDebt', 'RepaymentOfDebt', 'RepurchaseOfCapitalStock', 'DividendPaid']. Inserting NULL.
2025-04-19 14:41:00,174 - INFO - [load_data_to_table] Loading 7 rows into stock_actions for ticker GOOG (Mode: initial_load)
2025-04-19 14:41:02,087 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 14:41:02,087 - ERROR - [fetch_company_info] Failed processing .info NONEXISTENTTICKER: AttributeError-'NoneType' object has no attribute 'update'
2025-04-19 14:41:02,088 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=fetch_company_info returned None
2025-04-19 14:41:03,514 - INFO - [fetch_financial_statement] No annual financials data found for NONEXISTENTTICKER.
2025-04-19 14:41:03,516 - INFO - [fetch_financial_statement] No quarterly financials data found for NONEXISTENTTICKER.
2025-04-19 14:41:03,517 - INFO - [fetch_financial_statement] No annual balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 14:41:03,517 - INFO - [fetch_financial_statement] No quarterly balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 14:41:03,518 - INFO - [fetch_financial_statement] No annual cashflow data found for NONEXISTENTTICKER.
2025-04-19 14:41:03,519 - INFO - [fetch_financial_statement] No quarterly cashflow data found for NONEXISTENTTICKER.
2025-04-19 14:41:04,369 - ERROR - [fetch_stock_actions] Failed actions NONEXISTENTTICKER: TypeError - argument of type 'NoneType' is not iterable
2025-04-19 14:41:04,369 - WARNING - [run_stock_info_pipeline] Skip load NONEXISTENTTICKER due to fetch errors.
2025-04-19 14:41:04,375 - INFO - [run_stock_info_pipeline] DB connection closed.
2025-04-19 14:41:04,375 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 14:41:04,375 - INFO - [run_stock_info_pipeline] Total Time: 13.52 sec
2025-04-19 14:41:04,375 - INFO - [run_stock_info_pipeline] Tickers Attempted: 4
2025-04-19 14:41:04,375 - INFO - [run_stock_info_pipeline] Tickers OK: 3
2025-04-19 14:41:04,375 - INFO - [run_stock_info_pipeline] Tickers Skip/Err: 1
2025-04-19 14:41:04,376 - INFO - [run_stock_info_pipeline] Fetch Errors: 8
2025-04-19 14:41:04,376 - INFO - [run_stock_info_pipeline] Load Errors: 0
2025-04-19 14:41:04,376 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors'.
2025-04-19 14:41:04,377 - INFO - [<module>] Script execution finished.
2025-04-19 14:44:25,195 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v2.6) ---
2025-04-19 14:44:25,196 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 14:44:25,196 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 14:44:25,196 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 14:44:25,196 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 14:44:25,233 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 14:44:25,233 - INFO - [setup_info_tables] Setting up supplementary tables...
2025-04-19 14:44:25,236 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 14:44:25,237 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 14:44:25,237 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 14:44:28,332 - INFO - [load_data_to_table] Loading 1 rows into company_profile for ticker AAPL (Mode: initial_load)
2025-04-19 14:44:28,339 - INFO - [load_data_to_table] Loading 1 rows into company_key_metrics for ticker AAPL (Mode: initial_load)
2025-04-19 14:44:28,347 - INFO - [load_data_to_table] Loading 5 rows into financials_income_annual for ticker AAPL (Mode: initial_load)
2025-04-19 14:44:28,349 - WARNING - [load_data_to_table] DF for financials_income_annual (AAPL) has extra columns not in DB schema: ['Tax_Effect_Of_Unusual_Items', 'Tax_Rate_For_Calcs', 'Normalized_EBITDA', 'Net_Income_From_Continuing_Operation_Net_Minority_Interest', 'Reconciled_Depreciation', 'Reconciled_Cost_Of_Revenue', 'Net_Interest_Income', 'Interest_Expense', 'Interest_Income', 'Normalized_Income', 'Net_Income_From_Continuing_And_Discontinued_Operation', 'Total_Expenses', 'Total_Operating_Income_As_Reported', 'Diluted_Average_Shares', 'Basic_Average_Shares', 'Diluted_EPS', 'Basic_EPS', 'Diluted_NI_Availto_Com_Stockholders', 'Net_Income_Common_Stockholders', 'Net_Income', 'Net_Income_Including_Noncontrolling_Interests', 'Net_Income_Continuous_Operations', 'Tax_Provision', 'Pretax_Income', 'Other_Income_Expense', 'Other_Non_Operating_Income_Expenses', 'Net_Non_Operating_Interest_Income_Expense', 'Interest_Expense_Non_Operating', 'Interest_Income_Non_Operating', 'Operating_Income', 'Operating_Expense', 'Research_And_Development', 'Selling_General_And_Administration', 'Gross_Profit', 'Cost_Of_Revenue', 'Total_Revenue', 'Operating_Revenue']. These will be ignored.
2025-04-19 14:44:28,349 - WARNING - [load_data_to_table] Cols missing DF->financials_income_annual (AAPL): ['TaxEffectOfUnusualItems', 'TaxRateForCalcs', 'NormalizedEBITDA', 'TotalUnusualItems', 'TotalUnusualItemsExcludingGoodwill', 'NetIncomeFromContinuingOperationNetMinorityInterest', 'ReconciledDepreciation', 'ReconciledCostOfRevenue', 'NetInterestIncome', 'InterestExpense', 'InterestIncome', 'NormalizedIncome', 'NetIncomeFromContinuingAndDiscontinuedOperation', 'TotalExpenses', 'TotalOperatingIncomeAsReported', 'DilutedAverageShares', 'BasicAverageShares', 'DilutedEPS', 'BasicEPS', 'DilutedNIAvailtoComStockholders', 'NetIncomeCommonStockholders', 'NetIncome', 'NetIncomeIncludingNoncontrollingInterests', 'NetIncomeContinuousOperations', 'TaxProvision', 'PretaxIncome', 'OtherIncomeExpense', 'OtherNonOperatingIncomeExpenses', 'SpecialIncomeCharges', 'EarningsFromEquityInterest', 'GainOnSaleOfSecurity', 'NetNonOperatingInterestIncomeExpense', 'InterestExpenseNonOperating', 'InterestIncomeNonOperating', 'OperatingIncome', 'OperatingExpense', 'ResearchAndDevelopment', 'SellingGeneralAndAdministration', 'SellingAndMarketingExpense', 'GeneralAndAdministrativeExpense', 'OtherGandA', 'GrossProfit', 'CostOfRevenue', 'TotalRevenue', 'OperatingRevenue']. Inserting NULL.
2025-04-19 14:44:28,372 - INFO - [load_data_to_table] Loading 6 rows into financials_income_quarterly for ticker AAPL (Mode: initial_load)
2025-04-19 14:44:28,373 - WARNING - [load_data_to_table] DF for financials_income_quarterly (AAPL) has extra columns not in DB schema: ['Tax_Effect_Of_Unusual_Items', 'Tax_Rate_For_Calcs', 'Normalized_EBITDA', 'Net_Income_From_Continuing_Operation_Net_Minority_Interest', 'Reconciled_Depreciation', 'Reconciled_Cost_Of_Revenue', 'Net_Interest_Income', 'Interest_Expense', 'Interest_Income', 'Normalized_Income', 'Net_Income_From_Continuing_And_Discontinued_Operation', 'Total_Expenses', 'Total_Operating_Income_As_Reported', 'Diluted_Average_Shares', 'Basic_Average_Shares', 'Diluted_EPS', 'Basic_EPS', 'Diluted_NI_Availto_Com_Stockholders', 'Net_Income_Common_Stockholders', 'Net_Income', 'Net_Income_Including_Noncontrolling_Interests', 'Net_Income_Continuous_Operations', 'Tax_Provision', 'Pretax_Income', 'Other_Income_Expense', 'Other_Non_Operating_Income_Expenses', 'Net_Non_Operating_Interest_Income_Expense', 'Interest_Expense_Non_Operating', 'Interest_Income_Non_Operating', 'Operating_Income', 'Operating_Expense', 'Research_And_Development', 'Selling_General_And_Administration', 'Gross_Profit', 'Cost_Of_Revenue', 'Total_Revenue', 'Operating_Revenue']. These will be ignored.
2025-04-19 14:44:28,374 - WARNING - [load_data_to_table] Cols missing DF->financials_income_quarterly (AAPL): ['TaxEffectOfUnusualItems', 'TaxRateForCalcs', 'NormalizedEBITDA', 'TotalUnusualItems', 'TotalUnusualItemsExcludingGoodwill', 'NetIncomeFromContinuingOperationNetMinorityInterest', 'ReconciledDepreciation', 'ReconciledCostOfRevenue', 'NetInterestIncome', 'InterestExpense', 'InterestIncome', 'NormalizedIncome', 'NetIncomeFromContinuingAndDiscontinuedOperation', 'TotalExpenses', 'TotalOperatingIncomeAsReported', 'DilutedAverageShares', 'BasicAverageShares', 'DilutedEPS', 'BasicEPS', 'DilutedNIAvailtoComStockholders', 'NetIncomeCommonStockholders', 'NetIncome', 'NetIncomeIncludingNoncontrollingInterests', 'NetIncomeContinuousOperations', 'TaxProvision', 'PretaxIncome', 'OtherIncomeExpense', 'OtherNonOperatingIncomeExpenses', 'SpecialIncomeCharges', 'EarningsFromEquityInterest', 'GainOnSaleOfSecurity', 'NetNonOperatingInterestIncomeExpense', 'InterestExpenseNonOperating', 'InterestIncomeNonOperating', 'OperatingIncome', 'OperatingExpense', 'ResearchAndDevelopment', 'SellingGeneralAndAdministration', 'SellingAndMarketingExpense', 'GeneralAndAdministrativeExpense', 'OtherGandA', 'GrossProfit', 'CostOfRevenue', 'TotalRevenue', 'OperatingRevenue']. Inserting NULL.
2025-04-19 14:44:28,398 - INFO - [load_data_to_table] Loading 5 rows into financials_balance_annual for ticker AAPL (Mode: initial_load)
2025-04-19 14:44:28,398 - WARNING - [load_data_to_table] DF for financials_balance_annual (AAPL) has extra columns not in DB schema: ['Treasury_Shares_Number', 'Ordinary_Shares_Number', 'Share_Issued', 'Net_Debt', 'Total_Debt', 'Tangible_Book_Value', 'Invested_Capital', 'Working_Capital', 'Net_Tangible_Assets', 'Capital_Lease_Obligations', 'Common_Stock_Equity', 'Total_Capitalization', 'Total_Equity_Gross_Minority_Interest', 'Stockholders_Equity', 'Gains_Losses_Not_Affecting_Retained_Earnings', 'Other_Equity_Adjustments', 'Retained_Earnings', 'Capital_Stock', 'Common_Stock', 'Total_Liabilities_Net_Minority_Interest', 'Total_Non_Current_Liabilities_Net_Minority_Interest', 'Other_Non_Current_Liabilities', 'Tradeand_Other_Payables_Non_Current', 'Long_Term_Debt_And_Capital_Lease_Obligation', 'Long_Term_Capital_Lease_Obligation', 'Long_Term_Debt', 'Current_Liabilities', 'Other_Current_Liabilities', 'Current_Deferred_Liabilities', 'Current_Deferred_Revenue', 'Current_Debt_And_Capital_Lease_Obligation', 'Current_Capital_Lease_Obligation', 'Current_Debt', 'Other_Current_Borrowings', 'Commercial_Paper', 'Payables_And_Accrued_Expenses', 'Total_Tax_Payable', 'Income_Tax_Payable', 'Accounts_Payable', 'Total_Assets', 'Total_Non_Current_Assets', 'Other_Non_Current_Assets', 'Non_Current_Deferred_Assets', 'Non_Current_Deferred_Taxes_Assets', 'Investments_And_Advances', 'Other_Investments', 'Investmentin_Financial_Assets', 'Available_For_Sale_Securities', 'Net_PPE', 'Accumulated_Depreciation', 'Gross_PPE', 'Other_Properties', 'Machinery_Furniture_Equipment', 'Land_And_Improvements', 'Current_Assets', 'Other_Current_Assets', 'Other_Receivables', 'Accounts_Receivable', 'Cash_Cash_Equivalents_And_Short_Term_Investments', 'Other_Short_Term_Investments', 'Cash_And_Cash_Equivalents', 'Cash_Equivalents', 'Cash_Financial']. These will be ignored.
2025-04-19 14:44:28,399 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_annual (AAPL): ['TreasurySharesNumber', 'OrdinarySharesNumber', 'ShareIssued', 'TotalDebt', 'TangibleBookValue', 'InvestedCapital', 'WorkingCapital', 'NetTangibleAssets', 'CapitalLeaseObligations', 'CommonStockEquity', 'TotalCapitalization', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'GainsLossesNotAffectingRetainedEarnings', 'OtherEquityAdjustments', 'RetainedEarnings', 'CapitalStock', 'CommonStock', 'PreferredStock', 'TotalLiabilitiesNetMinorityInterest', 'TotalNonCurrentLiabilitiesNetMinorityInterest', 'OtherNonCurrentLiabilities', 'TradeandOtherPayablesNonCurrent', 'NonCurrentDeferredLiabilities', 'NonCurrentDeferredRevenue', 'NonCurrentDeferredTaxesLiabilities', 'LongTermDebtAndCapitalLeaseObligation', 'LongTermCapitalLeaseObligation', 'LongTermDebt', 'CurrentLiabilities', 'OtherCurrentLiabilities', 'CurrentDeferredLiabilities', 'CurrentDeferredRevenue', 'CurrentDebtAndCapitalLeaseObligation', 'CurrentCapitalLeaseObligation', 'PensionandOtherPostRetirementBenefitPlansCurrent', 'PayablesAndAccruedExpenses', 'CurrentAccruedExpenses', 'OtherPayable', 'TotalTaxPayable', 'IncomeTaxPayable', 'AccountsPayable', 'TotalAssets', 'TotalNonCurrentAssets', 'OtherNonCurrentAssets', 'NonCurrentDeferredAssets', 'NonCurrentDeferredTaxesAssets', 'InvestmentsAndAdvances', 'InvestmentinFinancialAssets', 'AvailableForSaleSecurities', 'GoodwillAndOtherIntangibleAssets', 'OtherIntangibleAssets', 'Goodwill', 'NetPPE', 'AccumulatedDepreciation', 'GrossPPE', 'ConstructionInProgress', 'OtherProperties', 'MachineryFurnitureEquipment', 'BuildingsAndImprovements', 'LandAndImprovements', 'CurrentAssets', 'OtherCurrentAssets', 'TaxesReceivable', 'AccountsReceivable', 'AllowanceForDoubtfulAccountsReceivable', 'GrossAccountsReceivable', 'CashCashEquivalentsAndShortTermInvestments', 'OtherShortTermInvestments', 'CashAndCashEquivalents', 'CashEquivalents', 'CashFinancial']. Inserting NULL.
2025-04-19 14:44:28,434 - INFO - [load_data_to_table] Loading 6 rows into financials_balance_quarterly for ticker AAPL (Mode: initial_load)
2025-04-19 14:44:28,434 - WARNING - [load_data_to_table] DF for financials_balance_quarterly (AAPL) has extra columns not in DB schema: ['Treasury_Shares_Number', 'Ordinary_Shares_Number', 'Share_Issued', 'Net_Debt', 'Total_Debt', 'Tangible_Book_Value', 'Invested_Capital', 'Working_Capital', 'Net_Tangible_Assets', 'Capital_Lease_Obligations', 'Common_Stock_Equity', 'Total_Capitalization', 'Total_Equity_Gross_Minority_Interest', 'Stockholders_Equity', 'Gains_Losses_Not_Affecting_Retained_Earnings', 'Other_Equity_Adjustments', 'Retained_Earnings', 'Capital_Stock', 'Common_Stock', 'Total_Liabilities_Net_Minority_Interest', 'Total_Non_Current_Liabilities_Net_Minority_Interest', 'Other_Non_Current_Liabilities', 'Tradeand_Other_Payables_Non_Current', 'Long_Term_Debt_And_Capital_Lease_Obligation', 'Long_Term_Capital_Lease_Obligation', 'Long_Term_Debt', 'Current_Liabilities', 'Other_Current_Liabilities', 'Current_Deferred_Liabilities', 'Current_Deferred_Revenue', 'Current_Debt_And_Capital_Lease_Obligation', 'Current_Capital_Lease_Obligation', 'Current_Debt', 'Other_Current_Borrowings', 'Commercial_Paper', 'Payables_And_Accrued_Expenses', 'Total_Tax_Payable', 'Income_Tax_Payable', 'Accounts_Payable', 'Total_Assets', 'Total_Non_Current_Assets', 'Other_Non_Current_Assets', 'Non_Current_Deferred_Assets', 'Non_Current_Deferred_Taxes_Assets', 'Investments_And_Advances', 'Investmentin_Financial_Assets', 'Available_For_Sale_Securities', 'Net_PPE', 'Accumulated_Depreciation', 'Gross_PPE', 'Other_Properties', 'Machinery_Furniture_Equipment', 'Land_And_Improvements', 'Current_Assets', 'Other_Current_Assets', 'Finished_Goods', 'Raw_Materials', 'Other_Receivables', 'Accounts_Receivable', 'Cash_Cash_Equivalents_And_Short_Term_Investments', 'Other_Short_Term_Investments', 'Cash_And_Cash_Equivalents', 'Cash_Equivalents', 'Cash_Financial']. These will be ignored.
2025-04-19 14:44:28,435 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_quarterly (AAPL): ['TreasurySharesNumber', 'OrdinarySharesNumber', 'ShareIssued', 'TotalDebt', 'TangibleBookValue', 'InvestedCapital', 'WorkingCapital', 'NetTangibleAssets', 'CapitalLeaseObligations', 'CommonStockEquity', 'TotalCapitalization', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'GainsLossesNotAffectingRetainedEarnings', 'OtherEquityAdjustments', 'RetainedEarnings', 'CapitalStock', 'CommonStock', 'PreferredStock', 'TotalLiabilitiesNetMinorityInterest', 'TotalNonCurrentLiabilitiesNetMinorityInterest', 'OtherNonCurrentLiabilities', 'TradeandOtherPayablesNonCurrent', 'NonCurrentDeferredLiabilities', 'NonCurrentDeferredRevenue', 'NonCurrentDeferredTaxesLiabilities', 'LongTermDebtAndCapitalLeaseObligation', 'LongTermCapitalLeaseObligation', 'LongTermDebt', 'CurrentLiabilities', 'OtherCurrentLiabilities', 'CurrentDeferredLiabilities', 'CurrentDeferredRevenue', 'CurrentDebtAndCapitalLeaseObligation', 'CurrentCapitalLeaseObligation', 'PensionandOtherPostRetirementBenefitPlansCurrent', 'PayablesAndAccruedExpenses', 'CurrentAccruedExpenses', 'OtherPayable', 'TotalTaxPayable', 'IncomeTaxPayable', 'AccountsPayable', 'TotalAssets', 'TotalNonCurrentAssets', 'OtherNonCurrentAssets', 'NonCurrentDeferredAssets', 'NonCurrentDeferredTaxesAssets', 'InvestmentsAndAdvances', 'InvestmentinFinancialAssets', 'AvailableForSaleSecurities', 'GoodwillAndOtherIntangibleAssets', 'OtherIntangibleAssets', 'Goodwill', 'NetPPE', 'AccumulatedDepreciation', 'GrossPPE', 'ConstructionInProgress', 'OtherProperties', 'MachineryFurnitureEquipment', 'BuildingsAndImprovements', 'LandAndImprovements', 'CurrentAssets', 'OtherCurrentAssets', 'TaxesReceivable', 'AccountsReceivable', 'AllowanceForDoubtfulAccountsReceivable', 'GrossAccountsReceivable', 'CashCashEquivalentsAndShortTermInvestments', 'OtherShortTermInvestments', 'CashAndCashEquivalents', 'CashEquivalents', 'CashFinancial']. Inserting NULL.
2025-04-19 14:44:28,468 - INFO - [load_data_to_table] Loading 5 rows into financials_cashflow_annual for ticker AAPL (Mode: initial_load)
2025-04-19 14:44:28,469 - WARNING - [load_data_to_table] DF for financials_cashflow_annual (AAPL) has extra columns not in DB schema: ['Free_Cash_Flow', 'Repurchase_Of_Capital_Stock', 'Repayment_Of_Debt', 'Issuance_Of_Debt', 'Issuance_Of_Capital_Stock', 'Capital_Expenditure', 'Interest_Paid_Supplemental_Data', 'Income_Tax_Paid_Supplemental_Data', 'End_Cash_Position', 'Beginning_Cash_Position', 'Changes_In_Cash', 'Financing_Cash_Flow', 'Cash_Flow_From_Continuing_Financing_Activities', 'Net_Other_Financing_Charges', 'Cash_Dividends_Paid', 'Common_Stock_Dividend_Paid', 'Net_Common_Stock_Issuance', 'Common_Stock_Payments', 'Common_Stock_Issuance', 'Net_Issuance_Payments_Of_Debt', 'Net_Short_Term_Debt_Issuance', 'Net_Long_Term_Debt_Issuance', 'Long_Term_Debt_Payments', 'Long_Term_Debt_Issuance', 'Investing_Cash_Flow', 'Cash_Flow_From_Continuing_Investing_Activities', 'Net_Other_Investing_Changes', 'Net_Investment_Purchase_And_Sale', 'Sale_Of_Investment', 'Purchase_Of_Investment', 'Net_Business_Purchase_And_Sale', 'Purchase_Of_Business', 'Net_PPE_Purchase_And_Sale', 'Purchase_Of_PPE', 'Operating_Cash_Flow', 'Cash_Flow_From_Continuing_Operating_Activities', 'Change_In_Working_Capital', 'Change_In_Other_Working_Capital', 'Change_In_Other_Current_Liabilities', 'Change_In_Other_Current_Assets', 'Change_In_Payables_And_Accrued_Expense', 'Change_In_Payable', 'Change_In_Account_Payable', 'Change_In_Inventory', 'Change_In_Receivables', 'Changes_In_Account_Receivables', 'Other_Non_Cash_Items', 'Stock_Based_Compensation', 'Deferred_Tax', 'Deferred_Income_Tax', 'Depreciation_Amortization_Depletion', 'Depreciation_And_Amortization', 'Net_Income_From_Continuing_Operations']. These will be ignored.
2025-04-19 14:44:28,469 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_annual (AAPL): ['FreeCashFlow', 'RepurchaseOfCapitalStock', 'RepaymentOfDebt', 'IssuanceOfDebt', 'CapitalExpenditure', 'IncomeTaxPaidSupplementalData', 'EndCashPosition', 'BeginningCashPosition', 'EffectOfExchangeRateChanges', 'ChangesInCash', 'FinancingCashFlow', 'CashFlowFromContinuingFinancingActivities', 'NetOtherFinancingCharges', 'ProceedsFromStockOptionExercised', 'CashDividendsPaid', 'CommonStockDividendPaid', 'NetCommonStockIssuance', 'CommonStockPayments', 'NetIssuancePaymentsOfDebt', 'NetLongTermDebtIssuance', 'LongTermDebtPayments', 'LongTermDebtIssuance', 'InvestingCashFlow', 'CashFlowFromContinuingInvestingActivities', 'NetOtherInvestingChanges', 'NetInvestmentPurchaseAndSale', 'SaleOfInvestment', 'PurchaseOfInvestment', 'NetBusinessPurchaseAndSale', 'PurchaseOfBusiness', 'NetPPEPurchaseAndSale', 'PurchaseOfPPE', 'OperatingCashFlow', 'CashFlowFromContinuingOperatingActivities', 'ChangeInWorkingCapital', 'ChangeInOtherWorkingCapital', 'ChangeInOtherCurrentAssets', 'ChangeInPayablesAndAccruedExpense', 'ChangeInAccruedExpense', 'ChangeInPayable', 'ChangeInAccountPayable', 'ChangeInReceivables', 'ChangesInAccountReceivables', 'OtherNonCashItems', 'StockBasedCompensation', 'DeferredTax', 'DeferredIncomeTax', 'DepreciationAmortizationDepletion', 'DepreciationAndAmortization', 'AmortizationCashFlow', 'AmortizationOfIntangibles', 'Depreciation', 'OperatingGainsLosses', 'GainLossOnInvestmentSecurities', 'NetIncomeFromContinuingOperations']. Inserting NULL.
2025-04-19 14:44:28,495 - INFO - [load_data_to_table] Loading 6 rows into financials_cashflow_quarterly for ticker AAPL (Mode: initial_load)
2025-04-19 14:44:28,496 - WARNING - [load_data_to_table] DF for financials_cashflow_quarterly (AAPL) has extra columns not in DB schema: ['Free_Cash_Flow', 'Repurchase_Of_Capital_Stock', 'Repayment_Of_Debt', 'Issuance_Of_Debt', 'Capital_Expenditure', 'Interest_Paid_Supplemental_Data', 'Income_Tax_Paid_Supplemental_Data', 'End_Cash_Position', 'Beginning_Cash_Position', 'Changes_In_Cash', 'Financing_Cash_Flow', 'Cash_Flow_From_Continuing_Financing_Activities', 'Net_Other_Financing_Charges', 'Cash_Dividends_Paid', 'Common_Stock_Dividend_Paid', 'Net_Common_Stock_Issuance', 'Common_Stock_Payments', 'Net_Issuance_Payments_Of_Debt', 'Net_Short_Term_Debt_Issuance', 'Short_Term_Debt_Payments', 'Net_Long_Term_Debt_Issuance', 'Long_Term_Debt_Payments', 'Long_Term_Debt_Issuance', 'Investing_Cash_Flow', 'Cash_Flow_From_Continuing_Investing_Activities', 'Net_Other_Investing_Changes', 'Net_Investment_Purchase_And_Sale', 'Sale_Of_Investment', 'Purchase_Of_Investment', 'Net_PPE_Purchase_And_Sale', 'Purchase_Of_PPE', 'Operating_Cash_Flow', 'Cash_Flow_From_Continuing_Operating_Activities', 'Change_In_Working_Capital', 'Change_In_Other_Current_Liabilities', 'Change_In_Other_Current_Assets', 'Change_In_Payables_And_Accrued_Expense', 'Change_In_Payable', 'Change_In_Account_Payable', 'Change_In_Inventory', 'Change_In_Receivables', 'Changes_In_Account_Receivables', 'Other_Non_Cash_Items', 'Stock_Based_Compensation', 'Depreciation_Amortization_Depletion', 'Depreciation_And_Amortization', 'Net_Income_From_Continuing_Operations']. These will be ignored.
2025-04-19 14:44:28,497 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_quarterly (AAPL): ['FreeCashFlow', 'RepurchaseOfCapitalStock', 'RepaymentOfDebt', 'IssuanceOfDebt', 'CapitalExpenditure', 'IncomeTaxPaidSupplementalData', 'EndCashPosition', 'BeginningCashPosition', 'EffectOfExchangeRateChanges', 'ChangesInCash', 'FinancingCashFlow', 'CashFlowFromContinuingFinancingActivities', 'NetOtherFinancingCharges', 'ProceedsFromStockOptionExercised', 'CashDividendsPaid', 'CommonStockDividendPaid', 'NetCommonStockIssuance', 'CommonStockPayments', 'NetIssuancePaymentsOfDebt', 'NetLongTermDebtIssuance', 'LongTermDebtPayments', 'LongTermDebtIssuance', 'InvestingCashFlow', 'CashFlowFromContinuingInvestingActivities', 'NetOtherInvestingChanges', 'NetInvestmentPurchaseAndSale', 'SaleOfInvestment', 'PurchaseOfInvestment', 'NetBusinessPurchaseAndSale', 'PurchaseOfBusiness', 'NetPPEPurchaseAndSale', 'PurchaseOfPPE', 'OperatingCashFlow', 'CashFlowFromContinuingOperatingActivities', 'ChangeInWorkingCapital', 'ChangeInOtherWorkingCapital', 'ChangeInOtherCurrentAssets', 'ChangeInPayablesAndAccruedExpense', 'ChangeInAccruedExpense', 'ChangeInPayable', 'ChangeInAccountPayable', 'ChangeInReceivables', 'ChangesInAccountReceivables', 'OtherNonCashItems', 'StockBasedCompensation', 'DeferredTax', 'DeferredIncomeTax', 'DepreciationAmortizationDepletion', 'DepreciationAndAmortization', 'AmortizationCashFlow', 'AmortizationOfIntangibles', 'Depreciation', 'OperatingGainsLosses', 'GainLossOnInvestmentSecurities', 'NetIncomeFromContinuingOperations']. Inserting NULL.
2025-04-19 14:44:28,524 - INFO - [load_data_to_table] Loading 91 rows into stock_actions for ticker AAPL (Mode: initial_load)
2025-04-19 14:44:31,790 - INFO - [load_data_to_table] Loading 1 rows into company_profile for ticker MSFT (Mode: initial_load)
2025-04-19 14:44:31,797 - INFO - [load_data_to_table] Loading 1 rows into company_key_metrics for ticker MSFT (Mode: initial_load)
2025-04-19 14:44:31,805 - INFO - [load_data_to_table] Loading 4 rows into financials_income_annual for ticker MSFT (Mode: initial_load)
2025-04-19 14:44:31,806 - WARNING - [load_data_to_table] DF for financials_income_annual (MSFT) has extra columns not in DB schema: ['Tax_Effect_Of_Unusual_Items', 'Tax_Rate_For_Calcs', 'Normalized_EBITDA', 'Total_Unusual_Items', 'Total_Unusual_Items_Excluding_Goodwill', 'Net_Income_From_Continuing_Operation_Net_Minority_Interest', 'Reconciled_Depreciation', 'Reconciled_Cost_Of_Revenue', 'Net_Interest_Income', 'Interest_Expense', 'Interest_Income', 'Normalized_Income', 'Net_Income_From_Continuing_And_Discontinued_Operation', 'Total_Expenses', 'Total_Operating_Income_As_Reported', 'Diluted_Average_Shares', 'Basic_Average_Shares', 'Diluted_EPS', 'Basic_EPS', 'Diluted_NI_Availto_Com_Stockholders', 'Net_Income_Common_Stockholders', 'Net_Income', 'Net_Income_Including_Noncontrolling_Interests', 'Net_Income_Continuous_Operations', 'Tax_Provision', 'Pretax_Income', 'Other_Income_Expense', 'Other_Non_Operating_Income_Expenses', 'Special_Income_Charges', 'Write_Off', 'Gain_On_Sale_Of_Security', 'Net_Non_Operating_Interest_Income_Expense', 'Interest_Expense_Non_Operating', 'Interest_Income_Non_Operating', 'Operating_Income', 'Operating_Expense', 'Research_And_Development', 'Selling_General_And_Administration', 'Selling_And_Marketing_Expense', 'General_And_Administrative_Expense', 'Other_Gand_A', 'Gross_Profit', 'Cost_Of_Revenue', 'Total_Revenue', 'Operating_Revenue']. These will be ignored.
2025-04-19 14:44:31,806 - WARNING - [load_data_to_table] Cols missing DF->financials_income_annual (MSFT): ['TaxEffectOfUnusualItems', 'TaxRateForCalcs', 'NormalizedEBITDA', 'TotalUnusualItems', 'TotalUnusualItemsExcludingGoodwill', 'NetIncomeFromContinuingOperationNetMinorityInterest', 'ReconciledDepreciation', 'ReconciledCostOfRevenue', 'NetInterestIncome', 'InterestExpense', 'InterestIncome', 'NormalizedIncome', 'NetIncomeFromContinuingAndDiscontinuedOperation', 'TotalExpenses', 'TotalOperatingIncomeAsReported', 'DilutedAverageShares', 'BasicAverageShares', 'DilutedEPS', 'BasicEPS', 'DilutedNIAvailtoComStockholders', 'NetIncomeCommonStockholders', 'NetIncome', 'NetIncomeIncludingNoncontrollingInterests', 'NetIncomeContinuousOperations', 'TaxProvision', 'PretaxIncome', 'OtherIncomeExpense', 'OtherNonOperatingIncomeExpenses', 'SpecialIncomeCharges', 'EarningsFromEquityInterest', 'GainOnSaleOfSecurity', 'NetNonOperatingInterestIncomeExpense', 'InterestExpenseNonOperating', 'InterestIncomeNonOperating', 'OperatingIncome', 'OperatingExpense', 'ResearchAndDevelopment', 'SellingGeneralAndAdministration', 'SellingAndMarketingExpense', 'GeneralAndAdministrativeExpense', 'OtherGandA', 'GrossProfit', 'CostOfRevenue', 'TotalRevenue', 'OperatingRevenue']. Inserting NULL.
2025-04-19 14:44:31,833 - INFO - [load_data_to_table] Loading 5 rows into financials_income_quarterly for ticker MSFT (Mode: initial_load)
2025-04-19 14:44:31,834 - WARNING - [load_data_to_table] DF for financials_income_quarterly (MSFT) has extra columns not in DB schema: ['Tax_Effect_Of_Unusual_Items', 'Tax_Rate_For_Calcs', 'Normalized_EBITDA', 'Total_Unusual_Items', 'Total_Unusual_Items_Excluding_Goodwill', 'Net_Income_From_Continuing_Operation_Net_Minority_Interest', 'Reconciled_Depreciation', 'Reconciled_Cost_Of_Revenue', 'Net_Interest_Income', 'Interest_Expense', 'Interest_Income', 'Normalized_Income', 'Net_Income_From_Continuing_And_Discontinued_Operation', 'Total_Expenses', 'Total_Operating_Income_As_Reported', 'Diluted_Average_Shares', 'Basic_Average_Shares', 'Diluted_EPS', 'Basic_EPS', 'Diluted_NI_Availto_Com_Stockholders', 'Net_Income_Common_Stockholders', 'Net_Income', 'Net_Income_Including_Noncontrolling_Interests', 'Net_Income_Continuous_Operations', 'Tax_Provision', 'Pretax_Income', 'Other_Income_Expense', 'Other_Non_Operating_Income_Expenses', 'Special_Income_Charges', 'Write_Off', 'Gain_On_Sale_Of_Security', 'Net_Non_Operating_Interest_Income_Expense', 'Interest_Expense_Non_Operating', 'Interest_Income_Non_Operating', 'Operating_Income', 'Operating_Expense', 'Research_And_Development', 'Selling_General_And_Administration', 'Selling_And_Marketing_Expense', 'General_And_Administrative_Expense', 'Other_Gand_A', 'Gross_Profit', 'Cost_Of_Revenue', 'Total_Revenue', 'Operating_Revenue']. These will be ignored.
2025-04-19 14:44:31,835 - WARNING - [load_data_to_table] Cols missing DF->financials_income_quarterly (MSFT): ['TaxEffectOfUnusualItems', 'TaxRateForCalcs', 'NormalizedEBITDA', 'TotalUnusualItems', 'TotalUnusualItemsExcludingGoodwill', 'NetIncomeFromContinuingOperationNetMinorityInterest', 'ReconciledDepreciation', 'ReconciledCostOfRevenue', 'NetInterestIncome', 'InterestExpense', 'InterestIncome', 'NormalizedIncome', 'NetIncomeFromContinuingAndDiscontinuedOperation', 'TotalExpenses', 'TotalOperatingIncomeAsReported', 'DilutedAverageShares', 'BasicAverageShares', 'DilutedEPS', 'BasicEPS', 'DilutedNIAvailtoComStockholders', 'NetIncomeCommonStockholders', 'NetIncome', 'NetIncomeIncludingNoncontrollingInterests', 'NetIncomeContinuousOperations', 'TaxProvision', 'PretaxIncome', 'OtherIncomeExpense', 'OtherNonOperatingIncomeExpenses', 'SpecialIncomeCharges', 'EarningsFromEquityInterest', 'GainOnSaleOfSecurity', 'NetNonOperatingInterestIncomeExpense', 'InterestExpenseNonOperating', 'InterestIncomeNonOperating', 'OperatingIncome', 'OperatingExpense', 'ResearchAndDevelopment', 'SellingGeneralAndAdministration', 'SellingAndMarketingExpense', 'GeneralAndAdministrativeExpense', 'OtherGandA', 'GrossProfit', 'CostOfRevenue', 'TotalRevenue', 'OperatingRevenue']. Inserting NULL.
2025-04-19 14:44:31,866 - INFO - [load_data_to_table] Loading 4 rows into financials_balance_annual for ticker MSFT (Mode: initial_load)
2025-04-19 14:44:31,867 - WARNING - [load_data_to_table] DF for financials_balance_annual (MSFT) has extra columns not in DB schema: ['Ordinary_Shares_Number', 'Share_Issued', 'Net_Debt', 'Total_Debt', 'Tangible_Book_Value', 'Invested_Capital', 'Working_Capital', 'Net_Tangible_Assets', 'Capital_Lease_Obligations', 'Common_Stock_Equity', 'Total_Capitalization', 'Total_Equity_Gross_Minority_Interest', 'Stockholders_Equity', 'Gains_Losses_Not_Affecting_Retained_Earnings', 'Other_Equity_Adjustments', 'Retained_Earnings', 'Capital_Stock', 'Common_Stock', 'Total_Liabilities_Net_Minority_Interest', 'Total_Non_Current_Liabilities_Net_Minority_Interest', 'Other_Non_Current_Liabilities', 'Tradeand_Other_Payables_Non_Current', 'Non_Current_Deferred_Liabilities', 'Non_Current_Deferred_Revenue', 'Non_Current_Deferred_Taxes_Liabilities', 'Long_Term_Debt_And_Capital_Lease_Obligation', 'Long_Term_Capital_Lease_Obligation', 'Long_Term_Debt', 'Current_Liabilities', 'Other_Current_Liabilities', 'Current_Deferred_Liabilities', 'Current_Deferred_Revenue', 'Current_Debt_And_Capital_Lease_Obligation', 'Current_Debt', 'Other_Current_Borrowings', 'Commercial_Paper', 'Pensionand_Other_Post_Retirement_Benefit_Plans_Current', 'Payables_And_Accrued_Expenses', 'Total_Tax_Payable', 'Income_Tax_Payable', 'Accounts_Payable', 'Total_Assets', 'Total_Non_Current_Assets', 'Other_Non_Current_Assets', 'Financial_Assets', 'Investments_And_Advances', 'Investmentin_Financial_Assets', 'Available_For_Sale_Securities', 'Long_Term_Equity_Investment', 'Goodwill_And_Other_Intangible_Assets', 'Other_Intangible_Assets', 'Net_PPE', 'Accumulated_Depreciation', 'Gross_PPE', 'Other_Properties', 'Machinery_Furniture_Equipment', 'Buildings_And_Improvements', 'Land_And_Improvements', 'Current_Assets', 'Other_Current_Assets', 'Hedging_Assets_Current', 'Finished_Goods', 'Work_In_Process', 'Raw_Materials', 'Accounts_Receivable', 'Allowance_For_Doubtful_Accounts_Receivable', 'Gross_Accounts_Receivable', 'Cash_Cash_Equivalents_And_Short_Term_Investments', 'Other_Short_Term_Investments', 'Cash_And_Cash_Equivalents', 'Cash_Equivalents', 'Cash_Financial']. These will be ignored.
2025-04-19 14:44:31,867 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_annual (MSFT): ['TreasurySharesNumber', 'OrdinarySharesNumber', 'ShareIssued', 'TotalDebt', 'TangibleBookValue', 'InvestedCapital', 'WorkingCapital', 'NetTangibleAssets', 'CapitalLeaseObligations', 'CommonStockEquity', 'TotalCapitalization', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'GainsLossesNotAffectingRetainedEarnings', 'OtherEquityAdjustments', 'RetainedEarnings', 'CapitalStock', 'CommonStock', 'PreferredStock', 'TotalLiabilitiesNetMinorityInterest', 'TotalNonCurrentLiabilitiesNetMinorityInterest', 'OtherNonCurrentLiabilities', 'TradeandOtherPayablesNonCurrent', 'NonCurrentDeferredLiabilities', 'NonCurrentDeferredRevenue', 'NonCurrentDeferredTaxesLiabilities', 'LongTermDebtAndCapitalLeaseObligation', 'LongTermCapitalLeaseObligation', 'LongTermDebt', 'CurrentLiabilities', 'OtherCurrentLiabilities', 'CurrentDeferredLiabilities', 'CurrentDeferredRevenue', 'CurrentDebtAndCapitalLeaseObligation', 'CurrentCapitalLeaseObligation', 'PensionandOtherPostRetirementBenefitPlansCurrent', 'PayablesAndAccruedExpenses', 'CurrentAccruedExpenses', 'OtherPayable', 'TotalTaxPayable', 'IncomeTaxPayable', 'AccountsPayable', 'TotalAssets', 'TotalNonCurrentAssets', 'OtherNonCurrentAssets', 'NonCurrentDeferredAssets', 'NonCurrentDeferredTaxesAssets', 'InvestmentsAndAdvances', 'InvestmentinFinancialAssets', 'AvailableForSaleSecurities', 'GoodwillAndOtherIntangibleAssets', 'OtherIntangibleAssets', 'NetPPE', 'AccumulatedDepreciation', 'GrossPPE', 'ConstructionInProgress', 'OtherProperties', 'MachineryFurnitureEquipment', 'BuildingsAndImprovements', 'LandAndImprovements', 'CurrentAssets', 'OtherCurrentAssets', 'TaxesReceivable', 'AccountsReceivable', 'AllowanceForDoubtfulAccountsReceivable', 'GrossAccountsReceivable', 'CashCashEquivalentsAndShortTermInvestments', 'OtherShortTermInvestments', 'CashAndCashEquivalents', 'CashEquivalents', 'CashFinancial']. Inserting NULL.
2025-04-19 14:44:31,906 - INFO - [load_data_to_table] Loading 6 rows into financials_balance_quarterly for ticker MSFT (Mode: initial_load)
2025-04-19 14:44:31,907 - WARNING - [load_data_to_table] DF for financials_balance_quarterly (MSFT) has extra columns not in DB schema: ['Ordinary_Shares_Number', 'Share_Issued', 'Net_Debt', 'Total_Debt', 'Tangible_Book_Value', 'Invested_Capital', 'Working_Capital', 'Net_Tangible_Assets', 'Capital_Lease_Obligations', 'Common_Stock_Equity', 'Total_Capitalization', 'Total_Equity_Gross_Minority_Interest', 'Stockholders_Equity', 'Gains_Losses_Not_Affecting_Retained_Earnings', 'Other_Equity_Adjustments', 'Retained_Earnings', 'Capital_Stock', 'Common_Stock', 'Total_Liabilities_Net_Minority_Interest', 'Total_Non_Current_Liabilities_Net_Minority_Interest', 'Other_Non_Current_Liabilities', 'Tradeand_Other_Payables_Non_Current', 'Non_Current_Deferred_Liabilities', 'Non_Current_Deferred_Revenue', 'Non_Current_Deferred_Taxes_Liabilities', 'Long_Term_Debt_And_Capital_Lease_Obligation', 'Long_Term_Capital_Lease_Obligation', 'Long_Term_Debt', 'Current_Liabilities', 'Other_Current_Liabilities', 'Current_Deferred_Liabilities', 'Current_Deferred_Revenue', 'Current_Debt_And_Capital_Lease_Obligation', 'Current_Debt', 'Other_Current_Borrowings', 'Commercial_Paper', 'Pensionand_Other_Post_Retirement_Benefit_Plans_Current', 'Payables_And_Accrued_Expenses', 'Total_Tax_Payable', 'Income_Tax_Payable', 'Accounts_Payable', 'Total_Assets', 'Total_Non_Current_Assets', 'Other_Non_Current_Assets', 'Financial_Assets', 'Investments_And_Advances', 'Investmentin_Financial_Assets', 'Available_For_Sale_Securities', 'Long_Term_Equity_Investment', 'Goodwill_And_Other_Intangible_Assets', 'Other_Intangible_Assets', 'Net_PPE', 'Accumulated_Depreciation', 'Gross_PPE', 'Other_Properties', 'Machinery_Furniture_Equipment', 'Buildings_And_Improvements', 'Land_And_Improvements', 'Current_Assets', 'Other_Current_Assets', 'Hedging_Assets_Current', 'Finished_Goods', 'Work_In_Process', 'Raw_Materials', 'Accounts_Receivable', 'Allowance_For_Doubtful_Accounts_Receivable', 'Gross_Accounts_Receivable', 'Cash_Cash_Equivalents_And_Short_Term_Investments', 'Other_Short_Term_Investments', 'Cash_And_Cash_Equivalents', 'Cash_Equivalents', 'Cash_Financial']. These will be ignored.
2025-04-19 14:44:31,908 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_quarterly (MSFT): ['TreasurySharesNumber', 'OrdinarySharesNumber', 'ShareIssued', 'TotalDebt', 'TangibleBookValue', 'InvestedCapital', 'WorkingCapital', 'NetTangibleAssets', 'CapitalLeaseObligations', 'CommonStockEquity', 'TotalCapitalization', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'GainsLossesNotAffectingRetainedEarnings', 'OtherEquityAdjustments', 'RetainedEarnings', 'CapitalStock', 'CommonStock', 'PreferredStock', 'TotalLiabilitiesNetMinorityInterest', 'TotalNonCurrentLiabilitiesNetMinorityInterest', 'OtherNonCurrentLiabilities', 'TradeandOtherPayablesNonCurrent', 'NonCurrentDeferredLiabilities', 'NonCurrentDeferredRevenue', 'NonCurrentDeferredTaxesLiabilities', 'LongTermDebtAndCapitalLeaseObligation', 'LongTermCapitalLeaseObligation', 'LongTermDebt', 'CurrentLiabilities', 'OtherCurrentLiabilities', 'CurrentDeferredLiabilities', 'CurrentDeferredRevenue', 'CurrentDebtAndCapitalLeaseObligation', 'CurrentCapitalLeaseObligation', 'PensionandOtherPostRetirementBenefitPlansCurrent', 'PayablesAndAccruedExpenses', 'CurrentAccruedExpenses', 'OtherPayable', 'TotalTaxPayable', 'IncomeTaxPayable', 'AccountsPayable', 'TotalAssets', 'TotalNonCurrentAssets', 'OtherNonCurrentAssets', 'NonCurrentDeferredAssets', 'NonCurrentDeferredTaxesAssets', 'InvestmentsAndAdvances', 'InvestmentinFinancialAssets', 'AvailableForSaleSecurities', 'GoodwillAndOtherIntangibleAssets', 'OtherIntangibleAssets', 'NetPPE', 'AccumulatedDepreciation', 'GrossPPE', 'ConstructionInProgress', 'OtherProperties', 'MachineryFurnitureEquipment', 'BuildingsAndImprovements', 'LandAndImprovements', 'CurrentAssets', 'OtherCurrentAssets', 'TaxesReceivable', 'AccountsReceivable', 'AllowanceForDoubtfulAccountsReceivable', 'GrossAccountsReceivable', 'CashCashEquivalentsAndShortTermInvestments', 'OtherShortTermInvestments', 'CashAndCashEquivalents', 'CashEquivalents', 'CashFinancial']. Inserting NULL.
2025-04-19 14:44:31,943 - INFO - [load_data_to_table] Loading 5 rows into financials_cashflow_annual for ticker MSFT (Mode: initial_load)
2025-04-19 14:44:31,944 - WARNING - [load_data_to_table] DF for financials_cashflow_annual (MSFT) has extra columns not in DB schema: ['Free_Cash_Flow', 'Repurchase_Of_Capital_Stock', 'Repayment_Of_Debt', 'Issuance_Of_Debt', 'Issuance_Of_Capital_Stock', 'Capital_Expenditure', 'End_Cash_Position', 'Beginning_Cash_Position', 'Effect_Of_Exchange_Rate_Changes', 'Changes_In_Cash', 'Financing_Cash_Flow', 'Cash_Flow_From_Continuing_Financing_Activities', 'Net_Other_Financing_Charges', 'Cash_Dividends_Paid', 'Common_Stock_Dividend_Paid', 'Net_Common_Stock_Issuance', 'Common_Stock_Payments', 'Common_Stock_Issuance', 'Net_Issuance_Payments_Of_Debt', 'Net_Short_Term_Debt_Issuance', 'Short_Term_Debt_Payments', 'Short_Term_Debt_Issuance', 'Net_Long_Term_Debt_Issuance', 'Long_Term_Debt_Payments', 'Long_Term_Debt_Issuance', 'Investing_Cash_Flow', 'Cash_Flow_From_Continuing_Investing_Activities', 'Net_Other_Investing_Changes', 'Net_Investment_Purchase_And_Sale', 'Sale_Of_Investment', 'Purchase_Of_Investment', 'Net_Business_Purchase_And_Sale', 'Purchase_Of_Business', 'Net_PPE_Purchase_And_Sale', 'Purchase_Of_PPE', 'Operating_Cash_Flow', 'Cash_Flow_From_Continuing_Operating_Activities', 'Change_In_Working_Capital', 'Change_In_Other_Working_Capital', 'Change_In_Other_Current_Liabilities', 'Change_In_Other_Current_Assets', 'Change_In_Payables_And_Accrued_Expense', 'Change_In_Payable', 'Change_In_Account_Payable', 'Change_In_Tax_Payable', 'Change_In_Income_Tax_Payable', 'Change_In_Inventory', 'Change_In_Receivables', 'Changes_In_Account_Receivables', 'Stock_Based_Compensation', 'Unrealized_Gain_Loss_On_Investment_Securities', 'Asset_Impairment_Charge', 'Deferred_Tax', 'Deferred_Income_Tax', 'Depreciation_Amortization_Depletion', 'Depreciation_And_Amortization', 'Operating_Gains_Losses', 'Gain_Loss_On_Investment_Securities', 'Net_Income_From_Continuing_Operations']. These will be ignored.
2025-04-19 14:44:31,944 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_annual (MSFT): ['FreeCashFlow', 'RepurchaseOfCapitalStock', 'RepaymentOfDebt', 'IssuanceOfDebt', 'CapitalExpenditure', 'IncomeTaxPaidSupplementalData', 'EndCashPosition', 'BeginningCashPosition', 'EffectOfExchangeRateChanges', 'ChangesInCash', 'FinancingCashFlow', 'CashFlowFromContinuingFinancingActivities', 'NetOtherFinancingCharges', 'ProceedsFromStockOptionExercised', 'CashDividendsPaid', 'CommonStockDividendPaid', 'NetCommonStockIssuance', 'CommonStockPayments', 'NetIssuancePaymentsOfDebt', 'NetLongTermDebtIssuance', 'LongTermDebtPayments', 'LongTermDebtIssuance', 'InvestingCashFlow', 'CashFlowFromContinuingInvestingActivities', 'NetOtherInvestingChanges', 'NetInvestmentPurchaseAndSale', 'SaleOfInvestment', 'PurchaseOfInvestment', 'NetBusinessPurchaseAndSale', 'PurchaseOfBusiness', 'NetPPEPurchaseAndSale', 'PurchaseOfPPE', 'OperatingCashFlow', 'CashFlowFromContinuingOperatingActivities', 'ChangeInWorkingCapital', 'ChangeInOtherWorkingCapital', 'ChangeInOtherCurrentAssets', 'ChangeInPayablesAndAccruedExpense', 'ChangeInAccruedExpense', 'ChangeInPayable', 'ChangeInAccountPayable', 'ChangeInReceivables', 'ChangesInAccountReceivables', 'OtherNonCashItems', 'StockBasedCompensation', 'DeferredTax', 'DeferredIncomeTax', 'DepreciationAmortizationDepletion', 'DepreciationAndAmortization', 'AmortizationCashFlow', 'AmortizationOfIntangibles', 'OperatingGainsLosses', 'GainLossOnInvestmentSecurities', 'NetIncomeFromContinuingOperations']. Inserting NULL.
2025-04-19 14:44:31,971 - INFO - [load_data_to_table] Loading 6 rows into financials_cashflow_quarterly for ticker MSFT (Mode: initial_load)
2025-04-19 14:44:31,972 - WARNING - [load_data_to_table] DF for financials_cashflow_quarterly (MSFT) has extra columns not in DB schema: ['Free_Cash_Flow', 'Repurchase_Of_Capital_Stock', 'Repayment_Of_Debt', 'Issuance_Of_Debt', 'Issuance_Of_Capital_Stock', 'Capital_Expenditure', 'End_Cash_Position', 'Beginning_Cash_Position', 'Effect_Of_Exchange_Rate_Changes', 'Changes_In_Cash', 'Financing_Cash_Flow', 'Cash_Flow_From_Continuing_Financing_Activities', 'Net_Other_Financing_Charges', 'Cash_Dividends_Paid', 'Common_Stock_Dividend_Paid', 'Net_Common_Stock_Issuance', 'Common_Stock_Payments', 'Common_Stock_Issuance', 'Net_Issuance_Payments_Of_Debt', 'Net_Short_Term_Debt_Issuance', 'Short_Term_Debt_Issuance', 'Net_Long_Term_Debt_Issuance', 'Long_Term_Debt_Payments', 'Long_Term_Debt_Issuance', 'Investing_Cash_Flow', 'Cash_Flow_From_Continuing_Investing_Activities', 'Net_Other_Investing_Changes', 'Net_Investment_Purchase_And_Sale', 'Sale_Of_Investment', 'Purchase_Of_Investment', 'Net_Business_Purchase_And_Sale', 'Purchase_Of_Business', 'Net_PPE_Purchase_And_Sale', 'Purchase_Of_PPE', 'Operating_Cash_Flow', 'Cash_Flow_From_Continuing_Operating_Activities', 'Change_In_Working_Capital', 'Change_In_Other_Working_Capital', 'Change_In_Other_Current_Liabilities', 'Change_In_Other_Current_Assets', 'Change_In_Payables_And_Accrued_Expense', 'Change_In_Payable', 'Change_In_Account_Payable', 'Change_In_Tax_Payable', 'Change_In_Income_Tax_Payable', 'Change_In_Inventory', 'Change_In_Receivables', 'Changes_In_Account_Receivables', 'Stock_Based_Compensation', 'Unrealized_Gain_Loss_On_Investment_Securities', 'Asset_Impairment_Charge', 'Deferred_Tax', 'Deferred_Income_Tax', 'Depreciation_Amortization_Depletion', 'Depreciation_And_Amortization', 'Operating_Gains_Losses', 'Gain_Loss_On_Investment_Securities', 'Net_Income_From_Continuing_Operations']. These will be ignored.
2025-04-19 14:44:31,972 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_quarterly (MSFT): ['FreeCashFlow', 'RepurchaseOfCapitalStock', 'RepaymentOfDebt', 'IssuanceOfDebt', 'CapitalExpenditure', 'IncomeTaxPaidSupplementalData', 'EndCashPosition', 'BeginningCashPosition', 'EffectOfExchangeRateChanges', 'ChangesInCash', 'FinancingCashFlow', 'CashFlowFromContinuingFinancingActivities', 'NetOtherFinancingCharges', 'ProceedsFromStockOptionExercised', 'CashDividendsPaid', 'CommonStockDividendPaid', 'NetCommonStockIssuance', 'CommonStockPayments', 'NetIssuancePaymentsOfDebt', 'NetLongTermDebtIssuance', 'LongTermDebtPayments', 'LongTermDebtIssuance', 'InvestingCashFlow', 'CashFlowFromContinuingInvestingActivities', 'NetOtherInvestingChanges', 'NetInvestmentPurchaseAndSale', 'SaleOfInvestment', 'PurchaseOfInvestment', 'NetBusinessPurchaseAndSale', 'PurchaseOfBusiness', 'NetPPEPurchaseAndSale', 'PurchaseOfPPE', 'OperatingCashFlow', 'CashFlowFromContinuingOperatingActivities', 'ChangeInWorkingCapital', 'ChangeInOtherWorkingCapital', 'ChangeInOtherCurrentAssets', 'ChangeInPayablesAndAccruedExpense', 'ChangeInAccruedExpense', 'ChangeInPayable', 'ChangeInAccountPayable', 'ChangeInReceivables', 'ChangesInAccountReceivables', 'OtherNonCashItems', 'StockBasedCompensation', 'DeferredTax', 'DeferredIncomeTax', 'DepreciationAmortizationDepletion', 'DepreciationAndAmortization', 'AmortizationCashFlow', 'AmortizationOfIntangibles', 'OperatingGainsLosses', 'GainLossOnInvestmentSecurities', 'NetIncomeFromContinuingOperations']. Inserting NULL.
2025-04-19 14:44:31,998 - INFO - [load_data_to_table] Loading 94 rows into stock_actions for ticker MSFT (Mode: initial_load)
2025-04-19 14:44:35,189 - INFO - [load_data_to_table] Loading 1 rows into company_profile for ticker GOOG (Mode: initial_load)
2025-04-19 14:44:35,196 - INFO - [load_data_to_table] Loading 1 rows into company_key_metrics for ticker GOOG (Mode: initial_load)
2025-04-19 14:44:35,205 - INFO - [load_data_to_table] Loading 5 rows into financials_income_annual for ticker GOOG (Mode: initial_load)
2025-04-19 14:44:35,206 - WARNING - [load_data_to_table] DF for financials_income_annual (GOOG) has extra columns not in DB schema: ['Tax_Effect_Of_Unusual_Items', 'Tax_Rate_For_Calcs', 'Normalized_EBITDA', 'Total_Unusual_Items', 'Total_Unusual_Items_Excluding_Goodwill', 'Net_Income_From_Continuing_Operation_Net_Minority_Interest', 'Reconciled_Depreciation', 'Reconciled_Cost_Of_Revenue', 'Net_Interest_Income', 'Interest_Expense', 'Interest_Income', 'Normalized_Income', 'Net_Income_From_Continuing_And_Discontinued_Operation', 'Total_Expenses', 'Total_Operating_Income_As_Reported', 'Diluted_Average_Shares', 'Basic_Average_Shares', 'Diluted_EPS', 'Basic_EPS', 'Diluted_NI_Availto_Com_Stockholders', 'Net_Income_Common_Stockholders', 'Net_Income', 'Net_Income_Including_Noncontrolling_Interests', 'Net_Income_Continuous_Operations', 'Tax_Provision', 'Pretax_Income', 'Other_Income_Expense', 'Other_Non_Operating_Income_Expenses', 'Special_Income_Charges', 'Earnings_From_Equity_Interest', 'Gain_On_Sale_Of_Security', 'Net_Non_Operating_Interest_Income_Expense', 'Interest_Expense_Non_Operating', 'Interest_Income_Non_Operating', 'Operating_Income', 'Operating_Expense', 'Research_And_Development', 'Selling_General_And_Administration', 'Selling_And_Marketing_Expense', 'General_And_Administrative_Expense', 'Other_Gand_A', 'Gross_Profit', 'Cost_Of_Revenue', 'Total_Revenue', 'Operating_Revenue']. These will be ignored.
2025-04-19 14:44:35,206 - WARNING - [load_data_to_table] Cols missing DF->financials_income_annual (GOOG): ['TaxEffectOfUnusualItems', 'TaxRateForCalcs', 'NormalizedEBITDA', 'TotalUnusualItems', 'TotalUnusualItemsExcludingGoodwill', 'NetIncomeFromContinuingOperationNetMinorityInterest', 'ReconciledDepreciation', 'ReconciledCostOfRevenue', 'NetInterestIncome', 'InterestExpense', 'InterestIncome', 'NormalizedIncome', 'NetIncomeFromContinuingAndDiscontinuedOperation', 'TotalExpenses', 'TotalOperatingIncomeAsReported', 'DilutedAverageShares', 'BasicAverageShares', 'DilutedEPS', 'BasicEPS', 'DilutedNIAvailtoComStockholders', 'NetIncomeCommonStockholders', 'NetIncome', 'NetIncomeIncludingNoncontrollingInterests', 'NetIncomeContinuousOperations', 'TaxProvision', 'PretaxIncome', 'OtherIncomeExpense', 'OtherNonOperatingIncomeExpenses', 'SpecialIncomeCharges', 'EarningsFromEquityInterest', 'GainOnSaleOfSecurity', 'NetNonOperatingInterestIncomeExpense', 'InterestExpenseNonOperating', 'InterestIncomeNonOperating', 'OperatingIncome', 'OperatingExpense', 'ResearchAndDevelopment', 'SellingGeneralAndAdministration', 'SellingAndMarketingExpense', 'GeneralAndAdministrativeExpense', 'OtherGandA', 'GrossProfit', 'CostOfRevenue', 'TotalRevenue', 'OperatingRevenue']. Inserting NULL.
2025-04-19 14:44:35,229 - INFO - [load_data_to_table] Loading 6 rows into financials_income_quarterly for ticker GOOG (Mode: initial_load)
2025-04-19 14:44:35,230 - WARNING - [load_data_to_table] DF for financials_income_quarterly (GOOG) has extra columns not in DB schema: ['Tax_Effect_Of_Unusual_Items', 'Tax_Rate_For_Calcs', 'Normalized_EBITDA', 'Total_Unusual_Items', 'Total_Unusual_Items_Excluding_Goodwill', 'Net_Income_From_Continuing_Operation_Net_Minority_Interest', 'Reconciled_Depreciation', 'Reconciled_Cost_Of_Revenue', 'Net_Interest_Income', 'Interest_Expense', 'Interest_Income', 'Normalized_Income', 'Net_Income_From_Continuing_And_Discontinued_Operation', 'Total_Expenses', 'Total_Operating_Income_As_Reported', 'Diluted_Average_Shares', 'Basic_Average_Shares', 'Diluted_EPS', 'Basic_EPS', 'Diluted_NI_Availto_Com_Stockholders', 'Average_Dilution_Earnings', 'Net_Income_Common_Stockholders', 'Net_Income', 'Net_Income_Including_Noncontrolling_Interests', 'Net_Income_Continuous_Operations', 'Tax_Provision', 'Pretax_Income', 'Other_Income_Expense', 'Other_Non_Operating_Income_Expenses', 'Earnings_From_Equity_Interest', 'Gain_On_Sale_Of_Security', 'Net_Non_Operating_Interest_Income_Expense', 'Interest_Expense_Non_Operating', 'Interest_Income_Non_Operating', 'Operating_Income', 'Operating_Expense', 'Research_And_Development', 'Selling_General_And_Administration', 'Selling_And_Marketing_Expense', 'General_And_Administrative_Expense', 'Other_Gand_A', 'Gross_Profit', 'Cost_Of_Revenue', 'Total_Revenue', 'Operating_Revenue']. These will be ignored.
2025-04-19 14:44:35,231 - WARNING - [load_data_to_table] Cols missing DF->financials_income_quarterly (GOOG): ['TaxEffectOfUnusualItems', 'TaxRateForCalcs', 'NormalizedEBITDA', 'TotalUnusualItems', 'TotalUnusualItemsExcludingGoodwill', 'NetIncomeFromContinuingOperationNetMinorityInterest', 'ReconciledDepreciation', 'ReconciledCostOfRevenue', 'NetInterestIncome', 'InterestExpense', 'InterestIncome', 'NormalizedIncome', 'NetIncomeFromContinuingAndDiscontinuedOperation', 'TotalExpenses', 'TotalOperatingIncomeAsReported', 'DilutedAverageShares', 'BasicAverageShares', 'DilutedEPS', 'BasicEPS', 'DilutedNIAvailtoComStockholders', 'NetIncomeCommonStockholders', 'NetIncome', 'NetIncomeIncludingNoncontrollingInterests', 'NetIncomeContinuousOperations', 'TaxProvision', 'PretaxIncome', 'OtherIncomeExpense', 'OtherNonOperatingIncomeExpenses', 'SpecialIncomeCharges', 'EarningsFromEquityInterest', 'GainOnSaleOfSecurity', 'NetNonOperatingInterestIncomeExpense', 'InterestExpenseNonOperating', 'InterestIncomeNonOperating', 'OperatingIncome', 'OperatingExpense', 'ResearchAndDevelopment', 'SellingGeneralAndAdministration', 'SellingAndMarketingExpense', 'GeneralAndAdministrativeExpense', 'OtherGandA', 'GrossProfit', 'CostOfRevenue', 'TotalRevenue', 'OperatingRevenue']. Inserting NULL.
2025-04-19 14:44:35,253 - INFO - [load_data_to_table] Loading 5 rows into financials_balance_annual for ticker GOOG (Mode: initial_load)
2025-04-19 14:44:35,254 - WARNING - [load_data_to_table] DF for financials_balance_annual (GOOG) has extra columns not in DB schema: ['Treasury_Shares_Number', 'Ordinary_Shares_Number', 'Share_Issued', 'Total_Debt', 'Tangible_Book_Value', 'Invested_Capital', 'Working_Capital', 'Net_Tangible_Assets', 'Capital_Lease_Obligations', 'Common_Stock_Equity', 'Total_Capitalization', 'Total_Equity_Gross_Minority_Interest', 'Stockholders_Equity', 'Gains_Losses_Not_Affecting_Retained_Earnings', 'Other_Equity_Adjustments', 'Retained_Earnings', 'Capital_Stock', 'Common_Stock', 'Preferred_Stock', 'Total_Liabilities_Net_Minority_Interest', 'Total_Non_Current_Liabilities_Net_Minority_Interest', 'Other_Non_Current_Liabilities', 'Tradeand_Other_Payables_Non_Current', 'Non_Current_Deferred_Liabilities', 'Non_Current_Deferred_Revenue', 'Non_Current_Deferred_Taxes_Liabilities', 'Long_Term_Debt_And_Capital_Lease_Obligation', 'Long_Term_Capital_Lease_Obligation', 'Long_Term_Debt', 'Current_Liabilities', 'Other_Current_Liabilities', 'Current_Deferred_Liabilities', 'Current_Deferred_Revenue', 'Current_Debt_And_Capital_Lease_Obligation', 'Current_Capital_Lease_Obligation', 'Pensionand_Other_Post_Retirement_Benefit_Plans_Current', 'Payables_And_Accrued_Expenses', 'Current_Accrued_Expenses', 'Other_Payable', 'Total_Tax_Payable', 'Income_Tax_Payable', 'Accounts_Payable', 'Total_Assets', 'Total_Non_Current_Assets', 'Other_Non_Current_Assets', 'Non_Current_Deferred_Assets', 'Non_Current_Deferred_Taxes_Assets', 'Investments_And_Advances', 'Investmentin_Financial_Assets', 'Available_For_Sale_Securities', 'Goodwill_And_Other_Intangible_Assets', 'Other_Intangible_Assets', 'Net_PPE', 'Accumulated_Depreciation', 'Gross_PPE', 'Construction_In_Progress', 'Other_Properties', 'Machinery_Furniture_Equipment', 'Buildings_And_Improvements', 'Land_And_Improvements', 'Current_Assets', 'Other_Current_Assets', 'Taxes_Receivable', 'Accounts_Receivable', 'Allowance_For_Doubtful_Accounts_Receivable', 'Gross_Accounts_Receivable', 'Cash_Cash_Equivalents_And_Short_Term_Investments', 'Other_Short_Term_Investments', 'Cash_And_Cash_Equivalents']. These will be ignored.
2025-04-19 14:44:35,256 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_annual (GOOG): ['TreasurySharesNumber', 'OrdinarySharesNumber', 'ShareIssued', 'TotalDebt', 'TangibleBookValue', 'InvestedCapital', 'WorkingCapital', 'NetTangibleAssets', 'CapitalLeaseObligations', 'CommonStockEquity', 'TotalCapitalization', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'GainsLossesNotAffectingRetainedEarnings', 'OtherEquityAdjustments', 'RetainedEarnings', 'CapitalStock', 'CommonStock', 'PreferredStock', 'TotalLiabilitiesNetMinorityInterest', 'TotalNonCurrentLiabilitiesNetMinorityInterest', 'OtherNonCurrentLiabilities', 'TradeandOtherPayablesNonCurrent', 'NonCurrentDeferredLiabilities', 'NonCurrentDeferredRevenue', 'NonCurrentDeferredTaxesLiabilities', 'LongTermDebtAndCapitalLeaseObligation', 'LongTermCapitalLeaseObligation', 'LongTermDebt', 'CurrentLiabilities', 'OtherCurrentLiabilities', 'CurrentDeferredLiabilities', 'CurrentDeferredRevenue', 'CurrentDebtAndCapitalLeaseObligation', 'CurrentCapitalLeaseObligation', 'PensionandOtherPostRetirementBenefitPlansCurrent', 'PayablesAndAccruedExpenses', 'CurrentAccruedExpenses', 'OtherPayable', 'TotalTaxPayable', 'IncomeTaxPayable', 'AccountsPayable', 'TotalAssets', 'TotalNonCurrentAssets', 'OtherNonCurrentAssets', 'NonCurrentDeferredAssets', 'NonCurrentDeferredTaxesAssets', 'InvestmentsAndAdvances', 'InvestmentinFinancialAssets', 'AvailableForSaleSecurities', 'GoodwillAndOtherIntangibleAssets', 'OtherIntangibleAssets', 'NetPPE', 'AccumulatedDepreciation', 'GrossPPE', 'ConstructionInProgress', 'OtherProperties', 'MachineryFurnitureEquipment', 'BuildingsAndImprovements', 'LandAndImprovements', 'CurrentAssets', 'OtherCurrentAssets', 'TaxesReceivable', 'AccountsReceivable', 'AllowanceForDoubtfulAccountsReceivable', 'GrossAccountsReceivable', 'CashCashEquivalentsAndShortTermInvestments', 'OtherShortTermInvestments', 'CashAndCashEquivalents', 'CashEquivalents', 'CashFinancial']. Inserting NULL.
2025-04-19 14:44:35,292 - INFO - [load_data_to_table] Loading 6 rows into financials_balance_quarterly for ticker GOOG (Mode: initial_load)
2025-04-19 14:44:35,294 - WARNING - [load_data_to_table] DF for financials_balance_quarterly (GOOG) has extra columns not in DB schema: ['Treasury_Shares_Number', 'Ordinary_Shares_Number', 'Share_Issued', 'Total_Debt', 'Tangible_Book_Value', 'Invested_Capital', 'Working_Capital', 'Net_Tangible_Assets', 'Capital_Lease_Obligations', 'Common_Stock_Equity', 'Total_Capitalization', 'Total_Equity_Gross_Minority_Interest', 'Stockholders_Equity', 'Gains_Losses_Not_Affecting_Retained_Earnings', 'Other_Equity_Adjustments', 'Retained_Earnings', 'Capital_Stock', 'Common_Stock', 'Preferred_Stock', 'Total_Liabilities_Net_Minority_Interest', 'Total_Non_Current_Liabilities_Net_Minority_Interest', 'Other_Non_Current_Liabilities', 'Tradeand_Other_Payables_Non_Current', 'Non_Current_Deferred_Liabilities', 'Non_Current_Deferred_Revenue', 'Non_Current_Deferred_Taxes_Liabilities', 'Long_Term_Debt_And_Capital_Lease_Obligation', 'Long_Term_Capital_Lease_Obligation', 'Long_Term_Debt', 'Current_Liabilities', 'Other_Current_Liabilities', 'Current_Deferred_Liabilities', 'Current_Deferred_Revenue', 'Current_Debt_And_Capital_Lease_Obligation', 'Current_Capital_Lease_Obligation', 'Pensionand_Other_Post_Retirement_Benefit_Plans_Current', 'Payables_And_Accrued_Expenses', 'Current_Accrued_Expenses', 'Total_Tax_Payable', 'Income_Tax_Payable', 'Accounts_Payable', 'Total_Assets', 'Total_Non_Current_Assets', 'Other_Non_Current_Assets', 'Non_Current_Deferred_Assets', 'Non_Current_Deferred_Taxes_Assets', 'Investments_And_Advances', 'Investmentin_Financial_Assets', 'Available_For_Sale_Securities', 'Goodwill_And_Other_Intangible_Assets', 'Other_Intangible_Assets', 'Net_PPE', 'Accumulated_Depreciation', 'Gross_PPE', 'Construction_In_Progress', 'Other_Properties', 'Machinery_Furniture_Equipment', 'Buildings_And_Improvements', 'Land_And_Improvements', 'Current_Assets', 'Other_Current_Assets', 'Accounts_Receivable', 'Allowance_For_Doubtful_Accounts_Receivable', 'Gross_Accounts_Receivable', 'Cash_Cash_Equivalents_And_Short_Term_Investments', 'Other_Short_Term_Investments', 'Cash_And_Cash_Equivalents', 'Cash_Equivalents', 'Cash_Financial']. These will be ignored.
2025-04-19 14:44:35,295 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_quarterly (GOOG): ['TreasurySharesNumber', 'OrdinarySharesNumber', 'ShareIssued', 'TotalDebt', 'TangibleBookValue', 'InvestedCapital', 'WorkingCapital', 'NetTangibleAssets', 'CapitalLeaseObligations', 'CommonStockEquity', 'TotalCapitalization', 'TotalEquityGrossMinorityInterest', 'StockholdersEquity', 'GainsLossesNotAffectingRetainedEarnings', 'OtherEquityAdjustments', 'RetainedEarnings', 'CapitalStock', 'CommonStock', 'PreferredStock', 'TotalLiabilitiesNetMinorityInterest', 'TotalNonCurrentLiabilitiesNetMinorityInterest', 'OtherNonCurrentLiabilities', 'TradeandOtherPayablesNonCurrent', 'NonCurrentDeferredLiabilities', 'NonCurrentDeferredRevenue', 'NonCurrentDeferredTaxesLiabilities', 'LongTermDebtAndCapitalLeaseObligation', 'LongTermCapitalLeaseObligation', 'LongTermDebt', 'CurrentLiabilities', 'OtherCurrentLiabilities', 'CurrentDeferredLiabilities', 'CurrentDeferredRevenue', 'CurrentDebtAndCapitalLeaseObligation', 'CurrentCapitalLeaseObligation', 'PensionandOtherPostRetirementBenefitPlansCurrent', 'PayablesAndAccruedExpenses', 'CurrentAccruedExpenses', 'OtherPayable', 'TotalTaxPayable', 'IncomeTaxPayable', 'AccountsPayable', 'TotalAssets', 'TotalNonCurrentAssets', 'OtherNonCurrentAssets', 'NonCurrentDeferredAssets', 'NonCurrentDeferredTaxesAssets', 'InvestmentsAndAdvances', 'InvestmentinFinancialAssets', 'AvailableForSaleSecurities', 'GoodwillAndOtherIntangibleAssets', 'OtherIntangibleAssets', 'NetPPE', 'AccumulatedDepreciation', 'GrossPPE', 'ConstructionInProgress', 'OtherProperties', 'MachineryFurnitureEquipment', 'BuildingsAndImprovements', 'LandAndImprovements', 'CurrentAssets', 'OtherCurrentAssets', 'TaxesReceivable', 'AccountsReceivable', 'AllowanceForDoubtfulAccountsReceivable', 'GrossAccountsReceivable', 'CashCashEquivalentsAndShortTermInvestments', 'OtherShortTermInvestments', 'CashAndCashEquivalents', 'CashEquivalents', 'CashFinancial']. Inserting NULL.
2025-04-19 14:44:35,328 - INFO - [load_data_to_table] Loading 5 rows into financials_cashflow_annual for ticker GOOG (Mode: initial_load)
2025-04-19 14:44:35,329 - WARNING - [load_data_to_table] DF for financials_cashflow_annual (GOOG) has extra columns not in DB schema: ['Free_Cash_Flow', 'Repurchase_Of_Capital_Stock', 'Repayment_Of_Debt', 'Issuance_Of_Debt', 'Capital_Expenditure', 'Income_Tax_Paid_Supplemental_Data', 'End_Cash_Position', 'Beginning_Cash_Position', 'Effect_Of_Exchange_Rate_Changes', 'Changes_In_Cash', 'Financing_Cash_Flow', 'Cash_Flow_From_Continuing_Financing_Activities', 'Net_Other_Financing_Charges', 'Proceeds_From_Stock_Option_Exercised', 'Cash_Dividends_Paid', 'Common_Stock_Dividend_Paid', 'Net_Common_Stock_Issuance', 'Common_Stock_Payments', 'Net_Issuance_Payments_Of_Debt', 'Net_Long_Term_Debt_Issuance', 'Long_Term_Debt_Payments', 'Long_Term_Debt_Issuance', 'Investing_Cash_Flow', 'Cash_Flow_From_Continuing_Investing_Activities', 'Net_Other_Investing_Changes', 'Net_Investment_Purchase_And_Sale', 'Sale_Of_Investment', 'Purchase_Of_Investment', 'Net_Business_Purchase_And_Sale', 'Purchase_Of_Business', 'Net_PPE_Purchase_And_Sale', 'Purchase_Of_PPE', 'Operating_Cash_Flow', 'Cash_Flow_From_Continuing_Operating_Activities', 'Change_In_Working_Capital', 'Change_In_Other_Working_Capital', 'Change_In_Other_Current_Assets', 'Change_In_Payables_And_Accrued_Expense', 'Change_In_Accrued_Expense', 'Change_In_Payable', 'Change_In_Account_Payable', 'Change_In_Receivables', 'Changes_In_Account_Receivables', 'Other_Non_Cash_Items', 'Stock_Based_Compensation', 'Deferred_Tax', 'Deferred_Income_Tax', 'Depreciation_Amortization_Depletion', 'Depreciation_And_Amortization', 'Amortization_Cash_Flow', 'Amortization_Of_Intangibles', 'Operating_Gains_Losses', 'Gain_Loss_On_Investment_Securities', 'Net_Income_From_Continuing_Operations']. These will be ignored.
2025-04-19 14:44:35,329 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_annual (GOOG): ['FreeCashFlow', 'RepurchaseOfCapitalStock', 'RepaymentOfDebt', 'IssuanceOfDebt', 'CapitalExpenditure', 'IncomeTaxPaidSupplementalData', 'EndCashPosition', 'BeginningCashPosition', 'EffectOfExchangeRateChanges', 'ChangesInCash', 'FinancingCashFlow', 'CashFlowFromContinuingFinancingActivities', 'NetOtherFinancingCharges', 'ProceedsFromStockOptionExercised', 'CashDividendsPaid', 'CommonStockDividendPaid', 'NetCommonStockIssuance', 'CommonStockPayments', 'NetIssuancePaymentsOfDebt', 'NetLongTermDebtIssuance', 'LongTermDebtPayments', 'LongTermDebtIssuance', 'InvestingCashFlow', 'CashFlowFromContinuingInvestingActivities', 'NetOtherInvestingChanges', 'NetInvestmentPurchaseAndSale', 'SaleOfInvestment', 'PurchaseOfInvestment', 'NetBusinessPurchaseAndSale', 'PurchaseOfBusiness', 'NetPPEPurchaseAndSale', 'PurchaseOfPPE', 'OperatingCashFlow', 'CashFlowFromContinuingOperatingActivities', 'ChangeInWorkingCapital', 'ChangeInOtherWorkingCapital', 'ChangeInOtherCurrentAssets', 'ChangeInPayablesAndAccruedExpense', 'ChangeInAccruedExpense', 'ChangeInPayable', 'ChangeInAccountPayable', 'ChangeInReceivables', 'ChangesInAccountReceivables', 'OtherNonCashItems', 'StockBasedCompensation', 'DeferredTax', 'DeferredIncomeTax', 'DepreciationAmortizationDepletion', 'DepreciationAndAmortization', 'AmortizationCashFlow', 'AmortizationOfIntangibles', 'OperatingGainsLosses', 'GainLossOnInvestmentSecurities', 'NetIncomeFromContinuingOperations']. Inserting NULL.
2025-04-19 14:44:35,354 - INFO - [load_data_to_table] Loading 6 rows into financials_cashflow_quarterly for ticker GOOG (Mode: initial_load)
2025-04-19 14:44:35,355 - WARNING - [load_data_to_table] DF for financials_cashflow_quarterly (GOOG) has extra columns not in DB schema: ['Free_Cash_Flow', 'Repurchase_Of_Capital_Stock', 'Repayment_Of_Debt', 'Issuance_Of_Debt', 'Capital_Expenditure', 'End_Cash_Position', 'Beginning_Cash_Position', 'Effect_Of_Exchange_Rate_Changes', 'Changes_In_Cash', 'Financing_Cash_Flow', 'Cash_Flow_From_Continuing_Financing_Activities', 'Net_Other_Financing_Charges', 'Proceeds_From_Stock_Option_Exercised', 'Cash_Dividends_Paid', 'Common_Stock_Dividend_Paid', 'Net_Common_Stock_Issuance', 'Common_Stock_Payments', 'Net_Issuance_Payments_Of_Debt', 'Net_Long_Term_Debt_Issuance', 'Long_Term_Debt_Payments', 'Long_Term_Debt_Issuance', 'Investing_Cash_Flow', 'Cash_Flow_From_Continuing_Investing_Activities', 'Net_Other_Investing_Changes', 'Net_Investment_Purchase_And_Sale', 'Sale_Of_Investment', 'Purchase_Of_Investment', 'Net_Business_Purchase_And_Sale', 'Purchase_Of_Business', 'Net_PPE_Purchase_And_Sale', 'Purchase_Of_PPE', 'Operating_Cash_Flow', 'Cash_Flow_From_Continuing_Operating_Activities', 'Change_In_Working_Capital', 'Change_In_Other_Working_Capital', 'Change_In_Other_Current_Assets', 'Change_In_Payables_And_Accrued_Expense', 'Change_In_Accrued_Expense', 'Change_In_Payable', 'Change_In_Account_Payable', 'Change_In_Receivables', 'Changes_In_Account_Receivables', 'Other_Non_Cash_Items', 'Stock_Based_Compensation', 'Deferred_Tax', 'Deferred_Income_Tax', 'Depreciation_Amortization_Depletion', 'Depreciation_And_Amortization', 'Amortization_Cash_Flow', 'Amortization_Of_Intangibles', 'Operating_Gains_Losses', 'Gain_Loss_On_Investment_Securities', 'Net_Income_From_Continuing_Operations']. These will be ignored.
2025-04-19 14:44:35,355 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_quarterly (GOOG): ['FreeCashFlow', 'RepurchaseOfCapitalStock', 'RepaymentOfDebt', 'IssuanceOfDebt', 'CapitalExpenditure', 'IncomeTaxPaidSupplementalData', 'EndCashPosition', 'BeginningCashPosition', 'EffectOfExchangeRateChanges', 'ChangesInCash', 'FinancingCashFlow', 'CashFlowFromContinuingFinancingActivities', 'NetOtherFinancingCharges', 'ProceedsFromStockOptionExercised', 'CashDividendsPaid', 'CommonStockDividendPaid', 'NetCommonStockIssuance', 'CommonStockPayments', 'NetIssuancePaymentsOfDebt', 'NetLongTermDebtIssuance', 'LongTermDebtPayments', 'LongTermDebtIssuance', 'InvestingCashFlow', 'CashFlowFromContinuingInvestingActivities', 'NetOtherInvestingChanges', 'NetInvestmentPurchaseAndSale', 'SaleOfInvestment', 'PurchaseOfInvestment', 'NetBusinessPurchaseAndSale', 'PurchaseOfBusiness', 'NetPPEPurchaseAndSale', 'PurchaseOfPPE', 'OperatingCashFlow', 'CashFlowFromContinuingOperatingActivities', 'ChangeInWorkingCapital', 'ChangeInOtherWorkingCapital', 'ChangeInOtherCurrentAssets', 'ChangeInPayablesAndAccruedExpense', 'ChangeInAccruedExpense', 'ChangeInPayable', 'ChangeInAccountPayable', 'ChangeInReceivables', 'ChangesInAccountReceivables', 'OtherNonCashItems', 'StockBasedCompensation', 'DeferredTax', 'DeferredIncomeTax', 'DepreciationAmortizationDepletion', 'DepreciationAndAmortization', 'AmortizationCashFlow', 'AmortizationOfIntangibles', 'OperatingGainsLosses', 'GainLossOnInvestmentSecurities', 'NetIncomeFromContinuingOperations']. Inserting NULL.
2025-04-19 14:44:35,380 - INFO - [load_data_to_table] Loading 7 rows into stock_actions for ticker GOOG (Mode: initial_load)
2025-04-19 14:44:37,151 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 14:44:37,151 - ERROR - [fetch_company_info] Failed processing .info NONEXISTENTTICKER: AttributeError-'NoneType' object has no attribute 'update'
2025-04-19 14:44:37,151 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=fetch_company_info returned None
2025-04-19 14:44:38,310 - INFO - [fetch_financial_statement] No annual financials data found for NONEXISTENTTICKER.
2025-04-19 14:44:38,311 - INFO - [fetch_financial_statement] No quarterly financials data found for NONEXISTENTTICKER.
2025-04-19 14:44:38,311 - INFO - [fetch_financial_statement] No annual balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 14:44:38,312 - INFO - [fetch_financial_statement] No quarterly balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 14:44:38,313 - INFO - [fetch_financial_statement] No annual cashflow data found for NONEXISTENTTICKER.
2025-04-19 14:44:38,313 - INFO - [fetch_financial_statement] No quarterly cashflow data found for NONEXISTENTTICKER.
2025-04-19 14:44:39,257 - ERROR - [fetch_stock_actions] Failed actions NONEXISTENTTICKER: TypeError - argument of type 'NoneType' is not iterable
2025-04-19 14:44:39,258 - WARNING - [run_stock_info_pipeline] Skip load NONEXISTENTTICKER due to fetch errors.
2025-04-19 14:44:39,273 - INFO - [run_stock_info_pipeline] DB connection closed.
2025-04-19 14:44:39,273 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 14:44:39,274 - INFO - [run_stock_info_pipeline] Total Time: 14.08 sec
2025-04-19 14:44:39,274 - INFO - [run_stock_info_pipeline] Tickers Attempted: 4
2025-04-19 14:44:39,274 - INFO - [run_stock_info_pipeline] Tickers OK: 3
2025-04-19 14:44:39,274 - INFO - [run_stock_info_pipeline] Tickers Skip/Err: 1
2025-04-19 14:44:39,274 - INFO - [run_stock_info_pipeline] Fetch Errors: 8
2025-04-19 14:44:39,274 - INFO - [run_stock_info_pipeline] Load Errors: 0
2025-04-19 14:44:39,274 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors'.
2025-04-19 14:44:39,276 - INFO - [<module>] Script execution finished.
2025-04-19 14:47:36,294 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v2.7) ---
2025-04-19 14:47:36,295 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 14:47:36,295 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 14:47:36,295 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 14:47:36,295 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 14:47:36,328 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 14:47:36,329 - INFO - [setup_info_tables] Setting up supplementary tables...
2025-04-19 14:47:36,332 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 14:47:36,333 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 14:47:36,333 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 14:47:40,089 - INFO - [load_data_to_table] Loading 1 rows into company_profile for ticker AAPL (Mode: initial_load)
2025-04-19 14:47:40,098 - INFO - [load_data_to_table] Loading 1 rows into company_key_metrics for ticker AAPL (Mode: initial_load)
2025-04-19 14:47:40,108 - INFO - [load_data_to_table] Loading 5 rows into financials_income_annual for ticker AAPL (Mode: initial_load)
2025-04-19 14:47:40,112 - WARNING - [load_data_to_table] Cols missing DF->financials_income_annual (AAPL): ['Total_Unusual_Items', 'Total_Unusual_Items_Excluding_Goodwill', 'Special_Income_Charges', 'Earnings_From_Equity_Interest', 'Gain_On_Sale_Of_Security', 'Selling_And_Marketing_Expense', 'General_And_Administrative_Expense', 'Other_Gand_A']. Inserting NULL.
2025-04-19 14:47:40,135 - INFO - [load_data_to_table] Loading 6 rows into financials_income_quarterly for ticker AAPL (Mode: initial_load)
2025-04-19 14:47:40,137 - WARNING - [load_data_to_table] Cols missing DF->financials_income_quarterly (AAPL): ['Total_Unusual_Items', 'Total_Unusual_Items_Excluding_Goodwill', 'Special_Income_Charges', 'Earnings_From_Equity_Interest', 'Gain_On_Sale_Of_Security', 'Selling_And_Marketing_Expense', 'General_And_Administrative_Expense', 'Other_Gand_A']. Inserting NULL.
2025-04-19 14:47:40,152 - INFO - [load_data_to_table] Loading 5 rows into financials_balance_annual for ticker AAPL (Mode: initial_load)
2025-04-19 14:47:40,154 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_annual (AAPL): ['Preferred_Stock', 'Non_Current_Deferred_Liabilities', 'Non_Current_Deferred_Revenue', 'Non_Current_Deferred_Taxes_Liabilities', 'Pensionand_Other_Post_Retirement_Benefit_Plans_Current', 'Current_Accrued_Expenses', 'Other_Payable', 'Financial_Assets', 'Long_Term_Equity_Investment', 'Goodwill_And_Other_Intangible_Assets', 'Other_Intangible_Assets', 'Goodwill', 'Construction_In_Progress', 'Buildings_And_Improvements', 'Hedging_Assets_Current', 'Finished_Goods', 'Work_In_Process', 'Raw_Materials', 'Taxes_Receivable', 'Allowance_For_Doubtful_Accounts_Receivable', 'Gross_Accounts_Receivable']. Inserting NULL.
2025-04-19 14:47:40,184 - INFO - [load_data_to_table] Loading 6 rows into financials_balance_quarterly for ticker AAPL (Mode: initial_load)
2025-04-19 14:47:40,188 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_quarterly (AAPL): ['Preferred_Stock', 'Non_Current_Deferred_Liabilities', 'Non_Current_Deferred_Revenue', 'Non_Current_Deferred_Taxes_Liabilities', 'Pensionand_Other_Post_Retirement_Benefit_Plans_Current', 'Current_Accrued_Expenses', 'Other_Payable', 'Financial_Assets', 'Other_Investments', 'Long_Term_Equity_Investment', 'Goodwill_And_Other_Intangible_Assets', 'Other_Intangible_Assets', 'Goodwill', 'Construction_In_Progress', 'Buildings_And_Improvements', 'Hedging_Assets_Current', 'Work_In_Process', 'Taxes_Receivable', 'Allowance_For_Doubtful_Accounts_Receivable', 'Gross_Accounts_Receivable']. Inserting NULL.
2025-04-19 14:47:40,214 - INFO - [load_data_to_table] Loading 5 rows into financials_cashflow_annual for ticker AAPL (Mode: initial_load)
2025-04-19 14:47:40,217 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_annual (AAPL): ['Effect_Of_Exchange_Rate_Changes', 'Proceeds_From_Stock_Option_Exercised', 'Short_Term_Debt_Payments', 'Short_Term_Debt_Issuance', 'Interest_Received_CFI', 'Dividends_Received_CFI', 'Net_Investment_Properties_Purchase_And_Sale', 'Sale_Of_Investment_Properties', 'Purchase_Of_Investment_Properties', 'Sale_Of_Business', 'Net_Intangibles_Purchase_And_Sale', 'Sale_Of_Intangibles', 'Purchase_Of_Intangibles', 'Sale_Of_PPE', 'Capital_Expenditure_Reported', 'Taxes_Refund_Paid', 'Interest_Received_CFO', 'Interest_Paid_CFO', 'Dividend_Received_CFO', 'Dividend_Paid_CFO', 'Change_In_Accrued_Expense', 'Change_In_Interest_Payable', 'Change_In_Dividend_Payable', 'Change_In_Tax_Payable', 'Change_In_Income_Tax_Payable', 'Change_In_Prepaid_Assets', 'Excess_Tax_Benefit_From_Stock_Based_Compensation', 'Unrealized_Gain_Loss_On_Investment_Securities', 'Provisionand_Write_Offof_Assets', 'Asset_Impairment_Charge', 'Amortization_Of_Securities', 'Depletion', 'Amortization_Cash_Flow', 'Amortization_Of_Intangibles', 'Depreciation', 'Operating_Gains_Losses', 'Pension_And_Employee_Benefit_Expense', 'Earnings_Losses_From_Equity_Investments', 'Gain_Loss_On_Investment_Securities', 'Net_Foreign_Currency_Exchange_Gain_Loss', 'Gain_Loss_On_Sale_Of_PPE', 'Gain_Loss_On_Sale_Of_Business']. Inserting NULL.
2025-04-19 14:47:40,267 - INFO - [load_data_to_table] Loading 6 rows into financials_cashflow_quarterly for ticker AAPL (Mode: initial_load)
2025-04-19 14:47:40,271 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_quarterly (AAPL): ['Issuance_Of_Capital_Stock', 'Effect_Of_Exchange_Rate_Changes', 'Proceeds_From_Stock_Option_Exercised', 'Common_Stock_Issuance', 'Short_Term_Debt_Issuance', 'Interest_Received_CFI', 'Dividends_Received_CFI', 'Net_Investment_Properties_Purchase_And_Sale', 'Sale_Of_Investment_Properties', 'Purchase_Of_Investment_Properties', 'Net_Business_Purchase_And_Sale', 'Sale_Of_Business', 'Purchase_Of_Business', 'Net_Intangibles_Purchase_And_Sale', 'Sale_Of_Intangibles', 'Purchase_Of_Intangibles', 'Sale_Of_PPE', 'Capital_Expenditure_Reported', 'Taxes_Refund_Paid', 'Interest_Received_CFO', 'Interest_Paid_CFO', 'Dividend_Received_CFO', 'Dividend_Paid_CFO', 'Change_In_Other_Working_Capital', 'Change_In_Accrued_Expense', 'Change_In_Interest_Payable', 'Change_In_Dividend_Payable', 'Change_In_Tax_Payable', 'Change_In_Income_Tax_Payable', 'Change_In_Prepaid_Assets', 'Excess_Tax_Benefit_From_Stock_Based_Compensation', 'Unrealized_Gain_Loss_On_Investment_Securities', 'Provisionand_Write_Offof_Assets', 'Asset_Impairment_Charge', 'Amortization_Of_Securities', 'Deferred_Tax', 'Deferred_Income_Tax', 'Depletion', 'Amortization_Cash_Flow', 'Amortization_Of_Intangibles', 'Depreciation', 'Operating_Gains_Losses', 'Pension_And_Employee_Benefit_Expense', 'Earnings_Losses_From_Equity_Investments', 'Gain_Loss_On_Investment_Securities', 'Net_Foreign_Currency_Exchange_Gain_Loss', 'Gain_Loss_On_Sale_Of_PPE', 'Gain_Loss_On_Sale_Of_Business']. Inserting NULL.
2025-04-19 14:47:40,306 - INFO - [load_data_to_table] Loading 91 rows into stock_actions for ticker AAPL (Mode: initial_load)
2025-04-19 14:47:43,960 - INFO - [load_data_to_table] Loading 1 rows into company_profile for ticker MSFT (Mode: initial_load)
2025-04-19 14:47:43,973 - INFO - [load_data_to_table] Loading 1 rows into company_key_metrics for ticker MSFT (Mode: initial_load)
2025-04-19 14:47:43,987 - INFO - [load_data_to_table] Loading 4 rows into financials_income_annual for ticker MSFT (Mode: initial_load)
2025-04-19 14:47:43,988 - WARNING - [load_data_to_table] DF for financials_income_annual (MSFT) has extra columns not in DB schema: ['Write_Off']. These will be ignored.
2025-04-19 14:47:43,993 - WARNING - [load_data_to_table] Cols missing DF->financials_income_annual (MSFT): ['Earnings_From_Equity_Interest']. Inserting NULL.
2025-04-19 14:47:44,013 - INFO - [load_data_to_table] Loading 5 rows into financials_income_quarterly for ticker MSFT (Mode: initial_load)
2025-04-19 14:47:44,014 - WARNING - [load_data_to_table] DF for financials_income_quarterly (MSFT) has extra columns not in DB schema: ['Write_Off']. These will be ignored.
2025-04-19 14:47:44,016 - WARNING - [load_data_to_table] Cols missing DF->financials_income_quarterly (MSFT): ['Earnings_From_Equity_Interest']. Inserting NULL.
2025-04-19 14:47:44,031 - INFO - [load_data_to_table] Loading 4 rows into financials_balance_annual for ticker MSFT (Mode: initial_load)
2025-04-19 14:47:44,035 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_annual (MSFT): ['Treasury_Shares_Number', 'Preferred_Stock', 'Current_Capital_Lease_Obligation', 'Current_Accrued_Expenses', 'Other_Payable', 'Non_Current_Deferred_Assets', 'Non_Current_Deferred_Taxes_Assets', 'Other_Investments', 'Construction_In_Progress', 'Other_Receivables', 'Taxes_Receivable']. Inserting NULL.
2025-04-19 14:47:44,058 - INFO - [load_data_to_table] Loading 6 rows into financials_balance_quarterly for ticker MSFT (Mode: initial_load)
2025-04-19 14:47:44,061 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_quarterly (MSFT): ['Treasury_Shares_Number', 'Preferred_Stock', 'Current_Capital_Lease_Obligation', 'Current_Accrued_Expenses', 'Other_Payable', 'Non_Current_Deferred_Assets', 'Non_Current_Deferred_Taxes_Assets', 'Other_Investments', 'Construction_In_Progress', 'Other_Receivables', 'Taxes_Receivable']. Inserting NULL.
2025-04-19 14:47:44,085 - INFO - [load_data_to_table] Loading 5 rows into financials_cashflow_annual for ticker MSFT (Mode: initial_load)
2025-04-19 14:47:44,089 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_annual (MSFT): ['Interest_Paid_Supplemental_Data', 'Income_Tax_Paid_Supplemental_Data', 'Proceeds_From_Stock_Option_Exercised', 'Interest_Received_CFI', 'Dividends_Received_CFI', 'Net_Investment_Properties_Purchase_And_Sale', 'Sale_Of_Investment_Properties', 'Purchase_Of_Investment_Properties', 'Sale_Of_Business', 'Net_Intangibles_Purchase_And_Sale', 'Sale_Of_Intangibles', 'Purchase_Of_Intangibles', 'Sale_Of_PPE', 'Capital_Expenditure_Reported', 'Taxes_Refund_Paid', 'Interest_Received_CFO', 'Interest_Paid_CFO', 'Dividend_Received_CFO', 'Dividend_Paid_CFO', 'Change_In_Accrued_Expense', 'Change_In_Interest_Payable', 'Change_In_Dividend_Payable', 'Change_In_Prepaid_Assets', 'Other_Non_Cash_Items', 'Excess_Tax_Benefit_From_Stock_Based_Compensation', 'Provisionand_Write_Offof_Assets', 'Amortization_Of_Securities', 'Depletion', 'Amortization_Cash_Flow', 'Amortization_Of_Intangibles', 'Pension_And_Employee_Benefit_Expense', 'Earnings_Losses_From_Equity_Investments', 'Net_Foreign_Currency_Exchange_Gain_Loss', 'Gain_Loss_On_Sale_Of_PPE', 'Gain_Loss_On_Sale_Of_Business']. Inserting NULL.
2025-04-19 14:47:44,124 - INFO - [load_data_to_table] Loading 6 rows into financials_cashflow_quarterly for ticker MSFT (Mode: initial_load)
2025-04-19 14:47:44,127 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_quarterly (MSFT): ['Interest_Paid_Supplemental_Data', 'Income_Tax_Paid_Supplemental_Data', 'Proceeds_From_Stock_Option_Exercised', 'Short_Term_Debt_Payments', 'Interest_Received_CFI', 'Dividends_Received_CFI', 'Net_Investment_Properties_Purchase_And_Sale', 'Sale_Of_Investment_Properties', 'Purchase_Of_Investment_Properties', 'Sale_Of_Business', 'Net_Intangibles_Purchase_And_Sale', 'Sale_Of_Intangibles', 'Purchase_Of_Intangibles', 'Sale_Of_PPE', 'Capital_Expenditure_Reported', 'Taxes_Refund_Paid', 'Interest_Received_CFO', 'Interest_Paid_CFO', 'Dividend_Received_CFO', 'Dividend_Paid_CFO', 'Change_In_Accrued_Expense', 'Change_In_Interest_Payable', 'Change_In_Dividend_Payable', 'Change_In_Prepaid_Assets', 'Other_Non_Cash_Items', 'Excess_Tax_Benefit_From_Stock_Based_Compensation', 'Provisionand_Write_Offof_Assets', 'Amortization_Of_Securities', 'Depletion', 'Amortization_Cash_Flow', 'Amortization_Of_Intangibles', 'Pension_And_Employee_Benefit_Expense', 'Earnings_Losses_From_Equity_Investments', 'Net_Foreign_Currency_Exchange_Gain_Loss', 'Gain_Loss_On_Sale_Of_PPE', 'Gain_Loss_On_Sale_Of_Business']. Inserting NULL.
2025-04-19 14:47:44,160 - INFO - [load_data_to_table] Loading 94 rows into stock_actions for ticker MSFT (Mode: initial_load)
2025-04-19 14:47:47,301 - INFO - [load_data_to_table] Loading 1 rows into company_profile for ticker GOOG (Mode: initial_load)
2025-04-19 14:47:47,308 - INFO - [load_data_to_table] Loading 1 rows into company_key_metrics for ticker GOOG (Mode: initial_load)
2025-04-19 14:47:47,315 - INFO - [load_data_to_table] Loading 5 rows into financials_income_annual for ticker GOOG (Mode: initial_load)
2025-04-19 14:47:47,327 - INFO - [load_data_to_table] Loading 6 rows into financials_income_quarterly for ticker GOOG (Mode: initial_load)
2025-04-19 14:47:47,327 - WARNING - [load_data_to_table] DF for financials_income_quarterly (GOOG) has extra columns not in DB schema: ['Average_Dilution_Earnings']. These will be ignored.
2025-04-19 14:47:47,329 - WARNING - [load_data_to_table] Cols missing DF->financials_income_quarterly (GOOG): ['Special_Income_Charges']. Inserting NULL.
2025-04-19 14:47:47,339 - INFO - [load_data_to_table] Loading 5 rows into financials_balance_annual for ticker GOOG (Mode: initial_load)
2025-04-19 14:47:47,342 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_annual (GOOG): ['Net_Debt', 'Current_Debt', 'Other_Current_Borrowings', 'Commercial_Paper', 'Financial_Assets', 'Other_Investments', 'Long_Term_Equity_Investment', 'Hedging_Assets_Current', 'Finished_Goods', 'Work_In_Process', 'Raw_Materials', 'Other_Receivables', 'Cash_Equivalents', 'Cash_Financial']. Inserting NULL.
2025-04-19 14:47:47,363 - INFO - [load_data_to_table] Loading 6 rows into financials_balance_quarterly for ticker GOOG (Mode: initial_load)
2025-04-19 14:47:47,366 - WARNING - [load_data_to_table] Cols missing DF->financials_balance_quarterly (GOOG): ['Net_Debt', 'Current_Debt', 'Other_Current_Borrowings', 'Commercial_Paper', 'Other_Payable', 'Financial_Assets', 'Other_Investments', 'Long_Term_Equity_Investment', 'Hedging_Assets_Current', 'Finished_Goods', 'Work_In_Process', 'Raw_Materials', 'Other_Receivables', 'Taxes_Receivable']. Inserting NULL.
2025-04-19 14:47:47,444 - INFO - [load_data_to_table] Loading 5 rows into financials_cashflow_annual for ticker GOOG (Mode: initial_load)
2025-04-19 14:47:47,447 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_annual (GOOG): ['Issuance_Of_Capital_Stock', 'Interest_Paid_Supplemental_Data', 'Common_Stock_Issuance', 'Net_Short_Term_Debt_Issuance', 'Short_Term_Debt_Payments', 'Short_Term_Debt_Issuance', 'Interest_Received_CFI', 'Dividends_Received_CFI', 'Net_Investment_Properties_Purchase_And_Sale', 'Sale_Of_Investment_Properties', 'Purchase_Of_Investment_Properties', 'Sale_Of_Business', 'Net_Intangibles_Purchase_And_Sale', 'Sale_Of_Intangibles', 'Purchase_Of_Intangibles', 'Sale_Of_PPE', 'Capital_Expenditure_Reported', 'Taxes_Refund_Paid', 'Interest_Received_CFO', 'Interest_Paid_CFO', 'Dividend_Received_CFO', 'Dividend_Paid_CFO', 'Change_In_Other_Current_Liabilities', 'Change_In_Interest_Payable', 'Change_In_Dividend_Payable', 'Change_In_Tax_Payable', 'Change_In_Income_Tax_Payable', 'Change_In_Prepaid_Assets', 'Change_In_Inventory', 'Excess_Tax_Benefit_From_Stock_Based_Compensation', 'Unrealized_Gain_Loss_On_Investment_Securities', 'Provisionand_Write_Offof_Assets', 'Asset_Impairment_Charge', 'Amortization_Of_Securities', 'Depletion', 'Pension_And_Employee_Benefit_Expense', 'Earnings_Losses_From_Equity_Investments', 'Net_Foreign_Currency_Exchange_Gain_Loss', 'Gain_Loss_On_Sale_Of_PPE', 'Gain_Loss_On_Sale_Of_Business']. Inserting NULL.
2025-04-19 14:47:47,475 - INFO - [load_data_to_table] Loading 6 rows into financials_cashflow_quarterly for ticker GOOG (Mode: initial_load)
2025-04-19 14:47:47,477 - WARNING - [load_data_to_table] Cols missing DF->financials_cashflow_quarterly (GOOG): ['Issuance_Of_Capital_Stock', 'Interest_Paid_Supplemental_Data', 'Income_Tax_Paid_Supplemental_Data', 'Common_Stock_Issuance', 'Net_Short_Term_Debt_Issuance', 'Short_Term_Debt_Payments', 'Short_Term_Debt_Issuance', 'Interest_Received_CFI', 'Dividends_Received_CFI', 'Net_Investment_Properties_Purchase_And_Sale', 'Sale_Of_Investment_Properties', 'Purchase_Of_Investment_Properties', 'Sale_Of_Business', 'Net_Intangibles_Purchase_And_Sale', 'Sale_Of_Intangibles', 'Purchase_Of_Intangibles', 'Sale_Of_PPE', 'Capital_Expenditure_Reported', 'Taxes_Refund_Paid', 'Interest_Received_CFO', 'Interest_Paid_CFO', 'Dividend_Received_CFO', 'Dividend_Paid_CFO', 'Change_In_Other_Current_Liabilities', 'Change_In_Interest_Payable', 'Change_In_Dividend_Payable', 'Change_In_Tax_Payable', 'Change_In_Income_Tax_Payable', 'Change_In_Prepaid_Assets', 'Change_In_Inventory', 'Excess_Tax_Benefit_From_Stock_Based_Compensation', 'Unrealized_Gain_Loss_On_Investment_Securities', 'Provisionand_Write_Offof_Assets', 'Asset_Impairment_Charge', 'Amortization_Of_Securities', 'Depletion', 'Pension_And_Employee_Benefit_Expense', 'Earnings_Losses_From_Equity_Investments', 'Net_Foreign_Currency_Exchange_Gain_Loss', 'Gain_Loss_On_Sale_Of_PPE', 'Gain_Loss_On_Sale_Of_Business']. Inserting NULL.
2025-04-19 14:47:47,506 - INFO - [load_data_to_table] Loading 7 rows into stock_actions for ticker GOOG (Mode: initial_load)
2025-04-19 14:47:49,763 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 14:47:49,764 - ERROR - [fetch_company_info] Failed processing .info NONEXISTENTTICKER: AttributeError-'NoneType' object has no attribute 'update'
2025-04-19 14:47:49,764 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=fetch_company_info returned None
2025-04-19 14:47:50,843 - INFO - [fetch_financial_statement] No annual financials data found NONEXISTENTTICKER.
2025-04-19 14:47:50,844 - INFO - [fetch_financial_statement] No quarterly financials data found NONEXISTENTTICKER.
2025-04-19 14:47:50,845 - INFO - [fetch_financial_statement] No annual balance_sheet data found NONEXISTENTTICKER.
2025-04-19 14:47:50,846 - INFO - [fetch_financial_statement] No quarterly balance_sheet data found NONEXISTENTTICKER.
2025-04-19 14:47:50,846 - INFO - [fetch_financial_statement] No annual cashflow data found NONEXISTENTTICKER.
2025-04-19 14:47:50,847 - INFO - [fetch_financial_statement] No quarterly cashflow data found NONEXISTENTTICKER.
2025-04-19 14:47:51,755 - ERROR - [fetch_stock_actions] Failed actions NONEXISTENTTICKER: TypeError - argument of type 'NoneType' is not iterable
2025-04-19 14:47:51,755 - WARNING - [run_stock_info_pipeline] Skip load NONEXISTENTTICKER due to fetch errors.
2025-04-19 14:47:51,766 - INFO - [run_stock_info_pipeline] DB connection closed.
2025-04-19 14:47:51,767 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 14:47:51,767 - INFO - [run_stock_info_pipeline] Total Time: 15.47 sec
2025-04-19 14:47:51,767 - INFO - [run_stock_info_pipeline] Tickers Attempted: 4
2025-04-19 14:47:51,767 - INFO - [run_stock_info_pipeline] Tickers OK: 3
2025-04-19 14:47:51,767 - INFO - [run_stock_info_pipeline] Tickers Skip/Err: 1
2025-04-19 14:47:51,767 - INFO - [run_stock_info_pipeline] Fetch Errors: 8
2025-04-19 14:47:51,767 - INFO - [run_stock_info_pipeline] Load Errors: 0
2025-04-19 14:47:51,768 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors'.
2025-04-19 14:47:51,769 - INFO - [<module>] Script execution finished.
2025-04-19 14:54:26,126 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3 - Long Format) ---
2025-04-19 14:54:26,128 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 14:54:26,128 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 14:54:26,129 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 14:54:26,129 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 14:54:26,168 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 14:54:26,168 - INFO - [setup_info_tables] Setting up supplementary tables...
2025-04-19 14:54:26,171 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 14:54:26,174 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 14:54:26,174 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 14:54:29,525 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3 - Long Format) ---
2025-04-19 14:54:29,526 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 14:54:29,526 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 14:54:29,526 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 14:54:29,526 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 14:54:29,531 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 14:54:29,531 - INFO - [setup_info_tables] Setting up supplementary tables...
2025-04-19 14:54:29,532 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 14:54:29,533 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 14:54:29,533 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 14:54:32,475 - INFO - [load_generic_data] Loading 1 rows into company_profile for AAPL (Mode: initial_load)
2025-04-19 14:54:32,488 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for AAPL (Mode: initial_load)
2025-04-19 14:54:32,496 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for AAPL (39 items)
2025-04-19 14:54:32,499 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:32,503 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for AAPL (39 items)
2025-04-19 14:54:32,505 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:32,505 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for AAPL (68 items)
2025-04-19 14:54:32,510 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:32,510 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for AAPL (69 items)
2025-04-19 14:54:32,514 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:32,515 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for AAPL (53 items)
2025-04-19 14:54:32,519 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:32,519 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for AAPL (47 items)
2025-04-19 14:54:32,522 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:32,522 - INFO - [load_generic_data] Loading 91 rows into stock_actions for AAPL (Mode: initial_load)
2025-04-19 14:54:32,527 - WARNING - [run_stock_info_pipeline] Rolling back AAPL due to load errors.
2025-04-19 14:54:32,529 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=AAPL, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 14:54:35,805 - INFO - [load_generic_data] Loading 1 rows into company_profile for MSFT (Mode: initial_load)
2025-04-19 14:54:35,812 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for MSFT (Mode: initial_load)
2025-04-19 14:54:35,819 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for MSFT (47 items)
2025-04-19 14:54:35,821 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:35,821 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for MSFT (47 items)
2025-04-19 14:54:35,823 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:35,823 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for MSFT (78 items)
2025-04-19 14:54:35,826 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:35,826 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for MSFT (78 items)
2025-04-19 14:54:35,830 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:35,830 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for MSFT (60 items)
2025-04-19 14:54:35,833 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:35,833 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for MSFT (59 items)
2025-04-19 14:54:35,836 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:35,836 - INFO - [load_generic_data] Loading 94 rows into stock_actions for MSFT (Mode: initial_load)
2025-04-19 14:54:35,840 - WARNING - [run_stock_info_pipeline] Rolling back MSFT due to load errors.
2025-04-19 14:54:35,841 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=MSFT, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 14:54:38,679 - INFO - [load_generic_data] Loading 1 rows into company_profile for GOOG (Mode: initial_load)
2025-04-19 14:54:38,688 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for GOOG (Mode: initial_load)
2025-04-19 14:54:38,696 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for GOOG (47 items)
2025-04-19 14:54:38,698 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:38,699 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for GOOG (47 items)
2025-04-19 14:54:38,700 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:38,701 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for GOOG (75 items)
2025-04-19 14:54:38,704 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:38,704 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for GOOG (75 items)
2025-04-19 14:54:38,707 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:38,707 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for GOOG (55 items)
2025-04-19 14:54:38,710 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:38,710 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for GOOG (54 items)
2025-04-19 14:54:38,713 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 240, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows with None labels after cleaning
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:54:38,713 - INFO - [load_generic_data] Loading 7 rows into stock_actions for GOOG (Mode: initial_load)
2025-04-19 14:54:38,717 - WARNING - [run_stock_info_pipeline] Rolling back GOOG due to load errors.
2025-04-19 14:54:38,717 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=GOOG, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 14:54:40,691 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 14:54:40,693 - ERROR - [fetch_company_info] Failed processing .info NONEXISTENTTICKER: AttributeError-'NoneType' object has no attribute 'update'
2025-04-19 14:54:40,693 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=fetch_company_info returned None
2025-04-19 14:54:41,861 - INFO - [fetch_financial_statement] No raw annual financials data found for NONEXISTENTTICKER.
2025-04-19 14:54:41,862 - INFO - [fetch_financial_statement] No raw quarterly financials data found for NONEXISTENTTICKER.
2025-04-19 14:54:41,862 - INFO - [fetch_financial_statement] No raw annual balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 14:54:41,862 - INFO - [fetch_financial_statement] No raw quarterly balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 14:54:41,862 - INFO - [fetch_financial_statement] No raw annual cashflow data found for NONEXISTENTTICKER.
2025-04-19 14:54:41,863 - INFO - [fetch_financial_statement] No raw quarterly cashflow data found for NONEXISTENTTICKER.
2025-04-19 14:54:42,910 - ERROR - [fetch_stock_actions] Failed actions NONEXISTENTTICKER: TypeError - argument of type 'NoneType' is not iterable
2025-04-19 14:54:42,911 - WARNING - [run_stock_info_pipeline] Skip load NONEXISTENTTICKER due to fetch errors.
2025-04-19 14:54:42,917 - INFO - [run_stock_info_pipeline] DB connection closed.
2025-04-19 14:54:42,917 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 14:54:42,917 - INFO - [run_stock_info_pipeline] Total Time: 13.39 sec
2025-04-19 14:54:42,917 - INFO - [run_stock_info_pipeline] Tickers Attempted: 4
2025-04-19 14:54:42,917 - INFO - [run_stock_info_pipeline] Tickers OK: 0
2025-04-19 14:54:42,918 - INFO - [run_stock_info_pipeline] Tickers Skip/Err: 4
2025-04-19 14:54:42,918 - INFO - [run_stock_info_pipeline] Fetch Errors: 8
2025-04-19 14:54:42,918 - INFO - [run_stock_info_pipeline] Load Errors: 3
2025-04-19 14:54:42,918 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors'.
2025-04-19 14:54:42,919 - INFO - [<module>] Script execution finished.
2025-04-19 14:58:20,083 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3.0 - Long Format) ---
2025-04-19 14:58:20,084 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 14:58:20,085 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 14:58:20,085 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 14:58:20,085 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 14:58:20,090 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 14:58:20,091 - INFO - [setup_info_tables] Setting up supplementary tables (long format financials)...
2025-04-19 14:58:20,092 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 14:58:20,092 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 14:58:20,092 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 14:58:23,069 - INFO - [load_generic_data] Loading 1 rows into company_profile for AAPL (Mode: initial_load)
2025-04-19 14:58:23,076 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for AAPL (Mode: initial_load)
2025-04-19 14:58:23,083 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for AAPL (39 items)
2025-04-19 14:58:23,084 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:23,086 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for AAPL (39 items)
2025-04-19 14:58:23,087 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:23,087 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for AAPL (68 items)
2025-04-19 14:58:23,087 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:23,087 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for AAPL (69 items)
2025-04-19 14:58:23,088 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:23,088 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for AAPL (53 items)
2025-04-19 14:58:23,089 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:23,089 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for AAPL (47 items)
2025-04-19 14:58:23,089 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:23,089 - INFO - [load_generic_data] Loading 91 rows into stock_actions for AAPL (Mode: initial_load)
2025-04-19 14:58:23,093 - WARNING - [run_stock_info_pipeline] Rolling back AAPL due to load errors.
2025-04-19 14:58:23,094 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=AAPL, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 14:58:28,827 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3.0 - Long Format) ---
2025-04-19 14:58:28,828 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 14:58:28,828 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 14:58:28,828 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 14:58:28,828 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 14:58:28,833 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 14:58:28,834 - INFO - [setup_info_tables] Setting up supplementary tables (long format financials)...
2025-04-19 14:58:28,835 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 14:58:28,835 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 14:58:28,835 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 14:58:31,305 - INFO - [load_generic_data] Loading 1 rows into company_profile for AAPL (Mode: initial_load)
2025-04-19 14:58:31,320 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for AAPL (Mode: initial_load)
2025-04-19 14:58:31,331 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for AAPL (39 items)
2025-04-19 14:58:31,333 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:31,337 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for AAPL (39 items)
2025-04-19 14:58:31,341 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:31,341 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for AAPL (68 items)
2025-04-19 14:58:31,346 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:31,346 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for AAPL (69 items)
2025-04-19 14:58:31,354 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:31,389 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for AAPL (53 items)
2025-04-19 14:58:31,391 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:31,393 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for AAPL (47 items)
2025-04-19 14:58:31,394 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:31,395 - INFO - [load_generic_data] Loading 91 rows into stock_actions for AAPL (Mode: initial_load)
2025-04-19 14:58:31,412 - WARNING - [run_stock_info_pipeline] Rolling back AAPL due to load errors.
2025-04-19 14:58:31,412 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=AAPL, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 14:58:34,125 - INFO - [load_generic_data] Loading 1 rows into company_profile for MSFT (Mode: initial_load)
2025-04-19 14:58:34,134 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for MSFT (Mode: initial_load)
2025-04-19 14:58:34,142 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for MSFT (47 items)
2025-04-19 14:58:34,143 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:34,144 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for MSFT (47 items)
2025-04-19 14:58:34,144 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:34,144 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for MSFT (78 items)
2025-04-19 14:58:34,145 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:34,145 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for MSFT (78 items)
2025-04-19 14:58:34,146 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:34,146 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for MSFT (60 items)
2025-04-19 14:58:34,146 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:34,146 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for MSFT (59 items)
2025-04-19 14:58:34,147 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:34,147 - INFO - [load_generic_data] Loading 94 rows into stock_actions for MSFT (Mode: initial_load)
2025-04-19 14:58:34,152 - WARNING - [run_stock_info_pipeline] Rolling back MSFT due to load errors.
2025-04-19 14:58:34,153 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=MSFT, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 14:58:37,255 - INFO - [load_generic_data] Loading 1 rows into company_profile for GOOG (Mode: initial_load)
2025-04-19 14:58:37,263 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for GOOG (Mode: initial_load)
2025-04-19 14:58:37,272 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for GOOG (47 items)
2025-04-19 14:58:37,272 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:37,273 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for GOOG (47 items)
2025-04-19 14:58:37,273 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:37,273 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for GOOG (75 items)
2025-04-19 14:58:37,274 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:37,274 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for GOOG (75 items)
2025-04-19 14:58:37,274 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:37,275 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for GOOG (55 items)
2025-04-19 14:58:37,275 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:37,275 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for GOOG (54 items)
2025-04-19 14:58:37,276 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 14:58:37,276 - INFO - [load_generic_data] Loading 7 rows into stock_actions for GOOG (Mode: initial_load)
2025-04-19 14:58:37,280 - WARNING - [run_stock_info_pipeline] Rolling back GOOG due to load errors.
2025-04-19 14:58:37,281 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=GOOG, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 14:58:39,069 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 14:58:39,069 - ERROR - [fetch_company_info] Failed processing .info NONEXISTENTTICKER: AttributeError-'NoneType' object has no attribute 'update'
2025-04-19 14:58:39,070 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=fetch_company_info returned None
2025-04-19 14:58:40,513 - INFO - [fetch_financial_statement] No raw annual financials data found for NONEXISTENTTICKER.
2025-04-19 14:58:40,514 - INFO - [fetch_financial_statement] No raw quarterly financials data found for NONEXISTENTTICKER.
2025-04-19 14:58:40,514 - INFO - [fetch_financial_statement] No raw annual balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 14:58:40,515 - INFO - [fetch_financial_statement] No raw quarterly balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 14:58:40,515 - INFO - [fetch_financial_statement] No raw annual cashflow data found for NONEXISTENTTICKER.
2025-04-19 14:58:40,516 - INFO - [fetch_financial_statement] No raw quarterly cashflow data found for NONEXISTENTTICKER.
2025-04-19 14:58:41,578 - ERROR - [fetch_stock_actions] Failed actions NONEXISTENTTICKER: TypeError - argument of type 'NoneType' is not iterable
2025-04-19 14:58:41,580 - WARNING - [run_stock_info_pipeline] Skip load NONEXISTENTTICKER due to all fetches failing.
2025-04-19 14:58:41,586 - INFO - [run_stock_info_pipeline] DB connection closed.
2025-04-19 14:58:41,586 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 14:58:41,586 - INFO - [run_stock_info_pipeline] Total Time: 12.76 sec
2025-04-19 14:58:41,586 - INFO - [run_stock_info_pipeline] Tickers Attempted: 4
2025-04-19 14:58:41,586 - INFO - [run_stock_info_pipeline] Tickers OK: 0
2025-04-19 14:58:41,586 - INFO - [run_stock_info_pipeline] Tickers Skip/Err: 4
2025-04-19 14:58:41,586 - INFO - [run_stock_info_pipeline] Fetch Errors (API/Processing): 8
2025-04-19 14:58:41,586 - INFO - [run_stock_info_pipeline] Load Errors (Tickers with any load fail): 3
2025-04-19 14:58:41,586 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors'.
2025-04-19 14:58:41,587 - INFO - [<module>] Script execution finished.
2025-04-19 15:00:06,356 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3.0 - Long Format) ---
2025-04-19 15:00:06,358 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 15:00:06,358 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 15:00:06,358 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 15:00:06,358 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 15:00:06,363 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 15:00:06,364 - INFO - [setup_info_tables] Setting up supplementary tables (long format financials)...
2025-04-19 15:00:06,365 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 15:00:06,365 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 15:00:06,365 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 15:00:09,024 - INFO - [load_generic_data] Loading 1 rows into company_profile for AAPL (Mode: initial_load)
2025-04-19 15:00:09,031 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for AAPL (Mode: initial_load)
2025-04-19 15:00:09,039 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for AAPL (39 items)
2025-04-19 15:00:09,039 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:09,043 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for AAPL (39 items)
2025-04-19 15:00:09,043 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:09,044 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for AAPL (68 items)
2025-04-19 15:00:09,044 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:09,044 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for AAPL (69 items)
2025-04-19 15:00:09,045 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:09,045 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for AAPL (53 items)
2025-04-19 15:00:09,046 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:09,046 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for AAPL (47 items)
2025-04-19 15:00:09,046 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:09,047 - INFO - [load_generic_data] Loading 91 rows into stock_actions for AAPL (Mode: initial_load)
2025-04-19 15:00:09,052 - WARNING - [run_stock_info_pipeline] Rolling back AAPL due to load errors.
2025-04-19 15:00:09,052 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=AAPL, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:00:12,284 - INFO - [load_generic_data] Loading 1 rows into company_profile for MSFT (Mode: initial_load)
2025-04-19 15:00:12,290 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for MSFT (Mode: initial_load)
2025-04-19 15:00:12,298 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for MSFT (47 items)
2025-04-19 15:00:12,299 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:12,299 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for MSFT (47 items)
2025-04-19 15:00:12,299 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:12,300 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for MSFT (78 items)
2025-04-19 15:00:12,300 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:12,300 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for MSFT (78 items)
2025-04-19 15:00:12,301 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:12,301 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for MSFT (60 items)
2025-04-19 15:00:12,301 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:12,301 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for MSFT (59 items)
2025-04-19 15:00:12,302 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:12,302 - INFO - [load_generic_data] Loading 94 rows into stock_actions for MSFT (Mode: initial_load)
2025-04-19 15:00:12,306 - WARNING - [run_stock_info_pipeline] Rolling back MSFT due to load errors.
2025-04-19 15:00:12,306 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=MSFT, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:00:15,293 - INFO - [load_generic_data] Loading 1 rows into company_profile for GOOG (Mode: initial_load)
2025-04-19 15:00:15,304 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for GOOG (Mode: initial_load)
2025-04-19 15:00:15,316 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for GOOG (47 items)
2025-04-19 15:00:15,316 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:15,317 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for GOOG (47 items)
2025-04-19 15:00:15,317 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:15,318 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for GOOG (75 items)
2025-04-19 15:00:15,318 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:15,319 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for GOOG (75 items)
2025-04-19 15:00:15,319 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:15,319 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for GOOG (55 items)
2025-04-19 15:00:15,320 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:15,320 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for GOOG (54 items)
2025-04-19 15:00:15,320 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:00:15,321 - INFO - [load_generic_data] Loading 7 rows into stock_actions for GOOG (Mode: initial_load)
2025-04-19 15:00:15,326 - WARNING - [run_stock_info_pipeline] Rolling back GOOG due to load errors.
2025-04-19 15:00:15,326 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=GOOG, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:00:17,435 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:00:17,435 - ERROR - [fetch_company_info] Failed processing .info NONEXISTENTTICKER: AttributeError-'NoneType' object has no attribute 'update'
2025-04-19 15:00:17,435 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=fetch_company_info returned None
2025-04-19 15:00:18,647 - INFO - [fetch_financial_statement] No raw annual financials data found for NONEXISTENTTICKER.
2025-04-19 15:00:18,647 - INFO - [fetch_financial_statement] No raw quarterly financials data found for NONEXISTENTTICKER.
2025-04-19 15:00:18,648 - INFO - [fetch_financial_statement] No raw annual balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 15:00:18,648 - INFO - [fetch_financial_statement] No raw quarterly balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 15:00:18,649 - INFO - [fetch_financial_statement] No raw annual cashflow data found for NONEXISTENTTICKER.
2025-04-19 15:00:18,649 - INFO - [fetch_financial_statement] No raw quarterly cashflow data found for NONEXISTENTTICKER.
2025-04-19 15:00:20,439 - ERROR - [fetch_stock_actions] Failed actions NONEXISTENTTICKER: TypeError - argument of type 'NoneType' is not iterable
2025-04-19 15:00:20,439 - WARNING - [run_stock_info_pipeline] Skip load NONEXISTENTTICKER due to all fetches failing.
2025-04-19 15:00:20,445 - INFO - [run_stock_info_pipeline] DB connection closed.
2025-04-19 15:00:20,445 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 15:00:20,445 - INFO - [run_stock_info_pipeline] Total Time: 14.09 sec
2025-04-19 15:00:20,445 - INFO - [run_stock_info_pipeline] Tickers Attempted: 4
2025-04-19 15:00:20,445 - INFO - [run_stock_info_pipeline] Tickers OK: 0
2025-04-19 15:00:20,445 - INFO - [run_stock_info_pipeline] Tickers Skip/Err: 4
2025-04-19 15:00:20,445 - INFO - [run_stock_info_pipeline] Fetch Errors (API/Processing): 8
2025-04-19 15:00:20,446 - INFO - [run_stock_info_pipeline] Load Errors (Tickers with any load fail): 3
2025-04-19 15:00:20,446 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors'.
2025-04-19 15:00:20,446 - INFO - [<module>] Script execution finished.
2025-04-19 15:02:55,243 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3.0 - Long Format) ---
2025-04-19 15:02:55,247 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 15:02:55,247 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 15:02:55,247 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 15:02:55,248 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 15:02:55,280 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 15:02:55,281 - INFO - [setup_info_tables] Setting up supplementary tables (long format financials)...
2025-04-19 15:02:55,282 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 15:02:55,283 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 15:02:55,283 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 15:02:58,002 - INFO - [load_generic_data] Loading 1 rows into company_profile for AAPL (Mode: initial_load)
2025-04-19 15:02:58,009 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for AAPL (Mode: initial_load)
2025-04-19 15:02:58,017 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for AAPL (39 items)
2025-04-19 15:02:58,018 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:02:58,021 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for AAPL (39 items)
2025-04-19 15:02:58,021 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:02:58,021 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for AAPL (68 items)
2025-04-19 15:02:58,022 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:02:58,022 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for AAPL (69 items)
2025-04-19 15:02:58,022 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:02:58,022 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for AAPL (53 items)
2025-04-19 15:02:58,023 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:02:58,023 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for AAPL (47 items)
2025-04-19 15:02:58,023 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for AAPL: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:02:58,024 - INFO - [load_generic_data] Loading 91 rows into stock_actions for AAPL (Mode: initial_load)
2025-04-19 15:02:58,028 - WARNING - [run_stock_info_pipeline] Rolling back AAPL due to load errors.
2025-04-19 15:02:58,029 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=AAPL, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:03:01,046 - INFO - [load_generic_data] Loading 1 rows into company_profile for MSFT (Mode: initial_load)
2025-04-19 15:03:01,054 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for MSFT (Mode: initial_load)
2025-04-19 15:03:01,061 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for MSFT (47 items)
2025-04-19 15:03:01,062 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:03:01,062 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for MSFT (47 items)
2025-04-19 15:03:01,063 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:03:01,063 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for MSFT (78 items)
2025-04-19 15:03:01,063 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:03:01,063 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for MSFT (78 items)
2025-04-19 15:03:01,064 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:03:01,064 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for MSFT (60 items)
2025-04-19 15:03:01,064 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:03:01,064 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for MSFT (59 items)
2025-04-19 15:03:01,065 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for MSFT: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:03:01,065 - INFO - [load_generic_data] Loading 94 rows into stock_actions for MSFT (Mode: initial_load)
2025-04-19 15:03:01,069 - WARNING - [run_stock_info_pipeline] Rolling back MSFT due to load errors.
2025-04-19 15:03:01,069 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=MSFT, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:03:03,846 - INFO - [load_generic_data] Loading 1 rows into company_profile for GOOG (Mode: initial_load)
2025-04-19 15:03:03,853 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for GOOG (Mode: initial_load)
2025-04-19 15:03:03,861 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for GOOG (47 items)
2025-04-19 15:03:03,861 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:03:03,862 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for GOOG (47 items)
2025-04-19 15:03:03,862 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:03:03,863 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for GOOG (75 items)
2025-04-19 15:03:03,863 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:03:03,864 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for GOOG (75 items)
2025-04-19 15:03:03,864 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:03:03,865 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for GOOG (55 items)
2025-04-19 15:03:03,865 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:03:03,865 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for GOOG (54 items)
2025-04-19 15:03:03,866 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for GOOG: [None]
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 256, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True)
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: [None]
2025-04-19 15:03:03,866 - INFO - [load_generic_data] Loading 7 rows into stock_actions for GOOG (Mode: initial_load)
2025-04-19 15:03:03,870 - WARNING - [run_stock_info_pipeline] Rolling back GOOG due to load errors.
2025-04-19 15:03:03,871 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=GOOG, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:03:05,750 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:03:05,750 - ERROR - [fetch_company_info] Failed processing .info NONEXISTENTTICKER: AttributeError-'NoneType' object has no attribute 'update'
2025-04-19 15:03:05,750 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=fetch_company_info returned None
2025-04-19 15:03:06,893 - INFO - [fetch_financial_statement] No raw annual financials data found for NONEXISTENTTICKER.
2025-04-19 15:03:06,893 - INFO - [fetch_financial_statement] No raw quarterly financials data found for NONEXISTENTTICKER.
2025-04-19 15:03:06,894 - INFO - [fetch_financial_statement] No raw annual balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 15:03:06,894 - INFO - [fetch_financial_statement] No raw quarterly balance_sheet data found for NONEXISTENTTICKER.
2025-04-19 15:03:06,894 - INFO - [fetch_financial_statement] No raw annual cashflow data found for NONEXISTENTTICKER.
2025-04-19 15:03:06,895 - INFO - [fetch_financial_statement] No raw quarterly cashflow data found for NONEXISTENTTICKER.
2025-04-19 15:03:07,786 - ERROR - [fetch_stock_actions] Failed actions NONEXISTENTTICKER: TypeError - argument of type 'NoneType' is not iterable
2025-04-19 15:03:07,787 - WARNING - [run_stock_info_pipeline] Skip load NONEXISTENTTICKER due to all fetches failing.
2025-04-19 15:03:07,792 - INFO - [run_stock_info_pipeline] DB connection closed.
2025-04-19 15:03:07,792 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 15:03:07,792 - INFO - [run_stock_info_pipeline] Total Time: 12.55 sec
2025-04-19 15:03:07,792 - INFO - [run_stock_info_pipeline] Tickers Attempted: 4
2025-04-19 15:03:07,792 - INFO - [run_stock_info_pipeline] Tickers OK: 0
2025-04-19 15:03:07,792 - INFO - [run_stock_info_pipeline] Tickers Skip/Err: 4
2025-04-19 15:03:07,792 - INFO - [run_stock_info_pipeline] Fetch Errors (API/Processing): 8
2025-04-19 15:03:07,792 - INFO - [run_stock_info_pipeline] Load Errors (Tickers with any load fail): 3
2025-04-19 15:03:07,792 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors'.
2025-04-19 15:03:07,793 - INFO - [<module>] Script execution finished.
2025-04-19 15:06:55,721 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3.2 - Long Format - Keep Nulls) ---
2025-04-19 15:06:55,727 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 15:06:55,727 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 15:06:55,727 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 15:06:55,727 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 15:06:55,756 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 15:06:55,757 - INFO - [setup_info_tables] Setting up supplementary tables (long format financials)...
2025-04-19 15:06:55,758 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 15:06:55,759 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 15:06:55,759 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 15:06:58,561 - INFO - [load_generic_data] Loading 1 rows into company_profile for AAPL (Mode: initial_load)
2025-04-19 15:06:58,570 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for AAPL (Mode: initial_load)
2025-04-19 15:06:58,577 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for AAPL (39 items)
2025-04-19 15:06:58,580 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for AAPL: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:06:58,583 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for AAPL (39 items)
2025-04-19 15:06:58,583 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for AAPL: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:06:58,584 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for AAPL (68 items)
2025-04-19 15:06:58,584 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for AAPL: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:06:58,585 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for AAPL (69 items)
2025-04-19 15:06:58,585 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for AAPL: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:06:58,585 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for AAPL (53 items)
2025-04-19 15:06:58,586 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for AAPL: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:06:58,586 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for AAPL (47 items)
2025-04-19 15:06:58,587 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for AAPL: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:06:58,587 - INFO - [load_generic_data] Loading 91 rows into stock_actions for AAPL (Mode: initial_load)
2025-04-19 15:06:58,591 - WARNING - [run_stock_info_pipeline] Rolling back AAPL due to load errors.
2025-04-19 15:06:58,592 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=AAPL, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:07:01,607 - INFO - [load_generic_data] Loading 1 rows into company_profile for MSFT (Mode: initial_load)
2025-04-19 15:07:01,614 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for MSFT (Mode: initial_load)
2025-04-19 15:07:01,621 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for MSFT (47 items)
2025-04-19 15:07:01,622 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for MSFT: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:01,623 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for MSFT (47 items)
2025-04-19 15:07:01,623 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for MSFT: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:01,624 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for MSFT (78 items)
2025-04-19 15:07:01,624 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for MSFT: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:01,624 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for MSFT (78 items)
2025-04-19 15:07:01,625 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for MSFT: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:01,625 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for MSFT (60 items)
2025-04-19 15:07:01,626 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for MSFT: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:01,626 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for MSFT (59 items)
2025-04-19 15:07:01,626 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for MSFT: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:01,627 - INFO - [load_generic_data] Loading 94 rows into stock_actions for MSFT (Mode: initial_load)
2025-04-19 15:07:01,631 - WARNING - [run_stock_info_pipeline] Rolling back MSFT due to load errors.
2025-04-19 15:07:01,631 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=MSFT, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:07:06,496 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3.2 - Long Format - Keep Nulls) ---
2025-04-19 15:07:06,497 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 15:07:06,497 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 15:07:06,497 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 15:07:06,497 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 15:07:06,503 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 15:07:06,504 - INFO - [setup_info_tables] Setting up supplementary tables (long format financials)...
2025-04-19 15:07:06,505 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 15:07:06,505 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 15:07:06,505 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 15:07:08,925 - INFO - [load_generic_data] Loading 1 rows into company_profile for AAPL (Mode: initial_load)
2025-04-19 15:07:08,932 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for AAPL (Mode: initial_load)
2025-04-19 15:07:08,940 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for AAPL (39 items)
2025-04-19 15:07:08,942 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for AAPL: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:08,946 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for AAPL (39 items)
2025-04-19 15:07:08,946 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for AAPL: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:08,946 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for AAPL (68 items)
2025-04-19 15:07:08,947 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for AAPL: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:08,947 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for AAPL (69 items)
2025-04-19 15:07:08,948 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for AAPL: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:08,948 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for AAPL (53 items)
2025-04-19 15:07:08,948 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for AAPL: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:08,949 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for AAPL (47 items)
2025-04-19 15:07:08,949 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for AAPL: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:08,949 - INFO - [load_generic_data] Loading 91 rows into stock_actions for AAPL (Mode: initial_load)
2025-04-19 15:07:08,954 - WARNING - [run_stock_info_pipeline] Rolling back AAPL due to load errors.
2025-04-19 15:07:08,954 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=AAPL, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:07:11,718 - INFO - [load_generic_data] Loading 1 rows into company_profile for MSFT (Mode: initial_load)
2025-04-19 15:07:11,725 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for MSFT (Mode: initial_load)
2025-04-19 15:07:11,732 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for MSFT (47 items)
2025-04-19 15:07:11,732 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for MSFT: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:11,733 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for MSFT (47 items)
2025-04-19 15:07:11,733 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for MSFT: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:11,734 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for MSFT (78 items)
2025-04-19 15:07:11,734 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for MSFT: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:11,734 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for MSFT (78 items)
2025-04-19 15:07:11,735 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for MSFT: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:11,735 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for MSFT (60 items)
2025-04-19 15:07:11,735 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for MSFT: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:11,736 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for MSFT (59 items)
2025-04-19 15:07:11,736 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for MSFT: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:11,737 - INFO - [load_generic_data] Loading 94 rows into stock_actions for MSFT (Mode: initial_load)
2025-04-19 15:07:11,741 - WARNING - [run_stock_info_pipeline] Rolling back MSFT due to load errors.
2025-04-19 15:07:11,742 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=MSFT, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:07:14,938 - INFO - [load_generic_data] Loading 1 rows into company_profile for GOOG (Mode: initial_load)
2025-04-19 15:07:14,946 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for GOOG (Mode: initial_load)
2025-04-19 15:07:14,955 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for GOOG (47 items)
2025-04-19 15:07:14,956 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement for GOOG: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:14,957 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for GOOG (47 items)
2025-04-19 15:07:14,958 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement for GOOG: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:14,958 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for GOOG (75 items)
2025-04-19 15:07:14,960 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet for GOOG: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:14,960 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for GOOG (75 items)
2025-04-19 15:07:14,961 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet for GOOG: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:14,962 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for GOOG (55 items)
2025-04-19 15:07:14,963 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow for GOOG: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:14,963 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for GOOG (54 items)
2025-04-19 15:07:14,964 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow for GOOG: ['item_label_temp']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 215, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True) # Drop rows if label is None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label_temp']
2025-04-19 15:07:14,965 - INFO - [load_generic_data] Loading 7 rows into stock_actions for GOOG (Mode: initial_load)
2025-04-19 15:07:14,970 - WARNING - [run_stock_info_pipeline] Rolling back GOOG due to load errors.
2025-04-19 15:07:14,971 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=GOOG, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:07:16,983 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:07:16,983 - ERROR - [fetch_company_info] Failed processing .info NONEXISTENTTICKER: AttributeError-'NoneType' object has no attribute 'update'
2025-04-19 15:07:16,983 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=fetch_company_info returned None
2025-04-19 15:07:18,100 - INFO - [fetch_financial_statement] No raw annual financials data found NONEXISTENTTICKER.
2025-04-19 15:07:18,101 - INFO - [fetch_financial_statement] No raw quarterly financials data found NONEXISTENTTICKER.
2025-04-19 15:07:18,101 - INFO - [fetch_financial_statement] No raw annual balance_sheet data found NONEXISTENTTICKER.
2025-04-19 15:07:18,101 - INFO - [fetch_financial_statement] No raw quarterly balance_sheet data found NONEXISTENTTICKER.
2025-04-19 15:07:18,101 - INFO - [fetch_financial_statement] No raw annual cashflow data found NONEXISTENTTICKER.
2025-04-19 15:07:18,102 - INFO - [fetch_financial_statement] No raw quarterly cashflow data found NONEXISTENTTICKER.
2025-04-19 15:07:18,948 - ERROR - [fetch_stock_actions] Failed actions NONEXISTENTTICKER: TypeError - argument of type 'NoneType' is not iterable
2025-04-19 15:07:18,949 - WARNING - [run_stock_info_pipeline] Skip load NONEXISTENTTICKER due to all fetches failing.
2025-04-19 15:07:18,954 - INFO - [run_stock_info_pipeline] DB connection closed.
2025-04-19 15:07:18,954 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 15:07:18,954 - INFO - [run_stock_info_pipeline] Total Time: 12.46 sec
2025-04-19 15:07:18,954 - INFO - [run_stock_info_pipeline] Tickers Attempted: 4
2025-04-19 15:07:18,954 - INFO - [run_stock_info_pipeline] Tickers OK: 0
2025-04-19 15:07:18,954 - INFO - [run_stock_info_pipeline] Tickers Skip/Err: 4
2025-04-19 15:07:18,954 - INFO - [run_stock_info_pipeline] Fetch Errors: 8
2025-04-19 15:07:18,955 - INFO - [run_stock_info_pipeline] Load Errors (Tickers w fail): 3
2025-04-19 15:07:18,955 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors'.
2025-04-19 15:07:18,955 - INFO - [<module>] Script execution finished.
2025-04-19 15:09:19,156 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3.2 - Long Format - Keep Nulls Fix) ---
2025-04-19 15:09:19,162 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 15:09:19,162 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 15:09:19,162 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 15:09:19,162 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 15:09:19,168 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 15:09:19,168 - INFO - [setup_info_tables] Setting up supplementary tables (long format financials)...
2025-04-19 15:09:19,169 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 15:09:19,170 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 15:09:19,170 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 15:09:22,893 - INFO - [load_generic_data] Loading 1 rows into company_profile for AAPL (Mode: initial_load)
2025-04-19 15:09:22,900 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for AAPL (Mode: initial_load)
2025-04-19 15:09:22,908 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for AAPL (39 items)
2025-04-19 15:09:22,921 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for AAPL (39 items)
2025-04-19 15:09:22,930 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for AAPL (68 items)
2025-04-19 15:09:22,941 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for AAPL (69 items)
2025-04-19 15:09:22,951 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for AAPL (53 items)
2025-04-19 15:09:22,962 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for AAPL (47 items)
2025-04-19 15:09:22,973 - INFO - [load_generic_data] Loading 91 rows into stock_actions for AAPL (Mode: initial_load)
2025-04-19 15:09:26,602 - INFO - [load_generic_data] Loading 1 rows into company_profile for MSFT (Mode: initial_load)
2025-04-19 15:09:26,609 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for MSFT (Mode: initial_load)
2025-04-19 15:09:26,617 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for MSFT (47 items)
2025-04-19 15:09:26,626 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for MSFT (47 items)
2025-04-19 15:09:26,634 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for MSFT (78 items)
2025-04-19 15:09:26,646 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for MSFT (78 items)
2025-04-19 15:09:26,657 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for MSFT (60 items)
2025-04-19 15:09:26,667 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for MSFT (59 items)
2025-04-19 15:09:26,680 - INFO - [load_generic_data] Loading 94 rows into stock_actions for MSFT (Mode: initial_load)
2025-04-19 15:09:29,700 - INFO - [load_generic_data] Loading 1 rows into company_profile for GOOG (Mode: initial_load)
2025-04-19 15:09:29,706 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for GOOG (Mode: initial_load)
2025-04-19 15:09:29,714 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for GOOG (47 items)
2025-04-19 15:09:29,725 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for GOOG (47 items)
2025-04-19 15:09:29,737 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for GOOG (75 items)
2025-04-19 15:09:29,751 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for GOOG (75 items)
2025-04-19 15:09:29,762 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for GOOG (55 items)
2025-04-19 15:09:29,773 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for GOOG (54 items)
2025-04-19 15:09:29,785 - INFO - [load_generic_data] Loading 7 rows into stock_actions for GOOG (Mode: initial_load)
2025-04-19 15:09:31,853 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:09:31,853 - ERROR - [fetch_company_info] Failed processing .info NONEXISTENTTICKER: AttributeError-'NoneType' object has no attribute 'update'
2025-04-19 15:09:31,854 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=fetch_company_info returned None
2025-04-19 15:09:33,153 - INFO - [fetch_financial_statement] No raw annual financials data found NONEXISTENTTICKER.
2025-04-19 15:09:33,155 - INFO - [fetch_financial_statement] No raw quarterly financials data found NONEXISTENTTICKER.
2025-04-19 15:09:33,156 - INFO - [fetch_financial_statement] No raw annual balance_sheet data found NONEXISTENTTICKER.
2025-04-19 15:09:33,156 - INFO - [fetch_financial_statement] No raw quarterly balance_sheet data found NONEXISTENTTICKER.
2025-04-19 15:09:33,157 - INFO - [fetch_financial_statement] No raw annual cashflow data found NONEXISTENTTICKER.
2025-04-19 15:09:33,157 - INFO - [fetch_financial_statement] No raw quarterly cashflow data found NONEXISTENTTICKER.
2025-04-19 15:09:34,238 - ERROR - [fetch_stock_actions] Failed actions NONEXISTENTTICKER: TypeError - argument of type 'NoneType' is not iterable
2025-04-19 15:09:34,239 - WARNING - [run_stock_info_pipeline] Skip load NONEXISTENTTICKER due to all fetches failing.
2025-04-19 15:09:34,243 - INFO - [run_stock_info_pipeline] DB connection closed.
2025-04-19 15:09:34,244 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 15:09:34,244 - INFO - [run_stock_info_pipeline] Total Time: 15.09 sec
2025-04-19 15:09:34,244 - INFO - [run_stock_info_pipeline] Tickers Attempted: 4
2025-04-19 15:09:34,244 - INFO - [run_stock_info_pipeline] Tickers OK: 3
2025-04-19 15:09:34,244 - INFO - [run_stock_info_pipeline] Tickers Skip/Err: 1
2025-04-19 15:09:34,244 - INFO - [run_stock_info_pipeline] Fetch Errors: 8
2025-04-19 15:09:34,244 - INFO - [run_stock_info_pipeline] Load Errors (Tickers w fail): 0
2025-04-19 15:09:34,245 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors'.
2025-04-19 15:09:34,245 - INFO - [<module>] Script execution finished.
2025-04-19 15:18:20,073 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3.5 - Added Fields) ---
2025-04-19 15:18:20,076 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 15:18:20,076 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 15:18:20,076 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 15:18:20,076 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 15:18:20,110 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 15:18:20,110 - INFO - [setup_info_tables] Setting up supplementary tables (incl. ISIN, Calendar, Recs, Holders)...
2025-04-19 15:18:20,113 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 15:18:20,114 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 15:18:20,114 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 15:18:24,515 - ERROR - [fetch_calendar] Failed calendar AAPL: 'dict' object has no attribute 'empty'
2025-04-19 15:18:24,619 - ERROR - [fetch_recommendations] Failed recs AAPL: ['firm']
2025-04-19 15:18:24,710 - ERROR - [fetch_major_holders] Failed major holders AAPL: single positional indexer is out-of-bounds
2025-04-19 15:18:24,711 - WARNING - [_process_holders_df] Holder DF for AAPL missing expected columns. Got: ['Date Reported', 'Holder', 'pctHeld', 'Shares', 'Value', 'pctChange']
2025-04-19 15:18:24,711 - WARNING - [_process_holders_df] Holder DF for AAPL missing expected columns. Got: ['Date Reported', 'Holder', 'pctHeld', 'Shares', 'Value', 'pctChange']
2025-04-19 15:18:24,712 - INFO - [load_generic_data] Loading 1 rows into company_profile for AAPL (Mode: initial_load)
2025-04-19 15:18:24,712 - ERROR - [load_generic_data] Error prep DF company_profile (AAPL): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 200, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm: matched_db_col = db_col_map_val; break
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:18:24,713 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for AAPL (Mode: initial_load)
2025-04-19 15:18:24,714 - ERROR - [load_generic_data] Error prep DF company_key_metrics (AAPL): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 200, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm: matched_db_col = db_col_map_val; break
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:18:24,714 - ERROR - [run_stock_info_pipeline] Error load tx AAPL: name 'freq' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 607, in run_stock_info_pipeline
    if not process_and_load_financial_facts(write_conn, raw_df_fin, ticker, stmt_type, freq, mode): load_failed_flag = True
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 397, in process_and_load_financial_facts
    logging.info(f"Processing {freq} {stmt_type} for {ticker} ({len(raw_df)} items)")
                               ^^^^
NameError: name 'freq' is not defined
2025-04-19 15:18:24,714 - INFO - [run_stock_info_pipeline] Rolled back AAPL.
2025-04-19 15:18:24,715 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=AAPL, Type=Load Transaction Error, Msg=name 'freq' is not defined
2025-04-19 15:18:28,776 - ERROR - [fetch_calendar] Failed calendar MSFT: 'dict' object has no attribute 'empty'
2025-04-19 15:18:28,855 - ERROR - [fetch_recommendations] Failed recs MSFT: ['firm']
2025-04-19 15:18:28,958 - ERROR - [fetch_major_holders] Failed major holders MSFT: single positional indexer is out-of-bounds
2025-04-19 15:18:28,958 - WARNING - [_process_holders_df] Holder DF for MSFT missing expected columns. Got: ['Date Reported', 'Holder', 'pctHeld', 'Shares', 'Value', 'pctChange']
2025-04-19 15:18:28,958 - WARNING - [_process_holders_df] Holder DF for MSFT missing expected columns. Got: ['Date Reported', 'Holder', 'pctHeld', 'Shares', 'Value', 'pctChange']
2025-04-19 15:18:28,959 - INFO - [load_generic_data] Loading 1 rows into company_profile for MSFT (Mode: initial_load)
2025-04-19 15:18:28,959 - ERROR - [load_generic_data] Error prep DF company_profile (MSFT): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 200, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm: matched_db_col = db_col_map_val; break
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:18:28,960 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for MSFT (Mode: initial_load)
2025-04-19 15:18:28,960 - ERROR - [load_generic_data] Error prep DF company_key_metrics (MSFT): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 200, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm: matched_db_col = db_col_map_val; break
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:18:28,960 - ERROR - [run_stock_info_pipeline] Error load tx MSFT: name 'freq' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 607, in run_stock_info_pipeline
    if not process_and_load_financial_facts(write_conn, raw_df_fin, ticker, stmt_type, freq, mode): load_failed_flag = True
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 397, in process_and_load_financial_facts
    logging.info(f"Processing {freq} {stmt_type} for {ticker} ({len(raw_df)} items)")
                               ^^^^
NameError: name 'freq' is not defined
2025-04-19 15:18:28,961 - INFO - [run_stock_info_pipeline] Rolled back MSFT.
2025-04-19 15:18:28,961 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=MSFT, Type=Load Transaction Error, Msg=name 'freq' is not defined
2025-04-19 15:18:32,964 - ERROR - [fetch_calendar] Failed calendar GOOG: 'dict' object has no attribute 'empty'
2025-04-19 15:18:33,049 - ERROR - [fetch_recommendations] Failed recs GOOG: ['firm']
2025-04-19 15:18:33,178 - ERROR - [fetch_major_holders] Failed major holders GOOG: single positional indexer is out-of-bounds
2025-04-19 15:18:33,179 - WARNING - [_process_holders_df] Holder DF for GOOG missing expected columns. Got: ['Date Reported', 'Holder', 'pctHeld', 'Shares', 'Value', 'pctChange']
2025-04-19 15:18:33,179 - WARNING - [_process_holders_df] Holder DF for GOOG missing expected columns. Got: ['Date Reported', 'Holder', 'pctHeld', 'Shares', 'Value', 'pctChange']
2025-04-19 15:18:33,180 - INFO - [load_generic_data] Loading 1 rows into company_profile for GOOG (Mode: initial_load)
2025-04-19 15:18:33,181 - ERROR - [load_generic_data] Error prep DF company_profile (GOOG): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 200, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm: matched_db_col = db_col_map_val; break
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:18:33,182 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for GOOG (Mode: initial_load)
2025-04-19 15:18:33,183 - ERROR - [load_generic_data] Error prep DF company_key_metrics (GOOG): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 200, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm: matched_db_col = db_col_map_val; break
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:18:33,183 - ERROR - [run_stock_info_pipeline] Error load tx GOOG: name 'freq' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 607, in run_stock_info_pipeline
    if not process_and_load_financial_facts(write_conn, raw_df_fin, ticker, stmt_type, freq, mode): load_failed_flag = True
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 397, in process_and_load_financial_facts
    logging.info(f"Processing {freq} {stmt_type} for {ticker} ({len(raw_df)} items)")
                               ^^^^
NameError: name 'freq' is not defined
2025-04-19 15:18:33,185 - INFO - [run_stock_info_pipeline] Rolled back GOOG.
2025-04-19 15:18:33,185 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=GOOG, Type=Load Transaction Error, Msg=name 'freq' is not defined
2025-04-19 15:18:35,122 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:18:35,123 - ERROR - [fetch_company_info] Failed processing .info NONEXISTENTTICKER: AttributeError-'NoneType' object has no attribute 'update'
2025-04-19 15:18:35,123 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=fetch_company_info None
2025-04-19 15:18:39,468 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3.5 - Added Fields) ---
2025-04-19 15:18:39,468 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 15:18:39,468 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 15:18:39,468 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 15:18:39,468 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 15:18:39,474 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 15:18:39,474 - INFO - [setup_info_tables] Setting up supplementary tables (incl. ISIN, Calendar, Recs, Holders)...
2025-04-19 15:18:39,476 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 15:18:39,477 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 15:18:39,477 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 15:18:43,177 - ERROR - [fetch_calendar] Failed calendar AAPL: 'dict' object has no attribute 'empty'
2025-04-19 15:18:43,274 - ERROR - [fetch_recommendations] Failed recs AAPL: ['firm']
2025-04-19 15:18:43,385 - ERROR - [fetch_major_holders] Failed major holders AAPL: single positional indexer is out-of-bounds
2025-04-19 15:18:43,386 - WARNING - [_process_holders_df] Holder DF for AAPL missing expected columns. Got: ['Date Reported', 'Holder', 'pctHeld', 'Shares', 'Value', 'pctChange']
2025-04-19 15:18:43,386 - WARNING - [_process_holders_df] Holder DF for AAPL missing expected columns. Got: ['Date Reported', 'Holder', 'pctHeld', 'Shares', 'Value', 'pctChange']
2025-04-19 15:18:43,387 - INFO - [load_generic_data] Loading 1 rows into company_profile for AAPL (Mode: initial_load)
2025-04-19 15:18:43,388 - ERROR - [load_generic_data] Error prep DF company_profile (AAPL): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 200, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm: matched_db_col = db_col_map_val; break
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:18:43,390 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for AAPL (Mode: initial_load)
2025-04-19 15:18:43,390 - ERROR - [load_generic_data] Error prep DF company_key_metrics (AAPL): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 200, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm: matched_db_col = db_col_map_val; break
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:18:43,391 - ERROR - [run_stock_info_pipeline] Error load tx AAPL: name 'freq' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 607, in run_stock_info_pipeline
    if not process_and_load_financial_facts(write_conn, raw_df_fin, ticker, stmt_type, freq, mode): load_failed_flag = True
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 397, in process_and_load_financial_facts
    logging.info(f"Processing {freq} {stmt_type} for {ticker} ({len(raw_df)} items)")
                               ^^^^
NameError: name 'freq' is not defined
2025-04-19 15:18:43,392 - INFO - [run_stock_info_pipeline] Rolled back AAPL.
2025-04-19 15:18:43,392 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=AAPL, Type=Load Transaction Error, Msg=name 'freq' is not defined
2025-04-19 15:18:47,179 - ERROR - [fetch_calendar] Failed calendar MSFT: 'dict' object has no attribute 'empty'
2025-04-19 15:18:47,267 - ERROR - [fetch_recommendations] Failed recs MSFT: ['firm']
2025-04-19 15:18:47,380 - ERROR - [fetch_major_holders] Failed major holders MSFT: single positional indexer is out-of-bounds
2025-04-19 15:18:47,381 - WARNING - [_process_holders_df] Holder DF for MSFT missing expected columns. Got: ['Date Reported', 'Holder', 'pctHeld', 'Shares', 'Value', 'pctChange']
2025-04-19 15:18:47,381 - WARNING - [_process_holders_df] Holder DF for MSFT missing expected columns. Got: ['Date Reported', 'Holder', 'pctHeld', 'Shares', 'Value', 'pctChange']
2025-04-19 15:18:47,381 - INFO - [load_generic_data] Loading 1 rows into company_profile for MSFT (Mode: initial_load)
2025-04-19 15:18:47,382 - ERROR - [load_generic_data] Error prep DF company_profile (MSFT): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 200, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm: matched_db_col = db_col_map_val; break
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:18:47,382 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for MSFT (Mode: initial_load)
2025-04-19 15:18:47,383 - ERROR - [load_generic_data] Error prep DF company_key_metrics (MSFT): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 200, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm: matched_db_col = db_col_map_val; break
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:18:47,384 - ERROR - [run_stock_info_pipeline] Error load tx MSFT: name 'freq' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 607, in run_stock_info_pipeline
    if not process_and_load_financial_facts(write_conn, raw_df_fin, ticker, stmt_type, freq, mode): load_failed_flag = True
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 397, in process_and_load_financial_facts
    logging.info(f"Processing {freq} {stmt_type} for {ticker} ({len(raw_df)} items)")
                               ^^^^
NameError: name 'freq' is not defined
2025-04-19 15:18:47,384 - INFO - [run_stock_info_pipeline] Rolled back MSFT.
2025-04-19 15:18:47,384 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=MSFT, Type=Load Transaction Error, Msg=name 'freq' is not defined
2025-04-19 15:18:50,507 - ERROR - [fetch_calendar] Failed calendar GOOG: 'dict' object has no attribute 'empty'
2025-04-19 15:18:50,603 - ERROR - [fetch_recommendations] Failed recs GOOG: ['firm']
2025-04-19 15:18:50,706 - ERROR - [fetch_major_holders] Failed major holders GOOG: single positional indexer is out-of-bounds
2025-04-19 15:18:50,706 - WARNING - [_process_holders_df] Holder DF for GOOG missing expected columns. Got: ['Date Reported', 'Holder', 'pctHeld', 'Shares', 'Value', 'pctChange']
2025-04-19 15:18:50,706 - WARNING - [_process_holders_df] Holder DF for GOOG missing expected columns. Got: ['Date Reported', 'Holder', 'pctHeld', 'Shares', 'Value', 'pctChange']
2025-04-19 15:18:50,707 - INFO - [load_generic_data] Loading 1 rows into company_profile for GOOG (Mode: initial_load)
2025-04-19 15:18:50,707 - ERROR - [load_generic_data] Error prep DF company_profile (GOOG): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 200, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm: matched_db_col = db_col_map_val; break
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:18:50,708 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for GOOG (Mode: initial_load)
2025-04-19 15:18:50,708 - ERROR - [load_generic_data] Error prep DF company_key_metrics (GOOG): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 200, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm: matched_db_col = db_col_map_val; break
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:18:50,709 - ERROR - [run_stock_info_pipeline] Error load tx GOOG: name 'freq' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 607, in run_stock_info_pipeline
    if not process_and_load_financial_facts(write_conn, raw_df_fin, ticker, stmt_type, freq, mode): load_failed_flag = True
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 397, in process_and_load_financial_facts
    logging.info(f"Processing {freq} {stmt_type} for {ticker} ({len(raw_df)} items)")
                               ^^^^
NameError: name 'freq' is not defined
2025-04-19 15:18:50,709 - INFO - [run_stock_info_pipeline] Rolled back GOOG.
2025-04-19 15:18:50,709 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=GOOG, Type=Load Transaction Error, Msg=name 'freq' is not defined
2025-04-19 15:18:52,615 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:18:52,615 - ERROR - [fetch_company_info] Failed processing .info NONEXISTENTTICKER: AttributeError-'NoneType' object has no attribute 'update'
2025-04-19 15:18:52,616 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=fetch_company_info None
2025-04-19 15:18:53,805 - INFO - [fetch_financial_statement] No raw annual financials data found NONEXISTENTTICKER.
2025-04-19 15:18:53,806 - INFO - [fetch_financial_statement] No raw quarterly financials data found NONEXISTENTTICKER.
2025-04-19 15:18:53,807 - INFO - [fetch_financial_statement] No raw annual balance_sheet data found NONEXISTENTTICKER.
2025-04-19 15:18:53,807 - INFO - [fetch_financial_statement] No raw quarterly balance_sheet data found NONEXISTENTTICKER.
2025-04-19 15:18:53,807 - INFO - [fetch_financial_statement] No raw annual cashflow data found NONEXISTENTTICKER.
2025-04-19 15:18:53,807 - INFO - [fetch_financial_statement] No raw quarterly cashflow data found NONEXISTENTTICKER.
2025-04-19 15:18:54,679 - ERROR - [fetch_stock_actions] Failed actions NONEXISTENTTICKER: TypeError - argument of type 'NoneType' is not iterable
2025-04-19 15:18:55,682 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=calendarEvents&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:18:55,682 - ERROR - [fetch_calendar] Failed calendar NONEXISTENTTICKER: 'dict' object has no attribute 'empty'
2025-04-19 15:18:56,675 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=recommendationTrend&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:18:56,680 - INFO - [fetch_recommendations] No recs NONEXISTENTTICKER.
2025-04-19 15:18:57,700 - ERROR - [_fetch_and_parse] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=institutionOwnership%2CfundOwnership%2CmajorDirectHolders%2CmajorHoldersBreakdown%2CinsiderTransactions%2CinsiderHolders%2CnetSharePurchaseActivity&corsDomain=finance.yahoo.com&formatted=false&crumb=NgZIowMiLwG
2025-04-19 15:18:57,702 - INFO - [fetch_major_holders] No major holders NONEXISTENTTICKER.
2025-04-19 15:18:57,702 - WARNING - [run_stock_info_pipeline] Skip load NONEXISTENTTICKER due to all fetches failing.
2025-04-19 15:18:57,706 - INFO - [run_stock_info_pipeline] DB connection closed.
2025-04-19 15:18:57,706 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 15:18:57,706 - INFO - [run_stock_info_pipeline] Total Time: 18.24 sec
2025-04-19 15:18:57,706 - INFO - [run_stock_info_pipeline] Tickers Attempted: 4
2025-04-19 15:18:57,706 - INFO - [run_stock_info_pipeline] Tickers OK: 0
2025-04-19 15:18:57,707 - INFO - [run_stock_info_pipeline] Tickers Skip/Err: 4
2025-04-19 15:18:57,707 - INFO - [run_stock_info_pipeline] Fetch Errors: 29
2025-04-19 15:18:57,707 - INFO - [run_stock_info_pipeline] Load Errors (Tickers w fail): 3
2025-04-19 15:18:57,707 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors'.
2025-04-19 15:18:57,707 - INFO - [<module>] Script execution finished.
2025-04-19 15:22:58,300 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3.6 - Fixes) ---
2025-04-19 15:22:58,308 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 15:22:58,309 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 15:22:58,309 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 15:22:58,309 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 15:22:58,344 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 15:22:58,344 - INFO - [setup_info_tables] Setting up supplementary tables (incl. ISIN, Calendar, Recs, Holders)...
2025-04-19 15:22:58,348 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 15:22:58,349 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 15:22:58,349 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 15:22:58,371 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3.6 - Fixes) ---
2025-04-19 15:22:58,371 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 15:22:58,371 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 15:22:58,371 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 15:22:58,371 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 15:22:58,379 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 15:22:58,379 - INFO - [setup_info_tables] Setting up supplementary tables (incl. ISIN, Calendar, Recs, Holders)...
2025-04-19 15:22:58,381 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 15:22:58,382 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 15:22:58,382 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 15:23:02,894 - WARNING - [fetch_recommendations] PK columns missing after processing recs for AAPL. Has: Index(['ticker', 'fetch_timestamp', 'recommendation_timestamp'], dtype='object')
2025-04-19 15:23:02,991 - WARNING - [fetch_major_holders] Unexpected format for major holders AAPL: <class 'pandas.core.frame.DataFrame'>
2025-04-19 15:23:03,005 - INFO - [load_generic_data] Loading 1 rows into company_profile for AAPL (Mode: initial_load)
2025-04-19 15:23:03,006 - ERROR - [load_generic_data] Error prep DF company_profile (AAPL): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:03,008 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for AAPL (Mode: initial_load)
2025-04-19 15:23:03,009 - ERROR - [load_generic_data] Error prep DF company_key_metrics (AAPL): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:03,010 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for AAPL (39 items)
2025-04-19 15:23:03,015 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:03,018 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for AAPL (39 items)
2025-04-19 15:23:03,019 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:03,019 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for AAPL (68 items)
2025-04-19 15:23:03,021 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:03,021 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for AAPL (69 items)
2025-04-19 15:23:03,022 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:03,023 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for AAPL (53 items)
2025-04-19 15:23:03,024 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:03,024 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for AAPL (47 items)
2025-04-19 15:23:03,025 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:03,026 - INFO - [load_generic_data] Loading 91 rows into stock_actions for AAPL (Mode: initial_load)
2025-04-19 15:23:03,027 - ERROR - [load_generic_data] Error prep DF stock_actions (AAPL): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:03,027 - INFO - [load_generic_data] Loading 3 rows into calendar_events for AAPL (Mode: initial_load)
2025-04-19 15:23:03,028 - ERROR - [load_generic_data] Error prep DF calendar_events (AAPL): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:03,029 - INFO - [load_generic_data] Loading 10 rows into institutional_holders for AAPL (Mode: initial_load)
2025-04-19 15:23:03,029 - ERROR - [load_generic_data] Error prep DF institutional_holders (AAPL): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:03,030 - INFO - [load_generic_data] Loading 10 rows into mutual_fund_holders for AAPL (Mode: initial_load)
2025-04-19 15:23:03,030 - ERROR - [load_generic_data] Error prep DF mutual_fund_holders (AAPL): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:03,031 - WARNING - [run_stock_info_pipeline] Rolling back AAPL due to load errors.
2025-04-19 15:23:03,031 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=AAPL, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:23:06,849 - WARNING - [fetch_recommendations] PK columns missing after processing recs for MSFT. Has: Index(['ticker', 'fetch_timestamp', 'recommendation_timestamp'], dtype='object')
2025-04-19 15:23:07,006 - WARNING - [fetch_major_holders] Unexpected format for major holders MSFT: <class 'pandas.core.frame.DataFrame'>
2025-04-19 15:23:07,017 - INFO - [load_generic_data] Loading 1 rows into company_profile for MSFT (Mode: initial_load)
2025-04-19 15:23:07,019 - ERROR - [load_generic_data] Error prep DF company_profile (MSFT): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:07,019 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for MSFT (Mode: initial_load)
2025-04-19 15:23:07,020 - ERROR - [load_generic_data] Error prep DF company_key_metrics (MSFT): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:07,021 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for MSFT (47 items)
2025-04-19 15:23:07,022 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:07,023 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for MSFT (47 items)
2025-04-19 15:23:07,024 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:07,024 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for MSFT (78 items)
2025-04-19 15:23:07,025 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:07,025 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for MSFT (78 items)
2025-04-19 15:23:07,027 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:07,027 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for MSFT (60 items)
2025-04-19 15:23:07,028 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:07,029 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for MSFT (59 items)
2025-04-19 15:23:07,030 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:07,030 - INFO - [load_generic_data] Loading 94 rows into stock_actions for MSFT (Mode: initial_load)
2025-04-19 15:23:07,031 - ERROR - [load_generic_data] Error prep DF stock_actions (MSFT): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:07,032 - INFO - [load_generic_data] Loading 3 rows into calendar_events for MSFT (Mode: initial_load)
2025-04-19 15:23:07,033 - ERROR - [load_generic_data] Error prep DF calendar_events (MSFT): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:07,033 - INFO - [load_generic_data] Loading 10 rows into institutional_holders for MSFT (Mode: initial_load)
2025-04-19 15:23:07,034 - ERROR - [load_generic_data] Error prep DF institutional_holders (MSFT): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:07,034 - INFO - [load_generic_data] Loading 10 rows into mutual_fund_holders for MSFT (Mode: initial_load)
2025-04-19 15:23:07,035 - ERROR - [load_generic_data] Error prep DF mutual_fund_holders (MSFT): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:07,035 - WARNING - [run_stock_info_pipeline] Rolling back MSFT due to load errors.
2025-04-19 15:23:07,035 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=MSFT, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:23:10,898 - WARNING - [fetch_recommendations] PK columns missing after processing recs for GOOG. Has: Index(['ticker', 'fetch_timestamp', 'recommendation_timestamp'], dtype='object')
2025-04-19 15:23:10,992 - WARNING - [fetch_major_holders] Unexpected format for major holders GOOG: <class 'pandas.core.frame.DataFrame'>
2025-04-19 15:23:11,004 - INFO - [load_generic_data] Loading 1 rows into company_profile for GOOG (Mode: initial_load)
2025-04-19 15:23:11,005 - ERROR - [load_generic_data] Error prep DF company_profile (GOOG): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:11,006 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for GOOG (Mode: initial_load)
2025-04-19 15:23:11,007 - ERROR - [load_generic_data] Error prep DF company_key_metrics (GOOG): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:11,007 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for GOOG (47 items)
2025-04-19 15:23:11,008 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:11,009 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for GOOG (47 items)
2025-04-19 15:23:11,010 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:11,011 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for GOOG (75 items)
2025-04-19 15:23:11,012 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:11,012 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for GOOG (75 items)
2025-04-19 15:23:11,013 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:11,014 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for GOOG (55 items)
2025-04-19 15:23:11,015 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:11,015 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for GOOG (54 items)
2025-04-19 15:23:11,016 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 422, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=[raw_df.index.name], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:23:11,017 - INFO - [load_generic_data] Loading 7 rows into stock_actions for GOOG (Mode: initial_load)
2025-04-19 15:23:11,017 - ERROR - [load_generic_data] Error prep DF stock_actions (GOOG): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:11,018 - INFO - [load_generic_data] Loading 3 rows into calendar_events for GOOG (Mode: initial_load)
2025-04-19 15:23:11,018 - ERROR - [load_generic_data] Error prep DF calendar_events (GOOG): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:11,019 - INFO - [load_generic_data] Loading 10 rows into institutional_holders for GOOG (Mode: initial_load)
2025-04-19 15:23:11,019 - ERROR - [load_generic_data] Error prep DF institutional_holders (GOOG): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:11,020 - INFO - [load_generic_data] Loading 10 rows into mutual_fund_holders for GOOG (Mode: initial_load)
2025-04-19 15:23:11,021 - ERROR - [load_generic_data] Error prep DF mutual_fund_holders (GOOG): name 'df_col_norm' is not defined
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 165, in load_generic_data
    if db_col_map_key.replace('_','') == df_col_norm:
                                         ^^^^^^^^^^^
NameError: name 'df_col_norm' is not defined
2025-04-19 15:23:11,022 - WARNING - [run_stock_info_pipeline] Rolling back GOOG due to load errors.
2025-04-19 15:23:11,022 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=GOOG, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:23:13,052 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:23:13,053 - ERROR - [fetch_company_info] Failed processing .info NONEXISTENTTICKER: AttributeError-'NoneType' object has no attribute 'update'
2025-04-19 15:23:13,053 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=fetch_company_info None
2025-04-19 15:23:14,048 - INFO - [fetch_financial_statement] No raw annual financials data found NONEXISTENTTICKER.
2025-04-19 15:23:14,049 - INFO - [fetch_financial_statement] No raw quarterly financials data found NONEXISTENTTICKER.
2025-04-19 15:23:14,049 - INFO - [fetch_financial_statement] No raw annual balance_sheet data found NONEXISTENTTICKER.
2025-04-19 15:23:14,050 - INFO - [fetch_financial_statement] No raw quarterly balance_sheet data found NONEXISTENTTICKER.
2025-04-19 15:23:14,050 - INFO - [fetch_financial_statement] No raw annual cashflow data found NONEXISTENTTICKER.
2025-04-19 15:23:14,051 - INFO - [fetch_financial_statement] No raw quarterly cashflow data found NONEXISTENTTICKER.
2025-04-19 15:23:14,866 - ERROR - [fetch_stock_actions] Failed actions NONEXISTENTTICKER: TypeError - argument of type 'NoneType' is not iterable
2025-04-19 15:23:15,730 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=calendarEvents&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:23:15,731 - INFO - [fetch_calendar] No calendar data found or unexpected format for NONEXISTENTTICKER.
2025-04-19 15:23:16,591 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=recommendationTrend&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:23:16,594 - INFO - [fetch_recommendations] No recs NONEXISTENTTICKER.
2025-04-19 15:23:17,507 - ERROR - [_fetch_and_parse] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=institutionOwnership%2CfundOwnership%2CmajorDirectHolders%2CmajorHoldersBreakdown%2CinsiderTransactions%2CinsiderHolders%2CnetSharePurchaseActivity&corsDomain=finance.yahoo.com&formatted=false&crumb=NgZIowMiLwG
2025-04-19 15:23:17,508 - INFO - [fetch_major_holders] No major holders NONEXISTENTTICKER.
2025-04-19 15:23:17,508 - WARNING - [run_stock_info_pipeline] Skip load NONEXISTENTTICKER due to all fetches failing.
2025-04-19 15:23:17,512 - INFO - [run_stock_info_pipeline] DB connection closed.
2025-04-19 15:23:17,512 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 15:23:17,512 - INFO - [run_stock_info_pipeline] Total Time: 19.14 sec
2025-04-19 15:23:17,513 - INFO - [run_stock_info_pipeline] Tickers Attempted: 4
2025-04-19 15:23:17,513 - INFO - [run_stock_info_pipeline] Tickers OK: 0
2025-04-19 15:23:17,513 - INFO - [run_stock_info_pipeline] Tickers Skip/Err: 4
2025-04-19 15:23:17,513 - INFO - [run_stock_info_pipeline] Fetch Errors (API/Processing): 20
2025-04-19 15:23:17,513 - INFO - [run_stock_info_pipeline] Load Errors (Tickers w fail): 3
2025-04-19 15:23:17,513 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors'.
2025-04-19 15:23:17,513 - INFO - [<module>] Script execution finished.
2025-04-19 15:26:13,528 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3.7 - Fixes) ---
2025-04-19 15:26:13,535 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 15:26:13,535 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 15:26:13,535 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 15:26:13,535 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 15:26:13,562 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 15:26:13,563 - INFO - [setup_info_tables] Setting up supplementary tables (incl. ISIN, Calendar, Recs, Holders)...
2025-04-19 15:26:13,565 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 15:26:13,565 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 15:26:13,565 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 15:26:17,570 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3.7 - Fixes) ---
2025-04-19 15:26:17,571 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 15:26:17,571 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 15:26:17,571 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 15:26:17,571 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 15:26:17,576 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 15:26:17,577 - INFO - [setup_info_tables] Setting up supplementary tables (incl. ISIN, Calendar, Recs, Holders)...
2025-04-19 15:26:17,578 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 15:26:17,579 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 15:26:17,579 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 15:26:21,473 - WARNING - [fetch_recommendations] Could not find essential 'recommendation_timestamp' or 'firm' columns in recs for AAPL
2025-04-19 15:26:21,567 - WARNING - [fetch_major_holders] Unexpected format <class 'pandas.core.frame.DataFrame'> for major holders AAPL
2025-04-19 15:26:21,576 - INFO - [load_generic_data] Loading 1 rows into company_profile for AAPL (Mode: initial_load)
2025-04-19 15:26:21,588 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for AAPL (Mode: initial_load)
2025-04-19 15:26:21,597 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for AAPL (39 items)
2025-04-19 15:26:21,600 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:21,603 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for AAPL (39 items)
2025-04-19 15:26:21,604 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:21,604 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for AAPL (68 items)
2025-04-19 15:26:21,605 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:21,605 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for AAPL (69 items)
2025-04-19 15:26:21,606 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:21,606 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for AAPL (53 items)
2025-04-19 15:26:21,607 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:21,607 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for AAPL (47 items)
2025-04-19 15:26:21,608 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:21,608 - INFO - [load_generic_data] Loading 91 rows into stock_actions for AAPL (Mode: initial_load)
2025-04-19 15:26:21,613 - INFO - [load_generic_data] Loading 3 rows into calendar_events for AAPL (Mode: initial_load)
2025-04-19 15:26:21,617 - INFO - [load_generic_data] Loading 10 rows into institutional_holders for AAPL (Mode: initial_load)
2025-04-19 15:26:21,622 - INFO - [load_generic_data] Loading 10 rows into mutual_fund_holders for AAPL (Mode: initial_load)
2025-04-19 15:26:21,627 - WARNING - [run_stock_info_pipeline] Rolling back AAPL due to load errors.
2025-04-19 15:26:21,628 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=AAPL, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:26:25,487 - WARNING - [fetch_recommendations] Could not find essential 'recommendation_timestamp' or 'firm' columns in recs for MSFT
2025-04-19 15:26:25,598 - WARNING - [fetch_major_holders] Unexpected format <class 'pandas.core.frame.DataFrame'> for major holders MSFT
2025-04-19 15:26:25,610 - INFO - [load_generic_data] Loading 1 rows into company_profile for MSFT (Mode: initial_load)
2025-04-19 15:26:25,624 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for MSFT (Mode: initial_load)
2025-04-19 15:26:25,635 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for MSFT (47 items)
2025-04-19 15:26:25,637 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:25,637 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for MSFT (47 items)
2025-04-19 15:26:25,638 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:25,638 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for MSFT (78 items)
2025-04-19 15:26:25,639 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:25,639 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for MSFT (78 items)
2025-04-19 15:26:25,640 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:25,640 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for MSFT (60 items)
2025-04-19 15:26:25,641 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:25,642 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for MSFT (59 items)
2025-04-19 15:26:25,643 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:25,643 - INFO - [load_generic_data] Loading 94 rows into stock_actions for MSFT (Mode: initial_load)
2025-04-19 15:26:25,649 - INFO - [load_generic_data] Loading 3 rows into calendar_events for MSFT (Mode: initial_load)
2025-04-19 15:26:25,653 - INFO - [load_generic_data] Loading 10 rows into institutional_holders for MSFT (Mode: initial_load)
2025-04-19 15:26:25,658 - INFO - [load_generic_data] Loading 10 rows into mutual_fund_holders for MSFT (Mode: initial_load)
2025-04-19 15:26:25,663 - WARNING - [run_stock_info_pipeline] Rolling back MSFT due to load errors.
2025-04-19 15:26:25,664 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=MSFT, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:26:29,533 - WARNING - [fetch_recommendations] Could not find essential 'recommendation_timestamp' or 'firm' columns in recs for GOOG
2025-04-19 15:26:29,641 - WARNING - [fetch_major_holders] Unexpected format <class 'pandas.core.frame.DataFrame'> for major holders GOOG
2025-04-19 15:26:29,648 - INFO - [load_generic_data] Loading 1 rows into company_profile for GOOG (Mode: initial_load)
2025-04-19 15:26:29,656 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for GOOG (Mode: initial_load)
2025-04-19 15:26:29,666 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for GOOG (47 items)
2025-04-19 15:26:29,667 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:29,669 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for GOOG (47 items)
2025-04-19 15:26:29,670 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:29,670 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for GOOG (75 items)
2025-04-19 15:26:29,671 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:29,671 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for GOOG (75 items)
2025-04-19 15:26:29,672 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:29,672 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for GOOG (55 items)
2025-04-19 15:26:29,674 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:29,674 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for GOOG (54 items)
2025-04-19 15:26:29,675 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 367, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True); raw_df = raw_df[raw_df.index != '']
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:26:29,675 - INFO - [load_generic_data] Loading 7 rows into stock_actions for GOOG (Mode: initial_load)
2025-04-19 15:26:29,683 - INFO - [load_generic_data] Loading 3 rows into calendar_events for GOOG (Mode: initial_load)
2025-04-19 15:26:29,687 - INFO - [load_generic_data] Loading 10 rows into institutional_holders for GOOG (Mode: initial_load)
2025-04-19 15:26:29,723 - INFO - [load_generic_data] Loading 10 rows into mutual_fund_holders for GOOG (Mode: initial_load)
2025-04-19 15:26:29,728 - WARNING - [run_stock_info_pipeline] Rolling back GOOG due to load errors.
2025-04-19 15:26:29,728 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=GOOG, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:26:31,581 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:26:31,582 - ERROR - [fetch_company_info] Failed fetch .info NONEXISTENTTICKER: AttributeError-'NoneType' object has no attribute 'update'
2025-04-19 15:26:31,582 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=fetch_company_info None
2025-04-19 15:26:32,878 - INFO - [fetch_financial_statement] No raw annual financials data found NONEXISTENTTICKER.
2025-04-19 15:26:32,878 - INFO - [fetch_financial_statement] No raw quarterly financials data found NONEXISTENTTICKER.
2025-04-19 15:26:32,879 - INFO - [fetch_financial_statement] No raw annual balance_sheet data found NONEXISTENTTICKER.
2025-04-19 15:26:32,879 - INFO - [fetch_financial_statement] No raw quarterly balance_sheet data found NONEXISTENTTICKER.
2025-04-19 15:26:32,879 - INFO - [fetch_financial_statement] No raw annual cashflow data found NONEXISTENTTICKER.
2025-04-19 15:26:32,880 - INFO - [fetch_financial_statement] No raw quarterly cashflow data found NONEXISTENTTICKER.
2025-04-19 15:26:34,291 - ERROR - [fetch_stock_actions] Failed actions NONEXISTENTTICKER: TypeError - argument of type 'NoneType' is not iterable
2025-04-19 15:26:35,151 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=calendarEvents&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:26:35,151 - INFO - [fetch_calendar] No calendar data or unexpected format for NONEXISTENTTICKER.
2025-04-19 15:26:36,373 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=recommendationTrend&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:26:36,377 - INFO - [fetch_recommendations] No recs NONEXISTENTTICKER.
2025-04-19 15:26:37,426 - ERROR - [_fetch_and_parse] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=institutionOwnership%2CfundOwnership%2CmajorDirectHolders%2CmajorHoldersBreakdown%2CinsiderTransactions%2CinsiderHolders%2CnetSharePurchaseActivity&corsDomain=finance.yahoo.com&formatted=false&crumb=NgZIowMiLwG
2025-04-19 15:26:37,431 - INFO - [fetch_major_holders] No major holders NONEXISTENTTICKER.
2025-04-19 15:26:37,431 - WARNING - [run_stock_info_pipeline] Skip load NONEXISTENTTICKER due to all fetches failing or returning no data.
2025-04-19 15:26:37,438 - INFO - [run_stock_info_pipeline] DB connection closed.
2025-04-19 15:26:37,439 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 15:26:37,439 - INFO - [run_stock_info_pipeline] Total Time: 19.87 sec
2025-04-19 15:26:37,439 - INFO - [run_stock_info_pipeline] Tickers Attempted: 4
2025-04-19 15:26:37,439 - INFO - [run_stock_info_pipeline] Tickers OK: 0
2025-04-19 15:26:37,439 - INFO - [run_stock_info_pipeline] Tickers Skip/Err: 4
2025-04-19 15:26:37,439 - INFO - [run_stock_info_pipeline] Fetch Errors: 20
2025-04-19 15:26:37,439 - INFO - [run_stock_info_pipeline] Load Errors (Tickers w fail): 3
2025-04-19 15:26:37,440 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors'.
2025-04-19 15:26:37,440 - INFO - [<module>] Script execution finished.
2025-04-19 15:38:40,773 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3.8 - Fixes) ---
2025-04-19 15:38:40,779 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 15:38:40,779 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 15:38:40,779 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 15:38:40,779 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 15:38:40,811 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 15:38:40,812 - INFO - [setup_info_tables] Setting up supplementary tables (incl. ISIN, Calendar, Recs, Holders)...
2025-04-19 15:38:40,814 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 15:38:40,815 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 15:38:40,815 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 15:38:45,478 - WARNING - [fetch_recommendations] Expected recommendation column 'Firm' not found in data for AAPL
2025-04-19 15:38:45,478 - WARNING - [fetch_recommendations] Expected recommendation column 'To Grade' not found in data for AAPL
2025-04-19 15:38:45,478 - WARNING - [fetch_recommendations] Expected recommendation column 'From Grade' not found in data for AAPL
2025-04-19 15:38:45,478 - WARNING - [fetch_recommendations] Expected recommendation column 'Action' not found in data for AAPL
2025-04-19 15:38:45,480 - WARNING - [fetch_recommendations] PK columns missing after processing recs AAPL: ['fetch_timestamp', 'recommendation_timestamp', 'ticker']
2025-04-19 15:38:45,563 - WARNING - [fetch_major_holders] Unexpected format <class 'pandas.core.frame.DataFrame'> for major holders AAPL
2025-04-19 15:38:45,570 - INFO - [load_generic_data] Loading 1 rows into company_profile for AAPL (Mode: initial_load)
2025-04-19 15:38:45,579 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for AAPL (Mode: initial_load)
2025-04-19 15:38:45,586 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for AAPL (39 items)
2025-04-19 15:38:45,588 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:45,590 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for AAPL (39 items)
2025-04-19 15:38:45,591 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:45,591 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for AAPL (68 items)
2025-04-19 15:38:45,592 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:45,592 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for AAPL (69 items)
2025-04-19 15:38:45,593 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:45,593 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for AAPL (53 items)
2025-04-19 15:38:45,593 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:45,594 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for AAPL (47 items)
2025-04-19 15:38:45,594 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:45,594 - INFO - [load_generic_data] Loading 91 rows into stock_actions for AAPL (Mode: initial_load)
2025-04-19 15:38:45,600 - INFO - [load_generic_data] Loading 2 rows into calendar_events for AAPL (Mode: initial_load)
2025-04-19 15:38:45,603 - INFO - [load_generic_data] Loading 10 rows into institutional_holders for AAPL (Mode: initial_load)
2025-04-19 15:38:45,608 - INFO - [load_generic_data] Loading 10 rows into mutual_fund_holders for AAPL (Mode: initial_load)
2025-04-19 15:38:45,614 - WARNING - [run_stock_info_pipeline] Rolling back AAPL due to load errors.
2025-04-19 15:38:45,614 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=AAPL, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:38:49,531 - WARNING - [fetch_recommendations] Expected recommendation column 'Firm' not found in data for MSFT
2025-04-19 15:38:49,532 - WARNING - [fetch_recommendations] Expected recommendation column 'To Grade' not found in data for MSFT
2025-04-19 15:38:49,532 - WARNING - [fetch_recommendations] Expected recommendation column 'From Grade' not found in data for MSFT
2025-04-19 15:38:49,532 - WARNING - [fetch_recommendations] Expected recommendation column 'Action' not found in data for MSFT
2025-04-19 15:38:49,535 - WARNING - [fetch_recommendations] PK columns missing after processing recs MSFT: ['fetch_timestamp', 'recommendation_timestamp', 'ticker']
2025-04-19 15:38:49,645 - WARNING - [fetch_major_holders] Unexpected format <class 'pandas.core.frame.DataFrame'> for major holders MSFT
2025-04-19 15:38:49,656 - INFO - [load_generic_data] Loading 1 rows into company_profile for MSFT (Mode: initial_load)
2025-04-19 15:38:49,670 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for MSFT (Mode: initial_load)
2025-04-19 15:38:49,681 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for MSFT (47 items)
2025-04-19 15:38:49,682 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:49,683 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for MSFT (47 items)
2025-04-19 15:38:49,683 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:49,684 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for MSFT (78 items)
2025-04-19 15:38:49,684 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:49,685 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for MSFT (78 items)
2025-04-19 15:38:49,686 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:49,686 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for MSFT (60 items)
2025-04-19 15:38:49,687 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:49,688 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for MSFT (59 items)
2025-04-19 15:38:49,688 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:49,689 - INFO - [load_generic_data] Loading 94 rows into stock_actions for MSFT (Mode: initial_load)
2025-04-19 15:38:49,695 - INFO - [load_generic_data] Loading 2 rows into calendar_events for MSFT (Mode: initial_load)
2025-04-19 15:38:49,701 - INFO - [load_generic_data] Loading 10 rows into institutional_holders for MSFT (Mode: initial_load)
2025-04-19 15:38:49,706 - INFO - [load_generic_data] Loading 10 rows into mutual_fund_holders for MSFT (Mode: initial_load)
2025-04-19 15:38:49,711 - WARNING - [run_stock_info_pipeline] Rolling back MSFT due to load errors.
2025-04-19 15:38:49,712 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=MSFT, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:38:53,231 - WARNING - [fetch_recommendations] Expected recommendation column 'Firm' not found in data for GOOG
2025-04-19 15:38:53,231 - WARNING - [fetch_recommendations] Expected recommendation column 'To Grade' not found in data for GOOG
2025-04-19 15:38:53,232 - WARNING - [fetch_recommendations] Expected recommendation column 'From Grade' not found in data for GOOG
2025-04-19 15:38:53,232 - WARNING - [fetch_recommendations] Expected recommendation column 'Action' not found in data for GOOG
2025-04-19 15:38:53,234 - WARNING - [fetch_recommendations] PK columns missing after processing recs GOOG: ['fetch_timestamp', 'recommendation_timestamp', 'ticker']
2025-04-19 15:38:53,363 - WARNING - [fetch_major_holders] Unexpected format <class 'pandas.core.frame.DataFrame'> for major holders GOOG
2025-04-19 15:38:53,376 - INFO - [load_generic_data] Loading 1 rows into company_profile for GOOG (Mode: initial_load)
2025-04-19 15:38:53,388 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for GOOG (Mode: initial_load)
2025-04-19 15:38:53,419 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for GOOG (47 items)
2025-04-19 15:38:53,420 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:53,420 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for GOOG (47 items)
2025-04-19 15:38:53,421 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:53,421 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for GOOG (75 items)
2025-04-19 15:38:53,421 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:53,422 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for GOOG (75 items)
2025-04-19 15:38:53,422 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:53,423 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for GOOG (55 items)
2025-04-19 15:38:53,423 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:53,423 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for GOOG (54 items)
2025-04-19 15:38:53,424 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 365, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:38:53,424 - INFO - [load_generic_data] Loading 7 rows into stock_actions for GOOG (Mode: initial_load)
2025-04-19 15:38:53,429 - INFO - [load_generic_data] Loading 2 rows into calendar_events for GOOG (Mode: initial_load)
2025-04-19 15:38:53,434 - INFO - [load_generic_data] Loading 10 rows into institutional_holders for GOOG (Mode: initial_load)
2025-04-19 15:38:53,439 - INFO - [load_generic_data] Loading 10 rows into mutual_fund_holders for GOOG (Mode: initial_load)
2025-04-19 15:38:53,443 - WARNING - [run_stock_info_pipeline] Rolling back GOOG due to load errors.
2025-04-19 15:38:53,444 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=GOOG, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:38:55,282 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:38:55,283 - ERROR - [fetch_company_info] Failed fetch .info NONEXISTENTTICKER: AttributeError-'NoneType' object has no attribute 'update'
2025-04-19 15:38:55,283 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=fetch_company_info returned None
2025-04-19 15:38:56,570 - INFO - [fetch_financial_statement] No raw annual financials data found NONEXISTENTTICKER.
2025-04-19 15:38:56,571 - INFO - [fetch_financial_statement] No raw quarterly financials data found NONEXISTENTTICKER.
2025-04-19 15:38:56,572 - INFO - [fetch_financial_statement] No raw annual balance_sheet data found NONEXISTENTTICKER.
2025-04-19 15:38:56,573 - INFO - [fetch_financial_statement] No raw quarterly balance_sheet data found NONEXISTENTTICKER.
2025-04-19 15:38:56,573 - INFO - [fetch_financial_statement] No raw annual cashflow data found NONEXISTENTTICKER.
2025-04-19 15:38:56,574 - INFO - [fetch_financial_statement] No raw quarterly cashflow data found NONEXISTENTTICKER.
2025-04-19 15:38:57,677 - ERROR - [fetch_stock_actions] Failed actions NONEXISTENTTICKER: TypeError - argument of type 'NoneType' is not iterable
2025-04-19 15:38:58,477 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=calendarEvents&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:38:58,477 - INFO - [fetch_calendar] No calendar data or unexpected format for NONEXISTENTTICKER.
2025-04-19 15:38:59,445 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=recommendationTrend&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:38:59,446 - INFO - [fetch_recommendations] No recs NONEXISTENTTICKER.
2025-04-19 15:39:00,386 - ERROR - [_fetch_and_parse] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=institutionOwnership%2CfundOwnership%2CmajorDirectHolders%2CmajorHoldersBreakdown%2CinsiderTransactions%2CinsiderHolders%2CnetSharePurchaseActivity&corsDomain=finance.yahoo.com&formatted=false&crumb=NgZIowMiLwG
2025-04-19 15:39:00,389 - INFO - [fetch_major_holders] No major holders NONEXISTENTTICKER.
2025-04-19 15:39:00,390 - WARNING - [run_stock_info_pipeline] Skip load NONEXISTENTTICKER due to all fetches failing or returning no data.
2025-04-19 15:39:00,396 - INFO - [run_stock_info_pipeline] DB connection closed.
2025-04-19 15:39:00,396 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 15:39:00,396 - INFO - [run_stock_info_pipeline] Total Time: 19.62 sec
2025-04-19 15:39:00,396 - INFO - [run_stock_info_pipeline] Tickers Attempted: 4
2025-04-19 15:39:00,397 - INFO - [run_stock_info_pipeline] Tickers OK: 0
2025-04-19 15:39:00,397 - INFO - [run_stock_info_pipeline] Tickers Skip/Err: 4
2025-04-19 15:39:00,397 - INFO - [run_stock_info_pipeline] Fetch Errors: 20
2025-04-19 15:39:00,397 - INFO - [run_stock_info_pipeline] Load Errors (Tickers w fail): 3
2025-04-19 15:39:00,397 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors'.
2025-04-19 15:39:00,397 - INFO - [<module>] Script execution finished.
2025-04-19 15:41:32,605 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3.8 - Fixes) ---
2025-04-19 15:41:32,609 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 15:41:32,609 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 15:41:32,609 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 15:41:32,609 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 15:41:32,639 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 15:41:32,640 - INFO - [setup_info_tables] Setting up supplementary tables (incl. ISIN, Calendar, Recs, Holders)...
2025-04-19 15:41:32,642 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 15:41:32,642 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 15:41:32,643 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 15:41:37,971 - WARNING - [fetch_recommendations] Expected recommendation column 'Firm' not found in data for AAPL
2025-04-19 15:41:37,971 - WARNING - [fetch_recommendations] Expected recommendation column 'To Grade' not found in data for AAPL
2025-04-19 15:41:37,971 - WARNING - [fetch_recommendations] Expected recommendation column 'From Grade' not found in data for AAPL
2025-04-19 15:41:37,971 - WARNING - [fetch_recommendations] Expected recommendation column 'Action' not found in data for AAPL
2025-04-19 15:41:37,973 - WARNING - [fetch_recommendations] PK columns missing after processing recs AAPL: ['ticker', 'recommendation_timestamp', 'fetch_timestamp']
2025-04-19 15:41:38,081 - WARNING - [fetch_major_holders] Unexpected format <class 'pandas.core.frame.DataFrame'> for major holders AAPL
2025-04-19 15:41:38,087 - INFO - [load_generic_data] Loading 1 rows into company_profile for AAPL (Mode: initial_load)
2025-04-19 15:41:38,097 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for AAPL (Mode: initial_load)
2025-04-19 15:41:38,105 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for AAPL (39 items)
2025-04-19 15:41:38,108 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:38,111 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for AAPL (39 items)
2025-04-19 15:41:38,113 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:38,113 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for AAPL (68 items)
2025-04-19 15:41:38,114 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:38,114 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for AAPL (69 items)
2025-04-19 15:41:38,115 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:38,115 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for AAPL (53 items)
2025-04-19 15:41:38,116 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:38,116 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for AAPL (47 items)
2025-04-19 15:41:38,117 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:38,117 - INFO - [load_generic_data] Loading 91 rows into stock_actions for AAPL (Mode: initial_load)
2025-04-19 15:41:38,123 - INFO - [load_generic_data] Loading 2 rows into calendar_events for AAPL (Mode: initial_load)
2025-04-19 15:41:38,128 - INFO - [load_generic_data] Loading 10 rows into institutional_holders for AAPL (Mode: initial_load)
2025-04-19 15:41:38,134 - INFO - [load_generic_data] Loading 10 rows into mutual_fund_holders for AAPL (Mode: initial_load)
2025-04-19 15:41:38,145 - WARNING - [run_stock_info_pipeline] Rolling back AAPL due to load errors.
2025-04-19 15:41:38,145 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=AAPL, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:41:41,806 - WARNING - [fetch_recommendations] Expected recommendation column 'Firm' not found in data for MSFT
2025-04-19 15:41:41,806 - WARNING - [fetch_recommendations] Expected recommendation column 'To Grade' not found in data for MSFT
2025-04-19 15:41:41,807 - WARNING - [fetch_recommendations] Expected recommendation column 'From Grade' not found in data for MSFT
2025-04-19 15:41:41,807 - WARNING - [fetch_recommendations] Expected recommendation column 'Action' not found in data for MSFT
2025-04-19 15:41:41,808 - WARNING - [fetch_recommendations] PK columns missing after processing recs MSFT: ['ticker', 'recommendation_timestamp', 'fetch_timestamp']
2025-04-19 15:41:41,921 - WARNING - [fetch_major_holders] Unexpected format <class 'pandas.core.frame.DataFrame'> for major holders MSFT
2025-04-19 15:41:41,929 - INFO - [load_generic_data] Loading 1 rows into company_profile for MSFT (Mode: initial_load)
2025-04-19 15:41:41,938 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for MSFT (Mode: initial_load)
2025-04-19 15:41:41,947 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for MSFT (47 items)
2025-04-19 15:41:41,947 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:41,948 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for MSFT (47 items)
2025-04-19 15:41:41,948 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:41,949 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for MSFT (78 items)
2025-04-19 15:41:41,949 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:41,949 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for MSFT (78 items)
2025-04-19 15:41:41,950 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:41,950 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for MSFT (60 items)
2025-04-19 15:41:41,951 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:41,951 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for MSFT (59 items)
2025-04-19 15:41:41,951 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:41,952 - INFO - [load_generic_data] Loading 94 rows into stock_actions for MSFT (Mode: initial_load)
2025-04-19 15:41:41,956 - INFO - [load_generic_data] Loading 2 rows into calendar_events for MSFT (Mode: initial_load)
2025-04-19 15:41:41,960 - INFO - [load_generic_data] Loading 10 rows into institutional_holders for MSFT (Mode: initial_load)
2025-04-19 15:41:41,966 - INFO - [load_generic_data] Loading 10 rows into mutual_fund_holders for MSFT (Mode: initial_load)
2025-04-19 15:41:41,971 - WARNING - [run_stock_info_pipeline] Rolling back MSFT due to load errors.
2025-04-19 15:41:41,972 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=MSFT, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:41:46,583 - INFO - [run_stock_info_pipeline] --- Starting Stock Info Pipeline (v3.8 - Fixes) ---
2025-04-19 15:41:46,583 - INFO - [run_stock_info_pipeline] Database: :memory:
2025-04-19 15:41:46,583 - INFO - [run_stock_info_pipeline] Run Mode: initial_load
2025-04-19 15:41:46,583 - INFO - [run_stock_info_pipeline] Target Tickers: ['AAPL', 'MSFT', 'GOOG', 'NONEXISTENTTICKER']
2025-04-19 15:41:46,583 - INFO - [run_stock_info_pipeline] Update Profile Threshold (Days): -1
2025-04-19 15:41:46,590 - INFO - [connect_db] Connected: :memory: (RO: False)
2025-04-19 15:41:46,590 - INFO - [setup_info_tables] Setting up supplementary tables (incl. ISIN, Calendar, Recs, Holders)...
2025-04-19 15:41:46,592 - INFO - [run_stock_info_pipeline] Processing 4 target tickers.
2025-04-19 15:41:46,593 - INFO - [run_stock_info_pipeline] Found 0 profile timestamps.
2025-04-19 15:41:46,593 - INFO - [run_stock_info_pipeline] Starting fetch/load loop for 4 tickers...
2025-04-19 15:41:50,741 - WARNING - [fetch_recommendations] Expected recommendation column 'Firm' not found in data for AAPL
2025-04-19 15:41:50,742 - WARNING - [fetch_recommendations] Expected recommendation column 'To Grade' not found in data for AAPL
2025-04-19 15:41:50,742 - WARNING - [fetch_recommendations] Expected recommendation column 'From Grade' not found in data for AAPL
2025-04-19 15:41:50,742 - WARNING - [fetch_recommendations] Expected recommendation column 'Action' not found in data for AAPL
2025-04-19 15:41:50,744 - WARNING - [fetch_recommendations] PK columns missing after processing recs AAPL: ['fetch_timestamp', 'ticker', 'recommendation_timestamp']
2025-04-19 15:41:50,831 - WARNING - [fetch_major_holders] Unexpected format <class 'pandas.core.frame.DataFrame'> for major holders AAPL
2025-04-19 15:41:50,839 - INFO - [load_generic_data] Loading 1 rows into company_profile for AAPL (Mode: initial_load)
2025-04-19 15:41:50,850 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for AAPL (Mode: initial_load)
2025-04-19 15:41:50,858 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for AAPL (39 items)
2025-04-19 15:41:50,860 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:50,863 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for AAPL (39 items)
2025-04-19 15:41:50,864 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:50,864 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for AAPL (68 items)
2025-04-19 15:41:50,865 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:50,865 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for AAPL (69 items)
2025-04-19 15:41:50,866 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:50,866 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for AAPL (53 items)
2025-04-19 15:41:50,866 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:50,867 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for AAPL (47 items)
2025-04-19 15:41:50,867 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow AAPL: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:50,867 - INFO - [load_generic_data] Loading 91 rows into stock_actions for AAPL (Mode: initial_load)
2025-04-19 15:41:50,871 - INFO - [load_generic_data] Loading 2 rows into calendar_events for AAPL (Mode: initial_load)
2025-04-19 15:41:50,875 - INFO - [load_generic_data] Loading 10 rows into institutional_holders for AAPL (Mode: initial_load)
2025-04-19 15:41:50,881 - INFO - [load_generic_data] Loading 10 rows into mutual_fund_holders for AAPL (Mode: initial_load)
2025-04-19 15:41:50,885 - WARNING - [run_stock_info_pipeline] Rolling back AAPL due to load errors.
2025-04-19 15:41:50,886 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=AAPL, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:41:55,191 - WARNING - [fetch_recommendations] Expected recommendation column 'Firm' not found in data for MSFT
2025-04-19 15:41:55,192 - WARNING - [fetch_recommendations] Expected recommendation column 'To Grade' not found in data for MSFT
2025-04-19 15:41:55,192 - WARNING - [fetch_recommendations] Expected recommendation column 'From Grade' not found in data for MSFT
2025-04-19 15:41:55,192 - WARNING - [fetch_recommendations] Expected recommendation column 'Action' not found in data for MSFT
2025-04-19 15:41:55,194 - WARNING - [fetch_recommendations] PK columns missing after processing recs MSFT: ['fetch_timestamp', 'ticker', 'recommendation_timestamp']
2025-04-19 15:41:55,302 - WARNING - [fetch_major_holders] Unexpected format <class 'pandas.core.frame.DataFrame'> for major holders MSFT
2025-04-19 15:41:55,312 - INFO - [load_generic_data] Loading 1 rows into company_profile for MSFT (Mode: initial_load)
2025-04-19 15:41:55,323 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for MSFT (Mode: initial_load)
2025-04-19 15:41:55,339 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for MSFT (47 items)
2025-04-19 15:41:55,340 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:55,341 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for MSFT (47 items)
2025-04-19 15:41:55,342 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:55,342 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for MSFT (78 items)
2025-04-19 15:41:55,343 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:55,344 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for MSFT (78 items)
2025-04-19 15:41:55,345 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:55,345 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for MSFT (60 items)
2025-04-19 15:41:55,347 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:55,348 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for MSFT (59 items)
2025-04-19 15:41:55,349 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow MSFT: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:55,350 - INFO - [load_generic_data] Loading 94 rows into stock_actions for MSFT (Mode: initial_load)
2025-04-19 15:41:55,355 - INFO - [load_generic_data] Loading 2 rows into calendar_events for MSFT (Mode: initial_load)
2025-04-19 15:41:55,360 - INFO - [load_generic_data] Loading 10 rows into institutional_holders for MSFT (Mode: initial_load)
2025-04-19 15:41:55,366 - INFO - [load_generic_data] Loading 10 rows into mutual_fund_holders for MSFT (Mode: initial_load)
2025-04-19 15:41:55,373 - WARNING - [run_stock_info_pipeline] Rolling back MSFT due to load errors.
2025-04-19 15:41:55,373 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=MSFT, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:41:59,174 - WARNING - [fetch_recommendations] Expected recommendation column 'Firm' not found in data for GOOG
2025-04-19 15:41:59,175 - WARNING - [fetch_recommendations] Expected recommendation column 'To Grade' not found in data for GOOG
2025-04-19 15:41:59,176 - WARNING - [fetch_recommendations] Expected recommendation column 'From Grade' not found in data for GOOG
2025-04-19 15:41:59,176 - WARNING - [fetch_recommendations] Expected recommendation column 'Action' not found in data for GOOG
2025-04-19 15:41:59,179 - WARNING - [fetch_recommendations] PK columns missing after processing recs GOOG: ['fetch_timestamp', 'ticker', 'recommendation_timestamp']
2025-04-19 15:41:59,301 - WARNING - [fetch_major_holders] Unexpected format <class 'pandas.core.frame.DataFrame'> for major holders GOOG
2025-04-19 15:41:59,311 - INFO - [load_generic_data] Loading 1 rows into company_profile for GOOG (Mode: initial_load)
2025-04-19 15:41:59,324 - INFO - [load_generic_data] Loading 1 rows into company_key_metrics for GOOG (Mode: initial_load)
2025-04-19 15:41:59,334 - INFO - [process_and_load_financial_facts] Processing annual Income Statement for GOOG (47 items)
2025-04-19 15:41:59,335 - ERROR - [process_and_load_financial_facts] Failed process/load annual Income Statement GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:59,336 - INFO - [process_and_load_financial_facts] Processing quarterly Income Statement for GOOG (47 items)
2025-04-19 15:41:59,337 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Income Statement GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:59,337 - INFO - [process_and_load_financial_facts] Processing annual Balance Sheet for GOOG (75 items)
2025-04-19 15:41:59,338 - ERROR - [process_and_load_financial_facts] Failed process/load annual Balance Sheet GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:59,338 - INFO - [process_and_load_financial_facts] Processing quarterly Balance Sheet for GOOG (75 items)
2025-04-19 15:41:59,338 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Balance Sheet GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:59,339 - INFO - [process_and_load_financial_facts] Processing annual Cash Flow for GOOG (55 items)
2025-04-19 15:41:59,339 - ERROR - [process_and_load_financial_facts] Failed process/load annual Cash Flow GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:59,339 - INFO - [process_and_load_financial_facts] Processing quarterly Cash Flow for GOOG (54 items)
2025-04-19 15:41:59,340 - ERROR - [process_and_load_financial_facts] Failed process/load quarterly Cash Flow GOOG: ['item_label']
Traceback (most recent call last):
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/stock_info_gatherer.py", line 437, in process_and_load_financial_facts
    raw_df.dropna(axis=0, subset=['item_label'], inplace=True) # Use the assigned name
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dougstrouth/Library/Mobile Documents/com~apple~CloudDocs/Documents/Code/APIs/edgar/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 6670, in dropna
    raise KeyError(np.array(subset)[check].tolist())
KeyError: ['item_label']
2025-04-19 15:41:59,341 - INFO - [load_generic_data] Loading 7 rows into stock_actions for GOOG (Mode: initial_load)
2025-04-19 15:41:59,345 - INFO - [load_generic_data] Loading 2 rows into calendar_events for GOOG (Mode: initial_load)
2025-04-19 15:41:59,350 - INFO - [load_generic_data] Loading 10 rows into institutional_holders for GOOG (Mode: initial_load)
2025-04-19 15:41:59,354 - INFO - [load_generic_data] Loading 10 rows into mutual_fund_holders for GOOG (Mode: initial_load)
2025-04-19 15:41:59,359 - WARNING - [run_stock_info_pipeline] Rolling back GOOG due to load errors.
2025-04-19 15:41:59,360 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=GOOG, Type=Load Failure, Msg=One or more loads failed.
2025-04-19 15:42:01,282 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=financialData%2CquoteType%2CdefaultKeyStatistics%2CassetProfile%2CsummaryDetail&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:42:01,283 - ERROR - [fetch_company_info] Failed fetch .info NONEXISTENTTICKER: AttributeError-'NoneType' object has no attribute 'update'
2025-04-19 15:42:01,283 - WARNING - [log_info_fetch_error] Log err: CIK=None, Ticker=NONEXISTENTTICKER, Type=Info Fetch Error, Msg=fetch_company_info returned None
2025-04-19 15:42:02,623 - INFO - [fetch_financial_statement] No raw annual financials data found NONEXISTENTTICKER.
2025-04-19 15:42:02,625 - INFO - [fetch_financial_statement] No raw quarterly financials data found NONEXISTENTTICKER.
2025-04-19 15:42:02,627 - INFO - [fetch_financial_statement] No raw annual balance_sheet data found NONEXISTENTTICKER.
2025-04-19 15:42:02,627 - INFO - [fetch_financial_statement] No raw quarterly balance_sheet data found NONEXISTENTTICKER.
2025-04-19 15:42:02,628 - INFO - [fetch_financial_statement] No raw annual cashflow data found NONEXISTENTTICKER.
2025-04-19 15:42:02,628 - INFO - [fetch_financial_statement] No raw quarterly cashflow data found NONEXISTENTTICKER.
2025-04-19 15:42:03,512 - ERROR - [fetch_stock_actions] Failed actions NONEXISTENTTICKER: TypeError - argument of type 'NoneType' is not iterable
2025-04-19 15:42:04,473 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=calendarEvents&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:42:04,473 - INFO - [fetch_calendar] No calendar data or unexpected format for NONEXISTENTTICKER.
2025-04-19 15:42:05,356 - ERROR - [_fetch] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=recommendationTrend&corsDomain=finance.yahoo.com&formatted=false&symbol=NONEXISTENTTICKER&crumb=NgZIowMiLwG
2025-04-19 15:42:05,359 - INFO - [fetch_recommendations] No recs NONEXISTENTTICKER.
2025-04-19 15:42:06,156 - ERROR - [_fetch_and_parse] 404 Client Error: Not Found for url: https://query2.finance.yahoo.com/v10/finance/quoteSummary/NONEXISTENTTICKER?modules=institutionOwnership%2CfundOwnership%2CmajorDirectHolders%2CmajorHoldersBreakdown%2CinsiderTransactions%2CinsiderHolders%2CnetSharePurchaseActivity&corsDomain=finance.yahoo.com&formatted=false&crumb=NgZIowMiLwG
2025-04-19 15:42:06,158 - INFO - [fetch_major_holders] No major holders NONEXISTENTTICKER.
2025-04-19 15:42:06,158 - WARNING - [run_stock_info_pipeline] Skip load NONEXISTENTTICKER due to all fetches failing or returning no data.
2025-04-19 15:42:06,161 - INFO - [run_stock_info_pipeline] DB connection closed.
2025-04-19 15:42:06,162 - INFO - [run_stock_info_pipeline] --- Stock Info Pipeline Finished ---
2025-04-19 15:42:06,162 - INFO - [run_stock_info_pipeline] Total Time: 19.58 sec
2025-04-19 15:42:06,162 - INFO - [run_stock_info_pipeline] Tickers Attempted: 4
2025-04-19 15:42:06,162 - INFO - [run_stock_info_pipeline] Tickers OK: 0
2025-04-19 15:42:06,162 - INFO - [run_stock_info_pipeline] Tickers Skip/Err: 4
2025-04-19 15:42:06,162 - INFO - [run_stock_info_pipeline] Fetch Errors: 20
2025-04-19 15:42:06,162 - INFO - [run_stock_info_pipeline] Load Errors (Tickers w fail): 3
2025-04-19 15:42:06,162 - INFO - [run_stock_info_pipeline] Check 'stock_fetch_errors'.
2025-04-19 15:42:06,162 - INFO - [<module>] Script execution finished.
